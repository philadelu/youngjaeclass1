<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Class Play - Premium Integrated V5.0 (Full Version)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&family=Orbitron:wght@400;700;900&family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">

    <style>
/* [ê³µí†µ í°íŠ¸ ë° ë°°ê²½] */
        body { font-family: 'Pretendard', 'Noto Sans KR', sans-serif; background-color: #f8f9fa; color: #111; }
        .num-font { font-family: 'Inter', sans-serif; font-variant-numeric: tabular-nums; letter-spacing: -0.02em; }
        
        /* [ìŠ¤í¬ë¡¤ë°” ì»¤ìŠ¤í…€] */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #999; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #777; }

        /* [ìœ í‹¸ë¦¬í‹° ì• ë‹ˆë©”ì´ì…˜] */
    .fade-in { animation: fadeIn 0.3s ease-out; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
/* [ìˆ˜ì •] width ì• ë‹ˆë©”ì´ì…˜ ì œê±°, transformë§Œ ì‚¬ìš© (ì„±ëŠ¥ ìµœì í™”) */
#main-sidebar { transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); }

        /* [ë¬¸ì œ í‘œì‹œ ì˜ì—­] */
.problem-content { 
    font-size: clamp(1.2rem, 3vw, 2.5rem); 
    font-weight: 800; 
    line-height: 1.4; 
    text-align: center; 
    color: #111; 
    width: 100%; 
    height: 100%; 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    justify-content: start; /* centerì—ì„œ startë¡œ ë³€ê²½í•˜ì—¬ ìƒë‹¨ë¶€í„° ë°°ì¹˜í•˜ë˜ íŒ¨ë”©ìœ¼ë¡œ ë°€ì–´ëƒ„ */
    overflow-y: auto; 
    padding-top: 1rem; /* ìƒë‹¨ ì—¬ë°± í™•ë³´ (í—¤ë” ê²¹ì¹¨ ë°©ì§€) */
    padding-bottom: 2rem;
    padding-left: 1rem;
    padding-right: 1rem;
    word-break: keep-all; 
}

        /* [ë…í•´ ì§€ë¬¸ ìŠ¤íƒ€ì¼ - í˜•ê´‘íœ ì œê±°, ì‹¬í”Œ ëª¨ë“œ] */
        .reading-content-wrapper {
            text-align: left;
            background-color: #fff;
            border: 1px solid #333;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
            line-height: 1.7;
            color: #222;
            width: 100%;
            max-width: 100%;
            word-break: keep-all;
        }
        .reading-content-wrapper strong { 
            color: #000; 
            font-weight: 700; 
            border-bottom: 1px solid #000; /* í˜•ê´‘ìƒ‰ ëŒ€ì‹  ë°‘ì¤„ë¡œ ë³€ê²½ */
            background: none;
            padding: 0;
        }

        /* [êµì‚¬ ì¹ íŒ & ìº”ë²„ìŠ¤ ë„êµ¬] */
        .cursor-pen { cursor: crosshair; }
        #view-teacher #board-area { position: relative; overflow: hidden; background-color: #fff; border: 1px solid #ddd; }
        #view-teacher #board-canvas { position: absolute; top: 0; left: 0; z-index: 20; touch-action: none; }
        #view-teacher #board-overlay { position: absolute; inset: 0; z-index: 10; display: flex; align-items: center; justify-content: center; pointer-events: none; color: #000; padding: 2rem; }
        
        /* [ë‹¬ë ¥/ì¼ê³¼í‘œ ìŠ¤íƒ€ì¼ - í‘ë°±] */
  /* [ë‹¬ë ¥/ì¼ê³¼í‘œ ìŠ¤íƒ€ì¼ - ìˆ˜ì •ë¨] */
.calendar-grid-container { 
    display: grid; 
    grid-template-columns: repeat(7, 1fr); 
    gap: 1px; 
    text-align: center; 
    width: 100%; 
    max-width: 100%; 
    margin: 0 auto; 
    border: 1px solid #333;
    background: #333;
}
.calendar-grid-container div { 
    padding: 0.5rem; 
    background: #fff;
    min-height: 45px; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    font-weight: bold;
    color: #333;
}
.calendar-grid-container .day-header { font-weight: 800; background-color: #eee; color: #000; }

/* [ì¤‘ìš”] ìƒ‰ìƒ ê°•ì œ ì ìš© (!important ìœ ì§€) */
.calendar-grid-container .sunday { color: #ef4444 !important; } /* ì¼ìš”ì¼ ë¹¨ê°• */
.calendar-grid-container .saturday { color: #2563eb !important; } /* í† ìš”ì¼ íŒŒë‘ */
.calendar-grid-container .holiday { 
    color: #ef4444 !important; /* ê³µíœ´ì¼ ë¹¨ê°• */
    background-color: #fef2f2; /* ë°°ê²½ ì—°í•œ ë¹¨ê°• */
}
        
        /* í€´ì¦ˆ ì •ë‹µ ë²„íŠ¼ ìŠ¤íƒ€ì¼ (í‘ë°±) */
.quiz-option-btn {
            background-color: white;
            border: 1px solid #333;
            border-radius: 0.5rem;
            color: #111;
            font-size: clamp(0.9rem, 1.2vw, 1.2rem); /* í°íŠ¸ ì‚¬ì´ì¦ˆ ì•½ê°„ ì¶•ì†Œ */
            font-weight: 700;
            padding: 0.25rem; /* íŒ¨ë”© ëŒ€í­ ì¶•ì†Œ */
            transition: all 0.1s;
            box-shadow: 2px 2px 0 #333;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.1;
            word-break: keep-all;
            height: 100%;
            min-height: 45px; /* 60px -> 45pxë¡œ ì¶•ì†Œ */
        }
        .quiz-option-btn:hover:not(:disabled) {
            background-color: #f0f0f0;
            transform: translate(-1px, -1px);
            box-shadow: 3px 3px 0 #333;
        }
        .quiz-option-btn:active:not(:disabled) {
            transform: translate(1px, 1px);
            box-shadow: 1px 1px 0 #333;
        }

        /* ë­í‚¹ ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ */
        .ranking-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: white;
            border: 1px solid #f3f4f6;
            border-radius: 0.75rem;
            margin-bottom: 0.5rem;
            transition: transform 0.2s;
        }
        .ranking-item:hover { transform: scale(1.01); border-color: #e5e7eb; }
    </style>
</head>
  <body class="text-gray-800 antialiased h-screen flex overflow-hidden">

    <div id="loading-overlay" class="fixed inset-0 bg-white z-[100] flex flex-col items-center justify-center">
        <div class="animate-spin rounded-full h-16 w-16 border-b-4 border-gray-900 mb-4"></div>
        <p class="text-gray-500 font-bold animate-pulse">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>
    </div>

    <div id="auth-modal" class="fixed inset-0 bg-gray-900/90 z-50 flex items-center justify-center backdrop-blur-sm fade-in hidden">
        <div class="bg-white p-8 rounded-2xl shadow-2xl w-full max-w-md border border-gray-200">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-black text-gray-900 tracking-tighter">CLASS PLAY</h1>
                <p class="text-gray-500 text-sm mt-2 font-medium">Online Integrated V5.0</p>
                <p class="text-[10px] text-purple-600 mt-1 font-bold">* êµ¬ê¸€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì—°ë™ë¨</p>
            </div>
            <div class="flex border-b border-gray-200 mb-6">
                <button onclick="switchAuthTab('login')" id="tab-login" class="flex-1 py-3 text-sm font-bold text-gray-900 border-b-2 border-gray-900 transition">ë¡œê·¸ì¸</button>
                <button onclick="switchAuthTab('signup')" id="tab-signup" class="flex-1 py-3 text-sm font-bold text-gray-400 hover:text-gray-600 transition">íšŒì›ê°€ì…</button>
            </div>
            <div class="grid grid-cols-2 gap-3 mb-6">
                <button onclick="setRole('teacher')" id="btn-role-teacher" class="p-3 border-2 border-gray-200 rounded-xl flex flex-col items-center justify-center gap-1 transition text-gray-400 hover:border-gray-400">
                    <i class="fas fa-chalkboard-teacher text-xl"></i><span class="text-xs font-bold mt-1">ì„ ìƒë‹˜</span>
                </button>
                <button onclick="setRole('student')" id="btn-role-student" class="p-3 border-2 border-gray-200 rounded-xl flex flex-col items-center justify-center gap-1 transition text-gray-400 hover:border-gray-400">
                    <i class="fas fa-user-graduate text-xl"></i><span class="text-xs font-bold mt-1">í•™ìƒ</span>
                </button>
            </div>
            <div class="space-y-3">
                <input type="text" id="input-school" placeholder="í•™êµ ì´ë¦„" class="auth-signup-field hidden w-full px-4 py-3.5 bg-gray-50 border border-gray-200 rounded-xl focus:border-gray-800 focus:ring-0 outline-none text-sm transition font-medium">
                <input type="text" id="input-name" placeholder="ì´ë¦„" class="auth-signup-field hidden w-full px-4 py-3.5 bg-gray-50 border border-gray-200 rounded-xl focus:border-gray-800 focus:ring-0 outline-none text-sm transition font-medium">
                <input type="text" id="input-id" placeholder="ì•„ì´ë””" class="w-full px-4 py-3.5 bg-gray-50 border border-gray-200 rounded-xl focus:border-gray-800 focus:ring-0 outline-none text-sm transition num-font font-medium">
                <input type="password" id="input-pw" placeholder="ë¹„ë°€ë²ˆí˜¸" class="w-full px-4 py-3.5 bg-gray-50 border border-gray-200 rounded-xl focus:border-gray-800 focus:ring-0 outline-none text-sm transition num-font font-medium">
            </div>
            <button onclick="processAuth()" id="btn-auth-submit" class="w-full bg-gray-900 hover:bg-black text-white font-bold py-4 rounded-xl transition shadow-xl mt-8 text-sm">ë¡œê·¸ì¸</button>
        </div>
    </div>

<div id="sidebar-overlay" onclick="toggleSidebar()" class="fixed inset-0 bg-black/50 z-40 hidden transition-opacity md:hidden"></div>

<aside id="main-sidebar" class="fixed inset-y-0 left-0 md:relative -translate-x-full bg-white w-64 border-r border-gray-200 flex flex-col z-50 h-full overflow-hidden flex-shrink-0 transition-transform duration-300">
        <div class="h-16 flex items-center px-8 border-b border-gray-100 flex-shrink-0">
            <h1 class="text-base font-black tracking-widest text-gray-900 cursor-pointer" onclick="goDashboard()">íŠ¹ìˆ˜í•™ê¸‰ í•™ìŠµ</h1>
        </div>
        <nav class="flex-1 overflow-y-auto py-2 px-2 space-y-1" id="sidebar-menu"></nav>
        <div class="border-t border-gray-100 p-4 bg-gray-50/50 flex-shrink-0">
            <div class="flex items-center gap-3 mb-3">
                <div class="w-10 h-10 rounded-full bg-white border border-gray-200 flex items-center justify-center text-gray-400 shadow-sm"><i class="fas fa-user"></i></div>
                <div class="flex-1 min-w-0 overflow-hidden">
                    <p id="profile-name" class="text-sm font-bold text-gray-900 truncate">Guest</p>
                    <p id="profile-school" class="text-[10px] text-gray-400 truncate mt-0.5">Login Required</p>
<p id="reward-area" style="display:none !important"><span id="reward-score">0</span></p>
                </div>
<button type="button" onclick="handleLogout()" class="text-gray-400 hover:text-red-600 transition p-2 cursor-pointer relative z-50">
    <i class="fas fa-sign-out-alt fa-lg"></i>
</button>
            </div>
<div class="flex items-stretch justify-between w-full gap-2 mt-2">
        <button id="btn-my-info" onclick="openMyInfo()" class="hidden flex-1 py-3 text-xs font-bold text-gray-600 bg-white border border-gray-200 hover:border-gray-400 hover:text-gray-900 rounded-xl transition flex items-center justify-center gap-2 shadow-sm">
            <i class="fas fa-chart-pie"></i> ë‚´ ì„±ì í‘œ
        </button>
        
        <button id="btn-class-status" onclick="openTeacherStatus()" class="hidden flex-1 py-3 text-xs font-bold text-white bg-gray-900 hover:bg-black rounded-xl transition flex items-center justify-center gap-2 shadow-lg">
            <i class="fas fa-chalkboard-teacher"></i> í•™ê¸‰ í˜„í™©
        </button>

        <button onclick="refreshData()" class="w-12 py-3 text-gray-500 bg-gray-100 hover:bg-gray-200 rounded-xl transition flex items-center justify-center shadow-sm shrink-0 border border-gray-200">
            <i class="fas fa-sync-alt"></i> 
        </button>
    </div>
    </aside>

    <div class="flex-1 flex flex-col min-w-0 overflow-hidden bg-gray-50 relative">
        <header class="bg-white h-16 border-b border-gray-200 flex items-center justify-between px-6 flex-shrink-0 shadow-sm z-20">
            <div class="flex items-center gap-4">
                <button onclick="toggleSidebar()" class="text-gray-400 hover:text-gray-900 transition p-1"><i class="fas fa-bars text-lg"></i></button>
                <h2 id="header-title" class="text-lg font-bold text-gray-800">ëŒ€ì‹œë³´ë“œ</h2>
            </div>
            <div class="text-right hidden md:block">
                <div id="clock-date" class="text-[10px] text-gray-400 font-bold uppercase tracking-wider">YYYY. MM. DD</div>
                <div id="clock-time" class="text-base font-bold text-gray-800 num-font leading-none mt-0.5">00:00</div>
            </div>
        </header>

        <main class="flex-1 overflow-hidden relative p-4 md:p-8">
            
<div id="view-dashboard" class="absolute inset-0 p-4 md:p-8 overflow-y-auto space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                    <div class="bg-white p-6 rounded-2xl border border-gray-300 shadow-sm flex flex-col justify-center">
                        <p class="text-[10px] font-bold text-gray-500 uppercase tracking-widest mb-2 flex items-center gap-1"><i class="fas fa-school"></i> ë‚˜ì˜ í•™êµ</p>
                        <p id="dash-school-name" class="text-3xl font-black text-gray-900 truncate">-</p>
                    </div>
                    <div class="bg-white p-6 rounded-2xl border border-gray-300 shadow-sm flex flex-col relative h-40">
                        <div class="flex justify-between items-center mb-2">
                            <p class="text-[12px] font-bold text-gray-500 uppercase tracking-widest flex items-center gap-1"><i class="fas fa-bullhorn"></i> ê³µì§€ì‚¬í•­</p>
                            <span id="memo-status" class="text-[12px] text-gray-900 font-bold hidden bg-gray-200 px-2 py-0.5 rounded">SAVED</span>
                        </div>
                        <textarea id="dash-memo" class="flex-1 w-full bg-transparent resize-none outline-none text-sm text-gray-800 leading-relaxed font-medium placeholder-gray-300" placeholder="ê³µì§€ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”."></textarea>
                    </div>
                </div>
                <div class="bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden p-6">
                    <div class="flex justify-between items-center mb-4">
                        <div>
                            <h3 class="font-black text-gray-900 text-xl tracking-tight">ìˆœìœ„</h3>
                        </div>
                        <span class="text-xs font-bold text-gray-400 bg-gray-100 px-2 py-1 rounded">ì‹¤ì‹œê°„</span>
                    </div>
                    <div id="ranking-list" class="space-y-3">
                        <div class="p-8 text-center text-gray-400 text-sm">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                    </div>
                </div>
            </div>

            <div id="view-student" class="absolute inset-0 bg-gray-50 hidden z-20 flex flex-col items-center justify-center p-6">
                <div id="quiz-ready-screen" class="absolute inset-0 z-30 bg-white/95 flex flex-col items-center justify-center p-8 text-center backdrop-blur-sm">
                    <h2 class="text-4xl font-black text-gray-900 mb-2">ì¤€ë¹„ë˜ì—ˆë‚˜ìš”?</h2>
                    <p id="ready-subject-name" class="text-xl text-gray-500 font-bold mb-8">-</p>
                    <div class="bg-gray-100 p-6 rounded-2xl mb-8 max-w-sm w-full border border-gray-200">
                        <p class="text-sm text-gray-500 font-bold uppercase mb-2">ëª©í‘œì ìˆ˜</p>
                        <p class="text-5xl font-black text-gray-900 num-font mb-4">50<span class="text-2xl text-gray-400 ml-1">ì </span></p>
                        <div class="flex justify-between text-sm font-medium text-gray-500 border-t border-gray-200 pt-2">
                        </div>
                    </div>
                    <button onclick="startQuizFlow()" class="bg-gray-900 hover:bg-black text-white text-xl font-bold py-4 px-12 rounded-full shadow-xl transition transform hover:scale-105">ë„ì „í•˜ê¸°</button>
                    <button onclick="goDashboard()" class="mt-6 text-gray-400 hover:text-gray-600 text-sm underline">ë‚˜ê°€ê¸°</button>
                </div>

                <div class="w-full max-w-4xl bg-white flex flex-col h-full rounded-3xl shadow-2xl border border-gray-200 overflow-hidden relative">
                    <div class="h-20 bg-white border-b border-gray-100 flex items-center justify-between px-8 shrink-0">
                        <div class="flex items-center gap-4">
                            <div class="bg-gray-100 px-3 py-1 rounded-lg border border-gray-200 flex items-center gap-2">
                                <i class="fas fa-stopwatch text-gray-400"></i><span id="quiz-timer" class="text-lg font-black text-gray-800 num-font">0.0s</span>
                            </div>
                            <span id="quiz-header-title" class="font-black text-gray-900 text-lg tracking-tight truncate hidden md:block"></span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="text-xs font-bold text-gray-400 uppercase">ì ìˆ˜</span>
                            <span id="current-quiz-score" class="text-3xl font-black text-gray-900 num-font">0</span>
                            <span class="text-sm text-gray-300 font-bold">/ 50</span>
                        </div>
                        <button onclick="finishQuiz()" class="text-gray-400 hover:text-gray-900 font-bold text-sm underline shrink-0 ml-4">ê·¸ë§Œí•˜ê¸°</button>
                    </div>
                    
                    <div id="quiz-content-area" class="flex-1 p-4 relative bg-gray-50/50 overflow-hidden flex items-center justify-center"></div>
                    
                  <div id="quiz-options" class="h-auto bg-white border-t border-gray-200 p-2 grid grid-cols-2 gap-2 shrink-0"></div>
                    
                    <div id="quiz-feedback" class="absolute inset-0 bg-white/90 hidden z-50 flex items-center justify-center backdrop-blur-sm">
                        <span id="feedback-icon" class="text-9xl font-black text-gray-900">O</span>
                    </div>

                    <div id="quiz-result-view" class="absolute inset-0 bg-white z-40 hidden flex-col items-center justify-center p-8 text-center animate-fade-in">
                        <h2 class="text-3xl font-black text-gray-900 mb-2">MISSION COMPLETE!</h2>
                        <div class="w-full h-px bg-gray-200 my-6"></div>
                        <div class="grid grid-cols-2 gap-8 mb-8 w-full max-w-md">
                            <div>
                                <p class="text-xs text-gray-400 font-bold uppercase mb-1">Rank</p>
                                <p id="result-rank" class="text-6xl font-black text-purple-600 rank-text-sss">SSS</p>
                            </div>
                            <div>
                                <p class="text-xs text-gray-400 font-bold uppercase mb-1">Time</p>
                                <p id="result-time" class="text-4xl font-black text-gray-800 num-font mt-2">0.0s</p>
                            </div>
                        </div>
                        <button onclick="goDashboard()" class="bg-gray-900 hover:bg-black text-white text-lg font-bold py-4 px-10 rounded-xl shadow-lg transition w-full max-w-sm">ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°</button>
                    </div>
                </div>
            </div>

            <div id="view-teacher" class="absolute inset-0 bg-gray-900 hidden flex flex-col z-20">
                <div class="h-16 bg-gray-900 border-b border-gray-800 flex items-center justify-between px-6 shrink-0">
                    <div class="flex items-center gap-4"><span id="board-title" class="text-white font-bold text-lg tracking-tight">ì£¼ì œ</span></div>
 <div class="flex items-center gap-3">
                        <button onclick="generateBoardProblem()" class="bg-gray-800 hover:bg-gray-700 text-white px-4 py-2 rounded-lg text-sm font-bold border border-gray-700">ë¬¸ì œ ë„ìš°ê¸°</button>
                        
                        <button id="btn-board-mode" onclick="toggleBoardMode()" class="bg-green-600 hover:bg-green-500 text-white px-3 py-2 rounded-lg text-sm font-bold border border-green-700 shadow transition flex items-center gap-2">
                            <i class="fas fa-pen"></i> <span>í•„ê¸°ëª¨ë“œ</span>
                        </button>

                        <div class="h-6 w-px bg-gray-800 mx-2"></div>
                        <div class="flex gap-2 bg-gray-800 p-1.5 rounded-full border border-gray-700">
                            <button class="w-6 h-6 rounded-full bg-black border-2 border-transparent hover:scale-110 transition" onclick="setPen('#000000')"></button>
                            <button class="w-6 h-6 rounded-full bg-blue-600 border-2 border-transparent hover:scale-110 transition" onclick="setPen('#2563eb')"></button>
                            <button class="w-6 h-6 rounded-full bg-red-500 border-2 border-transparent hover:scale-110 transition" onclick="setPen('#ef4444')"></button>
                            <button class="w-6 h-6 rounded-full bg-yellow-400 border-2 border-transparent hover:scale-110 transition" onclick="setPen('#facc15')"></button>
                        </div>
                        <button onclick="clearBoard()" class="text-gray-500 hover:text-white ml-2 p-2"><i class="fas fa-trash-alt"></i></button>
                        <button onclick="goDashboard()" class="text-gray-400 hover:text-white font-bold text-sm ml-2 bg-gray-800 px-3 py-1.5 rounded-lg border border-gray-700">ë‚˜ê°€ê¸°</button>
                    </div>
                </div>
                <div class="flex-1 relative cursor-pen bg-gray-900" id="board-area">
                    <canvas id="board-canvas" class="block w-full h-full touch-none"></canvas>
                    <div id="board-overlay" class="absolute top-24 left-0 w-full flex justify-center pointer-events-none p-6"></div>
                </div>
            </div>

            <div id="view-learning" class="hidden absolute inset-0 bg-[#18181b] z-[60] flex-col text-white">
                <div class="h-16 flex items-center justify-between px-6 border-b border-gray-700 bg-gray-900/50">
                    <h2 class="text-lg md:text-xl font-bold text-gray-400">
                        ìˆ˜ì—… ëª¨ë“œ <span class="mx-2 text-gray-600">|</span> <span id="learning-subject-title" class="text-white text-xl md:text-2xl font-black"></span>
                    </h2>
                    <button onclick="exitLearningMode()" class="bg-red-600 hover:bg-red-500 text-white font-bold py-2 px-6 rounded-lg transition">ë‚˜ê°€ê¸°</button>
                </div>
                
                <div class="flex-1 flex overflow-hidden relative">
                    <div class="flex-1 relative border-r-2 border-gray-700 bg-[#202025] flex flex-col">
                        <div id="learning-problem-area" class="w-full h-full overflow-y-auto flex flex-col items-center justify-start p-10 z-[1]">
                            <span class="text-gray-500">ì£¼ì œë¥¼ ì„ íƒí•˜ê³  ì‹œì‘í•´ì£¼ì„¸ìš”.</span>
                        </div>
                        <canvas id="canvas-left" class="absolute inset-0 w-full h-full cursor-crosshair touch-none z-[10]"></canvas>
                        <div id="mode-indicator" class="absolute top-4 left-4 px-3 py-1 bg-black/60 rounded-full text-xs font-bold text-green-400 border border-green-500/30 pointer-events-none transition-all z-[20]">
                            âœï¸ í•„ê¸° ëª¨ë“œ
                        </div>
                    </div>

                    <div class="flex-1 relative bg-[#2a2a30]">
                        <div class="absolute inset-0 opacity-10 pointer-events-none" style="background-image: linear-gradient(#999 1px, transparent 1px), linear-gradient(90deg, #999 1px, transparent 1px); background-size: 40px 40px;"></div>
                        <canvas id="canvas-right" class="absolute inset-0 w-full h-full cursor-crosshair touch-none z-[10]"></canvas>
                    </div>

                    <div id="learning-toolbar" class="absolute top-1/2 right-5 -translate-y-1/2 bg-gray-900/90 p-4 rounded-2xl flex flex-col items-center gap-3 z-[30] border border-gray-700 shadow-2xl backdrop-blur-sm transition-transform duration-300">
                        <div id="toolbar-toggle-btn" onclick="toggleToolbar()" class="absolute -left-7 top-1/2 -translate-y-1/2 w-7 h-16 bg-gray-900/90 border-y border-l border-gray-700 rounded-l-lg flex items-center justify-center text-yellow-400 cursor-pointer shadow-lg">â–¶</div>
                        
                        <button onclick="nextLearningProblem()" class="bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 px-3 rounded-lg text-sm w-full">ë‹¤ìŒ â–¶</button>
                        <div class="w-full h-px bg-gray-600 my-1"></div>
                        
                        <button id="btn-scroll-toggle" onclick="toggleScrollMode()" class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-2 rounded-lg text-xs w-full">ğŸ‘† ìŠ¤í¬ë¡¤</button>
                        <div class="w-full h-px bg-gray-600 my-1"></div>

                        <div class="w-7 h-7 rounded-full bg-white border-2 border-gray-400 cursor-pointer hover:scale-110 transition" onclick="setLearnPen('#ffffff', this)"></div>
                        <div class="w-7 h-7 rounded-full bg-yellow-400 border-2 border-white cursor-pointer hover:scale-110 transition scale-110 shadow-lg shadow-yellow-500/50 active-pen" onclick="setLearnPen('#facc15', this)"></div>
                        <div class="w-7 h-7 rounded-full bg-red-500 border-2 border-gray-400 cursor-pointer hover:scale-110 transition" onclick="setLearnPen('#ef4444', this)"></div>
                        <div class="w-7 h-7 rounded-full bg-blue-500 border-2 border-gray-400 cursor-pointer hover:scale-110 transition" onclick="setLearnPen('#3b82f6', this)"></div>
                        
                        <div class="w-7 h-7 rounded-full bg-gray-600 border-2 border-gray-400 cursor-pointer hover:scale-110 transition flex items-center justify-center text-xs" onclick="setLearnEraser(this)">ğŸ§¹</div>
                        
                        <div class="w-full h-px bg-gray-600 my-1"></div>
                        <button onclick="clearCanvas('left')" class="text-xs text-gray-400 hover:text-white">ë¬¸ì œì§€ì›€</button>
                        <button onclick="clearCanvas('right')" class="text-xs text-gray-400 hover:text-white">ë…¸íŠ¸ì§€ì›€</button>
                    </div>
                </div>
            </div>

            <div id="view-my-info" class="absolute inset-0 bg-gray-900/50 hidden z-[60] flex items-center justify-center backdrop-blur-sm p-4">
                <div class="bg-white w-full max-w-4xl h-[90%] rounded-3xl shadow-2xl flex flex-col overflow-hidden">
                    <div class="px-8 py-6 border-b border-gray-100 flex justify-between items-center bg-white">
                        <div>
                            <h2 class="text-2xl font-black text-gray-900 tracking-tight">í•™ìŠµ ë¦¬í¬íŠ¸</h2>
                            <p class="text-sm text-gray-500 mt-1" id="info-user-sub">-</p>
                        </div>
                        <button onclick="closeMyInfo()" class="w-10 h-10 rounded-full bg-gray-50 hover:bg-gray-100 flex items-center justify-center transition"><i class="fas fa-times text-gray-500"></i></button>
                    </div>
                    <div class="flex-1 overflow-y-auto p-8 bg-gray-50">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-white p-6 rounded-2xl border border-gray-200 text-center shadow-sm">
                                <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Total Score</p>
                                <p id="info-total" class="text-4xl font-black text-gray-900 mt-2 num-font tracking-tight">0</p>
                            </div>
                            <div class="bg-white p-6 rounded-2xl border border-gray-200 text-center shadow-sm">
                                <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">SSS Rank</p>
                                <p id="info-sss" class="text-4xl font-black text-gray-900 mt-2 num-font tracking-tight">0</p>
                            </div>
                            <div class="bg-white p-6 rounded-2xl border border-gray-200 text-center shadow-sm">
                                <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Solved</p>
                                <p id="info-count" class="text-4xl font-black text-gray-900 mt-2 num-font tracking-tight">0</p>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm">
                            <table class="w-full text-left">
<thead class="bg-gray-50 text-xs font-bold text-gray-400 uppercase border-b border-gray-200">
    <tr>
        <th class="px-3 md:px-6 py-3 md:py-4 whitespace-nowrap">ì£¼ì œ</th>
        <th class="px-3 md:px-6 py-3 md:py-4 whitespace-nowrap text-center">ë“±ê¸‰</th>
        <th class="px-3 md:px-6 py-3 md:py-4 whitespace-nowrap text-right">ì‹œê°„</th>
        <th class="px-3 md:px-6 py-3 md:py-4 whitespace-nowrap text-center">ì ìˆ˜</th>
    </tr>
</thead>
                                <tbody id="info-table-body" class="divide-y divide-gray-100 text-sm text-gray-600 font-medium"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="view-teacher-status" class="absolute inset-0 bg-gray-900/50 hidden z-50 flex items-center justify-center backdrop-blur-sm p-4">
                <div class="bg-white w-full max-w-5xl h-[90%] rounded-3xl shadow-2xl flex flex-col overflow-hidden border border-gray-200">
                    <div class="px-8 py-6 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                        <div>
                            <h2 class="text-2xl font-black text-gray-900 tracking-tight">ğŸ“Š í•™ê¸‰ í•™ìŠµ í˜„í™©</h2>
                            <p class="text-xs text-gray-500 mt-1">ì´ë¦„ì„ í´ë¦­í•˜ë©´ ìƒì„¸ ì„±ì í‘œë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                        </div>
                        <button onclick="closeTeacherStatus()" class="w-10 h-10 rounded-full bg-gray-900 hover:bg-black flex items-center justify-center text-white"><i class="fas fa-times"></i></button>
                    </div>
                    <div class="flex-1 overflow-auto p-0">
                        <table class="w-full text-left text-sm status-table border-collapse">
                            <thead class="bg-white text-xs font-bold text-gray-500 uppercase border-b border-gray-200 sticky top-0 z-20 shadow-sm">
                                <tr id="status-table-head"></tr>
                            </thead>
                            <tbody id="status-table-body" class="divide-y divide-gray-100 bg-white"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div id="data-modal" class="fixed inset-0 bg-black/80 z-[100] hidden flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-2xl w-full max-w-3xl max-h-[90vh] flex flex-col overflow-hidden shadow-2xl animate-fade-in">
            <div class="p-4 border-b flex justify-between items-center bg-gray-50">
                <h3 id="modal-title" class="text-xl font-black text-gray-800">ìë£Œ ë³´ê¸°</h3>
                <button onclick="closeModal()" class="w-10 h-10 rounded-full bg-white border hover:bg-gray-100 flex items-center justify-center text-lg font-bold transition">&times;</button>
            </div>
            <div id="modal-content" class="flex-1 p-6 overflow-y-auto bg-white flex flex-col items-center text-left"></div>
            <div class="p-4 border-t bg-gray-50 text-center">
                <button onclick="closeModal()" class="py-4 px-12 bg-gray-900 text-white text-xl font-bold rounded-2xl hover:bg-black transition shadow-lg">ë‹«ê¸° (ë¬¸ì œ í’€ê¸°)</button>
            </div>
        </div>
    </div>
    
 <script>
   let currentQuiz = null; // í˜„ì¬ í’€ê³  ìˆëŠ” ë¬¸ì œ ë°ì´í„° ì €ì¥
let sidebarOpen = false; // ì‚¬ì´ë“œë°” ìƒíƒœ
        // -----------------------------------------------------------
        // [Step 3] ê¸°ë³¸ ì„¤ì • ë° ë°ì´í„° ë±…í¬ (Code 2 ë°ì´í„° ì™„ë²½ ì´ì‹)
        // -----------------------------------------------------------
        
        // [Google Apps Script URL] (ê¸°ì¡´ 1ë²ˆ ì½”ë“œ ìœ ì§€)
        const GAS_URL = "https://script.google.com/macros/s/AKfycbywsxcD_kyk1j_MX4oChEqTCkuPUSl21FCvLjhGEs72d-El_nP-dBMA50a7Gy5ajIUi/exec";

        // [ì „ì—­ ìƒíƒœ ê´€ë¦¬]
let AppState = { 
            user: null, 
            users: [], 
            records: [], 
            memo: "", 
            currentSubject: null, 
            quizStartTime: 0, 
            currentScore: 0, 
            timerInterval: null,
            isScrollMode: false,
            drawCtx: { color: '#facc15', width: 3, isEraser: false },
            // [ì¶”ê°€ë¨] ì €ìš¸ ê²Œì„ ìƒíƒœ ê´€ë¦¬
            scaleState: { current: 0, target: 0 }
        };
        
        var currentModalContent = ""; // ëª¨ë‹¬ì— ë„ìš¸ ë‚´ìš© ì €ì¥

        // ==========================================
        // [1] í•„ìˆ˜ í—¬í¼ í•¨ìˆ˜ (Code 1 + Code 2 í†µí•©)
        // ==========================================
        
        // í•œê¸€ ìëª¨ ë°ì´í„°
        const H_CHO = ['ã„±', 'ã„²', 'ã„´', 'ã„·', 'ã„¸', 'ã„¹', 'ã…', 'ã…‚', 'ã…ƒ', 'ã……', 'ã…†', 'ã…‡', 'ã…ˆ', 'ã…‰', 'ã…Š', 'ã…‹', 'ã…Œ', 'ã…', 'ã…'];
        const H_JUNG = ['ã…', 'ã…', 'ã…‘', 'ã…’', 'ã…“', 'ã…”', 'ã…•', 'ã…–', 'ã…—', 'ã…˜', 'ã…™', 'ã…š', 'ã…›', 'ã…œ', 'ã…', 'ã…', 'ã…Ÿ', 'ã… ', 'ã…¡', 'ã…¢', 'ã…£'];
        const H_JONG = ['', 'ã„±', 'ã„²', 'ã„³', 'ã„´', 'ã„µ', 'ã„¶', 'ã„·', 'ã„¹', 'ã„º', 'ã„»', 'ã„¼', 'ã„½', 'ã„¾', 'ã„¿', 'ã…€', 'ã…', 'ã…‚', 'ã…„', 'ã……', 'ã…†', 'ã…‡', 'ã…ˆ', 'ã…Š', 'ã…‹', 'ã…Œ', 'ã…', 'ã…'];
   
function toggleSidebar() {
    sidebarOpen = !sidebarOpen;
    const sb = document.getElementById('main-sidebar');
    const overlay = document.getElementById('sidebar-overlay'); // ì˜¤ë²„ë ˆì´ ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°

    if (sidebarOpen) { 
        sb.classList.remove('-translate-x-full');
        if(overlay) overlay.classList.remove('hidden'); // ì˜¤ë²„ë ˆì´ ë³´ì´ê¸°
    } else { 
        sb.classList.add('-translate-x-full');
        if(overlay) overlay.classList.add('hidden'); // ì˜¤ë²„ë ˆì´ ìˆ¨ê¸°ê¸°
    }
}

    // 2. ì¸ì¦(ë¡œê·¸ì¸) ê´€ë ¨
    let authMode = 'login';
    function switchAuthTab(mode) {
        authMode = mode;
        document.getElementById('tab-login').className = mode==='login' ? 'flex-1 py-3 text-sm font-bold text-gray-900 border-b-2 border-gray-900 transition' : 'flex-1 py-3 text-sm font-bold text-gray-400 hover:text-gray-600 transition';
        document.getElementById('tab-signup').className = mode==='signup' ? 'flex-1 py-3 text-sm font-bold text-gray-900 border-b-2 border-gray-900 transition' : 'flex-1 py-3 text-sm font-bold text-gray-400 hover:text-gray-600 transition';
        document.getElementById('btn-auth-submit').innerText = mode==='login' ? 'ë¡œê·¸ì¸' : 'íšŒì›ê°€ì…';
        const signupFields = document.querySelectorAll('.auth-signup-field');
        signupFields.forEach(el => el.style.display = mode==='login' ? 'none' : 'block');
    }

    let selectedRole = null;
    function setRole(role) {
        selectedRole = role;
        if(role) {
            document.getElementById('btn-role-teacher').className = role==='teacher' ? 'p-3 border-2 border-gray-900 bg-gray-50 rounded-xl flex flex-col items-center justify-center gap-1 transition text-gray-900' : 'p-3 border-2 border-gray-200 rounded-xl flex flex-col items-center justify-center gap-1 transition text-gray-400 hover:border-gray-400';
            document.getElementById('btn-role-student').className = role==='student' ? 'p-3 border-2 border-gray-900 bg-gray-50 rounded-xl flex flex-col items-center justify-center gap-1 transition text-gray-900' : 'p-3 border-2 border-gray-200 rounded-xl flex flex-col items-center justify-center gap-1 transition text-gray-400 hover:border-gray-400';
        } else {
            // ì´ˆê¸°í™”
            document.querySelectorAll('#auth-modal button[id^="btn-role"]').forEach(b => b.className = 'p-3 border-2 border-gray-200 rounded-xl flex flex-col items-center justify-center gap-1 transition text-gray-400 hover:border-gray-400');
        }
    }

    // 3. ì„œë²„ í†µì‹  (êµ¬ê¸€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸)
    function loadDataFromServer() {
        fetch(GAS_URL + "?action=getData")
            .then(res => res.json())
            .then(data => {
                AppState.users = data.users;
                AppState.records = data.records;
                AppState.memo = data.memo;
                document.getElementById('loading-overlay').classList.add('hidden');
                
                // ë¡œê·¸ì¸ ì²´í¬
                const savedId = localStorage.getItem('cp_uid');
                if(savedId) {
                    const u = AppState.users.find(x => x.id === savedId);
                    if(u) loginSuccess(u);
                    else document.getElementById('auth-modal').classList.remove('hidden');
                } else {
                    document.getElementById('auth-modal').classList.remove('hidden');
                }
                updateRankingBoard();
            })
            .catch(err => {
                console.error(err);
                alert("ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨. ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.");
                document.getElementById('loading-overlay').classList.add('hidden');
            });
    }

    function saveRecordToServer(record) {
        AppState.records.push(record); // ë¡œì»¬ ì„ ë°˜ì˜
        const params = new URLSearchParams({ action: 'saveRecord', data: JSON.stringify(record) });
        fetch(GAS_URL, { method: 'POST', body: params }).catch(e => console.log("ê¸°ë¡ ì €ì¥ ì‹¤íŒ¨(ë°±ê·¸ë¼ìš´ë“œ)"));
    }

    function saveMemoToServer(memo) {
        const params = new URLSearchParams({ action: 'saveMemo', memo: memo });
        fetch(GAS_URL, { method: 'POST', body: params });
    }

  function processAuth() {
        // ì…ë ¥ê°’ì—ì„œ ì•ë’¤ ê³µë°± ì œê±° ë° ë¬¸ìì—´ ë³€í™˜
        const id = String(document.getElementById('input-id').value).trim();
        const pw = String(document.getElementById('input-pw').value).trim();
        
        if(authMode === 'login') {
            // [ìˆ˜ì •ë¨] ì €ì¥ëœ ë°ì´í„°ë„ Stringìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ë¹„êµ
            const user = AppState.users.find(u => String(u.id) === id && String(u.pw) === pw);
            if(user) {
                // ì—­í• (Role) ì²´í¬: ì„ íƒëœ ì—­í• ì´ ìˆì„ ë•Œë§Œ ì²´í¬
                if(selectedRole && user.role !== selectedRole) { 
                    alert("ê°€ì…ëœ ì—­í• (" + (user.role==='teacher'?'ì„ ìƒë‹˜':'í•™ìƒ') + ")ê³¼ ì„ íƒí•œ ì—­í• ì´ ë‹¤ë¦…ë‹ˆë‹¤."); 
                    return; 
                }
                loginSuccess(user);
            } else {
                alert("ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.\n(ëŒ€ì†Œë¬¸ì ë° ë„ì–´ì“°ê¸° í™•ì¸)");
            }
        } else {
            // íšŒì›ê°€ì…
            const name = document.getElementById('input-name').value.trim();
            const school = document.getElementById('input-school').value.trim();
            
            if(!id || !pw || !name || !selectedRole) { alert("ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }
            
            // [ìˆ˜ì •ë¨] ì¤‘ë³µ ì²´í¬ ì‹œì—ë„ String ë³€í™˜
            if(AppState.users.find(u => String(u.id) === id)) { alert("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì•„ì´ë””ì…ë‹ˆë‹¤."); return; }
            
            const newUser = { id, pw, name, school, role: selectedRole, joinDate: new Date().toISOString() };
            
            // UI ì„ ë°˜ì˜
            AppState.users.push(newUser);
            loginSuccess(newUser);

            // ì„œë²„ ì €ì¥
            const params = new URLSearchParams({ action: 'signup', data: JSON.stringify(newUser) });
            fetch(GAS_URL, { method: 'POST', body: params })
                .then(r => r.text())
                .then(t => { 
                    if(t!=='success') console.error("ì„œë²„ ì €ì¥ ì‹¤íŒ¨: " + t); 
                })
                .catch(err => console.error("í†µì‹  ì˜¤ë¥˜:", err));
        }
    }

function loginSuccess(user) {
        AppState.user = user;
        localStorage.setItem('cp_uid', user.id);
        document.getElementById('auth-modal').classList.add('hidden');
 document.getElementById('profile-name').innerText = user.name + (user.role==='teacher'?' ì„ ìƒë‹˜':' í•™ìƒ');
    document.getElementById('profile-school').innerText = user.school;
    
    // [ìˆ˜ì •] ëŒ€ì‹œë³´ë“œ ë©”ì¸ í™”ë©´ì—ë„ í•™êµ ì´ë¦„ ë°˜ì˜
    document.getElementById('dash-school-name').innerText = user.school;
  if (user.role === 'student') {
        const totalPoint = AppState.records
            .filter(r => String(r.userId) === String(user.id) && r.subjectId === 'point')
            .reduce((sum, r) => sum + Number(r.score), 0);
        document.getElementById('reward-area').classList.remove('hidden');
        document.getElementById('reward-score').innerText = totalPoint;
    } else {
        document.getElementById('reward-area').classList.add('hidden');
    }
        
        // ê³µì§€ì‚¬í•­ ë°ì´í„° ë°˜ì˜ (ì¤‘ìš”)
        const memoEl = document.getElementById('dash-memo');
        memoEl.value = AppState.memo || ""; // ë°ì´í„° ì—†ìœ¼ë©´ ë¹ˆ ë¬¸ìì—´

        if(user.role === 'teacher') {
            memoEl.readOnly = false;
            document.getElementById('btn-class-status').classList.remove('hidden');
            document.getElementById('btn-my-info').classList.add('hidden');
        } else {
            memoEl.readOnly = true;
            document.getElementById('btn-class-status').classList.add('hidden');
            document.getElementById('btn-my-info').classList.remove('hidden');
        }
        
        renderSidebarMenu();
        // [ìˆ˜ì •] ë¡œê·¸ì¸ í›„ ì¦‰ì‹œ ëŒ€ì‹œë³´ë“œ í™”ë©´ìœ¼ë¡œ ì´ë™í•˜ë„ë¡ í˜¸ì¶œ
        goDashboard();
    }
function handleLogout() {
    if(confirm("ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
        // [ìˆ˜ì •] ì‚¬ì´ë“œë°” ê°•ì œ ë‹«ê¸° ë¡œì§ ì¶”ê°€
        sidebarOpen = false;
        document.getElementById('main-sidebar').classList.add('-translate-x-full');
        document.getElementById('sidebar-overlay').classList.add('hidden');

        // 1. ë°ì´í„° ì‚­ì œ
        localStorage.removeItem('cp_uid');
        AppState.user = null;
        
        // 2. í™”ë©´ ê°•ì œ ì „í™˜ (ìƒˆë¡œê³ ì¹¨ ì—†ì´ ì¦‰ì‹œ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ)
        document.getElementById('view-dashboard').classList.add('hidden');
        document.getElementById('view-teacher').classList.add('hidden');
        document.getElementById('view-student').classList.add('hidden');
        document.getElementById('view-my-info').classList.add('hidden');
        document.getElementById('view-teacher-status').classList.add('hidden');
        document.getElementById('view-learning').classList.add('hidden');
        
        // 3. ë¡œê·¸ì¸ ëª¨ë‹¬ í™œì„±í™” ë° ì…ë ¥ì°½ ì´ˆê¸°í™”
        document.getElementById('auth-modal').classList.remove('hidden');
        document.getElementById('input-id').value = '';
        document.getElementById('input-pw').value = '';
        document.getElementById('profile-name').innerText = 'Guest';
        document.getElementById('profile-school').innerText = 'Login Required';
        
        // 4. ì•ˆì „ì„ ìœ„í•´ ë¦¬ë¡œë“œ (ì„ íƒì‚¬í•­ì´ë‚˜ ê¹”ë”í•œ ì´ˆê¸°í™”ë¥¼ ìœ„í•´ ê¶Œì¥)
        setTimeout(() => location.reload(), 100);
    }
}

    // 4. ë©”ë‰´ ë° ë­í‚¹ ë Œë”ë§
// 4. ë©”ë‰´ ë° ë­í‚¹ ë Œë”ë§ (ì•„ì½”ë””ì–¸ ìŠ¤íƒ€ì¼ë¡œ ë³€ê²½)
    function renderSidebarMenu() {
        const list = document.getElementById('sidebar-menu');
        list.innerHTML = "";
    MenuData.forEach((cat, idx) => {
            // ëª¨ë“  ë©”ë‰´ ì ‘íŒ ìƒíƒœë¡œ ì‹œì‘ (open ì†ì„± ì œê±°)
            const isOpen = ''; 
            let html = `
            <details class="group mb-2 px-3" ${isOpen}>
                <summary class="flex items-center justify-between cursor-pointer p-3 rounded-lg hover:bg-gray-100 transition list-none text-gray-700 font-bold text-sm select-none border border-transparent hover:border-gray-200">
                    <span class="flex items-center gap-2"><i class="fas ${cat.icon} w-5 text-center text-gray-400"></i> ${cat.category}</span>
                    <i class="fas fa-chevron-down text-xs text-gray-300 group-open:rotate-180 transition-transform"></i>
                </summary>
                <div class="mt-1 space-y-0.5 pl-2 border-l-2 border-gray-100 ml-4">`;
            
            cat.items.forEach(item => {
                html += `<button onclick="selectMenu('${encodeURIComponent(JSON.stringify(item))}')" class="w-full text-left px-4 py-2.5 text-xs font-medium text-gray-500 hover:text-gray-900 hover:bg-gray-50 rounded-md transition flex items-center gap-2">
                            ${item.name}
                         </button>`;
            });
            html += `</div></details>`;
            list.innerHTML += html;
        });
    }

    // í€´ì¦ˆ ì‹œì‘ í™”ë©´ (í•™ìƒìš©)
    function openStudentQuiz() {
        document.getElementById('view-dashboard').classList.add('hidden');
        document.getElementById('view-student').classList.remove('hidden');
        document.getElementById('view-student').classList.add('flex');
        
        // ëŒ€ê¸° í™”ë©´ ì´ˆê¸°í™”
        document.getElementById('quiz-ready-screen').classList.remove('hidden');
        document.getElementById('ready-subject-name').innerText = AppState.currentSubject.name;
    }

    function startQuizFlow() {
        document.getElementById('quiz-ready-screen').classList.add('hidden');
        document.getElementById('quiz-header-title').innerText = AppState.currentSubject.name;
        AppState.currentScore = 0;
        AppState.quizStartTime = Date.now();
        updateScoreUI();
        
        // íƒ€ì´ë¨¸ ì‹œì‘
        if(AppState.timerInterval) clearInterval(AppState.timerInterval);
        AppState.timerInterval = setInterval(() => {
            const now = Date.now();
            const diff = (now - AppState.quizStartTime) / 1000;
            document.getElementById('quiz-timer').innerText = diff.toFixed(1) + "s";
        }, 100);

        nextQuiz();
    }

 function updateRankingBoard() {
        // [ìˆ˜ì •ë¨] ê³¼ëª©ë³„ ìµœê³  ê¸°ë¡ í•©ì‚° ë¡œì§ (ì‹œê°„ í¬í•¨)
        const stats = {}; // { uid: { name, school, subjects: { subId: { score, time } } } }

        AppState.records.forEach(r => {
            const uid = String(r.userId);
            if (!stats[uid]) {
                const u = AppState.users.find(user => String(user.id) === uid);
                stats[uid] = { name: u ? u.name : 'Unknown', school: u ? u.school : '', subjects: {} };
            }
            // í•´ë‹¹ ê³¼ëª©ì´ ì—†ê±°ë‚˜, ë” ë†’ì€ ì ìˆ˜(ë˜ëŠ” ê°™ì€ ì ìˆ˜ë©´ ë” ë¹ ë¥¸ ì‹œê°„)ì¼ ë•Œ ê°±ì‹ 
            if (!stats[uid].subjects[r.subjectId] || 
                r.score > stats[uid].subjects[r.subjectId].score || 
                (r.score === stats[uid].subjects[r.subjectId].score && r.time < stats[uid].subjects[r.subjectId].time)) {
                stats[uid].subjects[r.subjectId] = { score: Number(r.score), time: Number(r.time) };
            }
        });

        // ì´ì  ë° ì´ ì‹œê°„ ê³„ì‚°
        const sorted = Object.values(stats).map(user => {
            let totalScore = 0;
            let totalTime = 0;
            Object.values(user.subjects).forEach(s => {
                totalScore += s.score;
                totalTime += s.time;
            });
            return { ...user, totalScore, totalTime };
        }).sort((a, b) => {
            // 1ìˆœìœ„: ì´ì  (ë‚´ë¦¼ì°¨ìˆœ)
            if (b.totalScore !== a.totalScore) return b.totalScore - a.totalScore;
            // 2ìˆœìœ„: ì´ ì‹œê°„ (ì˜¤ë¦„ì°¨ìˆœ - ì ê²Œ ê±¸ë¦° ìˆœ)
            return a.totalTime - b.totalTime;
        }).slice(0, 5);

        // UI ë Œë”ë§
        const list = document.getElementById('ranking-list');
        list.innerHTML = "";
        
        if (sorted.length === 0) {
            list.innerHTML = `<div class="p-4 text-center text-gray-400">ì•„ì§ ë­í‚¹ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
            return;
        }

 sorted.forEach((item, idx) => {
            // [ìˆ˜ì •] ì´ëª¨í‹°ì½˜ ì œê±°, ì‹¬í”Œí•œ ìˆ«ì ë°°ì§€ ë° í‘ë°± í†¤ ë””ìì¸ ì ìš©
            let badgeClass = "bg-gray-100 text-gray-400";
            if(idx === 0) badgeClass = "bg-black text-white shadow-md";       // 1ë“±: ê²€ì •
            else if(idx === 1) badgeClass = "bg-gray-600 text-white"; // 2ë“±: ì§„í•œ íšŒìƒ‰
            else if(idx === 2) badgeClass = "bg-gray-400 text-white"; // 3ë“±: íšŒìƒ‰

            list.innerHTML += `
                <div class="ranking-item px-4 py-3 border border-gray-100 rounded-xl mb-2 flex items-center justify-between bg-white hover:border-gray-300 transition-colors shadow-sm">
                    <div class="flex items-center gap-3">
                        <div class="${badgeClass} w-6 h-6 rounded flex items-center justify-center text-xs font-bold font-mono">
                            ${idx+1}
                        </div>
                        <div class="flex flex-col justify-center">
                            <span class="font-bold text-gray-900 text-sm leading-none">${item.name}</span>
                            <span class="text-[10px] text-gray-400 mt-1 leading-none">${item.school}</span>
                        </div>
                    </div>
                    <div class="flex items-center gap-4">
                        <span class="font-black text-gray-900 num-font text-lg tracking-tight">${item.totalScore}<span class="text-[10px] text-gray-400 font-bold ml-0.5">pts</span></span>
                        <div class="w-px h-3 bg-gray-300"></div>
                        <span class="font-bold text-gray-500 num-font text-xs w-10 text-right">${item.totalTime.toFixed(1)}s</span>
                    </div>
                </div>`;
        });
    }

    // 5. ìœ í‹¸ë¦¬í‹° (ì‹œê³„, ë‹¬ë ¥, í•œê¸€ìˆ«ì, ë­í¬ ë“±)
    function initClock() {
        setInterval(() => {
            const now = new Date();
            document.getElementById('clock-time').innerText = `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;
            document.getElementById('clock-date').innerText = `${now.getFullYear()}. ${String(now.getMonth()+1).padStart(2,'0')}. ${String(now.getDate()).padStart(2,'0')}`;
        }, 1000);
    }

    function getNativeNumber(n) {
        const natives = ["ì˜","í•˜ë‚˜","ë‘˜","ì…‹","ë„·","ë‹¤ì„¯","ì—¬ì„¯","ì¼ê³±","ì—¬ëŸ","ì•„í™‰","ì—´"];
        if(n <= 10) return natives[n];
        if(n < 20) return "ì—´" + natives[n-10];
        const tens = ["","","ìŠ¤ë¬¼","ì„œë¥¸","ë§ˆí”","ì‰°","ì˜ˆìˆœ","ì¼í”","ì—¬ë“ ","ì•„í”"];
        const unit = n%10;
        return tens[Math.floor(n/10)] + (unit > 0 ? natives[unit] : "");
    }

function getRank(seconds, targetScore) {
        // [ìˆ˜ì •] ë§Œì (ëª©í‘œ ì ìˆ˜) ë¯¸ë‹¬ ì‹œ ë“±ê¸‰ ì—†ìŒ ì²˜ë¦¬
        if (AppState.currentScore < targetScore) return "-";

        // 1ë¬¸ì œë‹¹ í‰ê·  ì†Œìš” ì‹œê°„ (ë˜ëŠ” 1ì ë‹¹, ì—¬ê¸°ì„œëŠ” ì„¤ì •ìƒ 10ì ì´ ë§Œì ì´ë¯€ë¡œ 'ì‹œê°„ / 10'ì´ ë¨)
        // ì„¤ì •ê°’ limitsê°€ '1.2ì´ˆ'ë¼ëŠ” ê²ƒì€ 1ì ì„ ì–»ëŠ”ë° 1.2ì´ˆ(ì¦‰ 2ì ì§œë¦¬ í•œ ë¬¸ì œì— 2.4ì´ˆ)ë¥¼ ì˜ë¯¸í•˜ëŠ”ì§€,
        // ì•„ë‹ˆë©´ ë‹¨ìˆœíˆ 'ë¬¸ì œ í’€ì´ë‹¹ ì†ë„' ì§€í‘œì¸ì§€ì— ë”°ë¼ ë‹¤ë¥´ì§€ë§Œ, 
        // ë³´ë‚´ì£¼ì‹  ì½”ë“œ ë¡œì§(seconds / targetScore)ì„ ê·¸ëŒ€ë¡œ ë”°ë¦…ë‹ˆë‹¤.
        const secPerPoint = seconds / targetScore;

        // ê¸°ë³¸ê°’ (ì„¤ì •ì´ ì—†ì„ ê²½ìš° ëŒ€ë¹„)
        let baseS = 1.5, baseA = 2.5, baseB = 4.0;

        // í˜„ì¬ ì£¼ì œì˜ ì„¤ì •(limits) ê°€ì ¸ì˜¤ê¸°
        const config = QUIZ_CONFIG[AppState.currentSubject.id];
        if (config && config.limits) {
            baseS = config.limits[0];
            baseA = config.limits[1];
            baseB = config.limits[2];
        }

        // [ìƒì„¸ ë“±ê¸‰ ê³„ì‚° ë¡œì§]
        // SSS: Sì»·ë³´ë‹¤ 20% ë” ë¹ ë¦„
        if (secPerPoint <= baseS * 0.8) return 'SSS';
        
        // SS: Sì»·ë³´ë‹¤ ë¹ ë¦„
        if (secPerPoint <= baseS) return 'SS';
        
        // S: Sì™€ A ì‚¬ì´ì˜ ì•ìª½ 30% êµ¬ê°„
        if (secPerPoint <= baseS + (baseA - baseS) * 0.3) return 'S';
        
        // A+: Sì™€ A ì‚¬ì´ì˜ ë‚˜ë¨¸ì§€ êµ¬ê°„
        if (secPerPoint <= baseS + (baseA - baseS) * 0.7) return 'A+';
        
        // A: Aì»· ì´ë‚´
        if (secPerPoint <= baseA) return 'A';
        
        // B+: Aì™€ B ì‚¬ì´ì˜ ì ˆë°˜
        if (secPerPoint <= baseA + (baseB - baseA) * 0.5) return 'B+';
        
        // B: Bì»· ì´ë‚´
        if (secPerPoint <= baseB) return 'B';
        
        // C+: Bì»·ë³´ë‹¤ 30% ì •ë„ë§Œ ëŠ¦ìŒ
        if (secPerPoint <= baseB * 1.3) return 'C+';
        
        // C: ê·¸ ì™¸
        return 'C';
    }

 // 3. ë‹¬ë ¥ HTML ê·¸ë¦¬ê¸° (ìˆ˜ì •ë¨)
// 3. ë‹¬ë ¥ HTML ê·¸ë¦¬ê¸° (ë¹ˆì¹¸ ì±„ìš°ê¸° ê°•í™” ë²„ì „)
function getCalendarHTML(md) {
    const { lastDate, startDayIndex, holidays } = md;
    let html = '<div class="calendar-grid-container">';
    
    // (1) ìš”ì¼ í—¤ë” (ì¼~í† )
    CAL_DAYS.forEach(d => html += `<div class="day-header">${d}</div>`);
    
    // ì „ì²´ ì…€ ê°œìˆ˜ë¥¼ ì„¸ëŠ” ë³€ìˆ˜ (í—¤ë” ì œì™¸í•˜ê³  ë³¸ë¬¸ ì¹¸ ìˆ˜ë§Œ)
    let totalCount = 0;

    // (2) 1ì¼ ì•ì˜ ë¹ˆ ì¹¸ ì±„ìš°ê¸°
    for(let i=0; i<startDayIndex; i++) {
        html += `<div></div>`;
        totalCount++; // ì¹¸ ìˆ˜ ì¦ê°€
    }
    
    // (3) ë‚ ì§œ ì±„ìš°ê¸° (1ì¼ ~ ë§ì¼)
    for(let d=1; d<=lastDate; d++) {
        let cls = ''; 
        const dayIdx = (startDayIndex + d - 1) % 7; // 0:ì¼ìš”ì¼ ~ 6:í† ìš”ì¼
        
        // ìš°ì„ ìˆœìœ„: íœ´ì¼ > ì¼ìš”ì¼ > í† ìš”ì¼
        if (holidays.has(d)) cls = 'holiday';
        else if (dayIdx === 0) cls = 'sunday';
        else if (dayIdx === 6) cls = 'saturday';
        
        html += `<div class="${cls}">${d}</div>`;
        totalCount++; // ì¹¸ ìˆ˜ ì¦ê°€
    }

    while (totalCount % 7 !== 0) {
        // [ìˆ˜ì •] style ì†ì„±ìœ¼ë¡œ ë°°ê²½ìƒ‰ ê°•ì œ ì§€ì • (ê²€ì€ìƒ‰ìœ¼ë¡œ ë³´ì´ëŠ” ë¬¸ì œ í•´ê²°)
        html += `<div style="background-color: #fff !important;"></div>`; 
        totalCount++;
    }

    html += '</div>';
    return html;
}

 function drawClock(id, h, m) {
        const cvs = document.getElementById(id);
        if (!cvs) return;
        const ctx = cvs.getContext('2d');
        
  const width = cvs.width;
        const height = cvs.height;
        const R = width / 2; 
        // [ìˆ˜ì •] ìº”ë²„ìŠ¤ ê½‰ ì±„ìš°ì§€ ì•Šê³  ì—¬ë°±(Margin) í™•ë³´ (0.9ë°°)
        const radius = R * 0.9; 

        ctx.clearRect(0, 0, width, height);
        ctx.save();
        ctx.translate(R, R);

        // 1. ì‹œê³„ ë°°ê²½
        ctx.beginPath();
        // [ìˆ˜ì •] R - 4 ëŒ€ì‹  radius ì‚¬ìš©
        ctx.arc(0, 0, radius, 0, 2 * Math.PI); 
        ctx.fillStyle = '#ffffff'; ctx.fill();
        
    // 2. ìˆ«ì (ê°€ë…ì„± í–¥ìƒ)
        ctx.fillStyle = '#111827';
        ctx.font = `800 ${radius * 0.15}px 'Inter', sans-serif`; // R -> radius
        ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
        for (let n = 1; n <= 12; n++) {
            let a = n * Math.PI / 6;
            let dist = radius * 0.82; // R -> radius
            ctx.fillText(n, Math.cos(a - Math.PI / 2) * dist, Math.sin(a - Math.PI / 2) * dist);
        }

        // 3. ëˆˆê¸ˆ
        for (let i = 0; i < 60; i++) {
            ctx.save();
            ctx.rotate(i * Math.PI / 30);
            ctx.beginPath();
            if (i % 5 === 0) {
                ctx.moveTo(0, -(radius - 10)); // R -> radius
                ctx.lineTo(0, -(radius - 25)); // R -> radius
                ctx.lineWidth = 4; 
                ctx.strokeStyle = '#1f2937';
                ctx.stroke();
            } else {
                ctx.moveTo(0, -(radius - 10)); // R -> radius
                ctx.lineTo(0, -(radius - 15)); // R -> radius
                ctx.lineWidth = 2.5; 
                ctx.strokeStyle = '#d1d5db';
                ctx.stroke();
            }
            ctx.restore();
        }

        // 4. ì‹œì¹¨
        ctx.save();
        ctx.rotate((h % 12 + m / 60) * Math.PI / 6);
        ctx.lineWidth = 10; 
        ctx.lineCap = 'round';
        ctx.strokeStyle = '#000000';
        ctx.beginPath(); 
        ctx.moveTo(0, 10); 
        ctx.lineTo(0, -(radius * 0.55)); // R -> radius
        ctx.stroke();
        ctx.restore();

        // 5. ë¶„ì¹¨
        ctx.save();
        ctx.rotate(m * Math.PI / 30);
        ctx.lineWidth = 6; 
        ctx.lineCap = 'round';
        ctx.strokeStyle = '#2563eb'; 
        ctx.beginPath(); 
        ctx.moveTo(0, 10); 
        ctx.lineTo(0, -(radius * 0.85)); // R -> radius
        ctx.stroke();
        ctx.restore();

        // 6. ì¤‘ì‹¬ì  (ë¹¨ê°„ì )
        ctx.beginPath(); 
        ctx.arc(0, 0, 8, 0, 2 * Math.PI);
        ctx.fillStyle = '#ef4444'; 
        ctx.fill();
        // ì¤‘ì‹¬ì  í…Œë‘ë¦¬
        ctx.lineWidth = 2;
        ctx.strokeStyle = '#ffffff';
        ctx.stroke();
        
        ctx.restore();
    }
    function showDataModal() { document.getElementById('data-modal').classList.remove('hidden'); document.getElementById('modal-content').innerHTML = currentModalContent; }
    function closeModal() { document.getElementById('data-modal').classList.add('hidden'); }
function refreshData() { 
        // ë¡œë”© í™”ë©´ì„ ë‹¤ì‹œ ë³´ì—¬ì£¼ê³  ì„œë²„ ë°ì´í„°ë¥¼ ì¬ìš”ì²­í•©ë‹ˆë‹¤.
        document.getElementById('loading-overlay').classList.remove('hidden');
        loadDataFromServer();
    }

        function decomposeHangul(char) {
            const code = char.charCodeAt(0) - 0xAC00;
            if (code < 0 || code > 11171) return null;
            const jong = code % 28;
            const jung = ((code - jong) / 28) % 21;
            const cho = (((code - jong) / 28) - jung) / 21;
            return { cho, jung, jong };
        }

        function composeHangul(cho, jung, jong) {
            return String.fromCharCode(0xAC00 + (cho * 588) + (jung * 28) + jong);
        }

        function getRandomInt(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }
        function getRand(arr) { return arr[getRandomInt(0, arr.length - 1)]; }
        function getRandDate() { return `${getRandomInt(1, 12)}ì›” ${getRandomInt(1, 30)}ì¼`; }
        function getRandTime(start, end) { 
            const h = getRandomInt(start, end);
            const m = getRandomInt(0, 5) * 10;
            return `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`; 
        }
        
        function shuffleArray(array) {
            const n = [...array];
            for (let i = n.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [n[i], n[j]] = [n[j], n[i]];
            }
            return n;
        }

        // ë³´ê¸°(Distractors) ìƒì„± í—¬í¼ (Code 2 ë¡œì§ ì ìš©)
        function getDistractors(answer, type, sourceArr = []) {
            let set = new Set([answer]);
            let loop = 0;
            while(set.size < 4 && loop < 50) {
                loop++;
                let val;
                if(type === 'time') {
                    const [h, m] = answer.split(':').map(Number);
                    val = `${String(h + getRandomInt(-3, 3)).padStart(2,'0')}:${String(m).padStart(2,'0')}`;
                } else if(type === 'number') {
                    val = parseInt(answer) + getRandomInt(-2, 2) * 1000;
                } else if(type === 'array') {
                    val = getRand(sourceArr);
                } else if(type === 'text_num') { 
                     const num = parseInt(answer);
                     const unit = answer.replace(/[0-9]/g, '');
                     val = (num + getRandomInt(-2, 2)) + unit;
                     if(parseInt(val) <= 0) val = (num + 1) + unit;
                }
                if(val && val !== answer) set.add(val);
            }
            while(set.size < 4) {
                if(type === 'array' && sourceArr.length > 0) set.add(getRand(sourceArr));
                else set.add("ê¸°íƒ€" + set.size);
            }
            return shuffleArray(Array.from(set));
        }

        // ==========================================
        // [2] êµ­ì–´/ì˜ì–´/ìƒì‹ ë°ì´í„° ë±…í¬ (Code 2 ì „ì²´)
        // ==========================================

        const bank_consonants = [
            // ã„±
            {q:"í•™êµ ê°ˆ ë•Œ ë“±ì— ë§¤ëŠ” ê²ƒ", a:"ê°€ë°©"}, {q:"ë©ë©! ì§‘ì„ ì§€í‚¤ëŠ” ë™ë¬¼", a:"ê°•ì•„ì§€"}, {q:"ì¹™ì¹™í­í­ ê¸¸ê²Œ ë‹¬ë¦¬ëŠ” ì°¨", a:"ê¸°ì°¨"}, {q:"ë¶ˆì— êµ¬ì›Œ ë¨¹ìœ¼ë©´ ë§›ìˆëŠ” ìŒì‹", a:"ê³ ê¸°"}, {q:"ë‹¤ë¦¬ê°€ 8ê°œ, ê±°ë¯¸ì¤„ì„ ì³ìš”", a:"ê±°ë¯¸"},
            {q:"í•˜ëŠ˜ì— ë–  ìˆëŠ” í•˜ì–€ ì†œì‚¬íƒ•", a:"êµ¬ë¦„"}, {q:"ë˜ê°ë˜ê° ì†Œë¦¬ ë‚˜ëŠ” ì‹ ë°œ", a:"êµ¬ë‘"}, {q:"ì½”ë¼ë¦¬ì˜ ì½”ëŠ” ì•„ì£¼ â¬œì–´", a:"ê¸¸ì–´"}, {q:"ê²¨ìš¸ì— ë¨¹ëŠ” ë‹¬ì½¤í•œ ë¿Œë¦¬ ê°„ì‹", a:"ê³ êµ¬ë§ˆ"}, {q:"ë¬´ëŒ€ì—ì„œ ë…¸ë˜ ë¶€ë¥´ëŠ” ì‚¬ëŒ", a:"ê°€ìˆ˜"},
            
            // ã„´
            {q:"ê½ƒì„ ì°¾ì•„ ë‚ ì•„ë‹¤ë‹ˆëŠ” ê³¤ì¶©", a:"ë‚˜ë¹„"}, {q:"ìˆ²ì— ë§ì€ ì´ˆë¡ìƒ‰ ì‹ë¬¼", a:"ë‚˜ë¬´"}, {q:"ì—¬ìì¸ í˜•ì œ", a:"ëˆ„ë‚˜"}, {q:"ë§ˆì´í¬ ì¡ê³  ë¶€ë¥´ëŠ” ê²ƒ", a:"ë…¸ë˜"}, {q:"ê°•ì—ì„œ ë¬¼ê³ ê¸°ë¥¼ ì¡ëŠ” ì¼", a:"ë‚šì‹œ"},
            {q:"ì§‘ ë°–ìœ¼ë¡œ â¬œì˜¤ë‹¤", a:"ë‚˜ì˜¤ë‹¤"}, {q:"ë…¼ê³¼ ë°­ì—ì„œ ì§“ëŠ” ê²ƒ", a:"ë†ì‚¬"}, {q:"í•´ê°€ ë–  ìˆëŠ” ë°ì€ ì‹œê°„", a:"ë‚®"}, {q:"ë´„ì— ë„ì‹œë½ ì‹¸ì„œ ê°€ëŠ” ê²ƒ", a:"ë‚˜ë“¤ì´"}, {q:"ì ì‹¬ ë¨¹ê³  ìëŠ” ì ", a:"ë‚®ì "},

            // ã„·
            {q:"ë„í† ë¦¬ë¥¼ ì¢‹ì•„í•˜ëŠ” ë™ë¬¼", a:"ë‹¤ëŒì¥"}, {q:"ì½©ìœ¼ë¡œ ë§Œë“  ë„¤ëª¨ë‚œ ë°˜ì°¬", a:"ë‘ë¶€"}, {q:"ì˜·ì˜ ì£¼ë¦„ì„ í´ëŠ” ê¸°ê³„", a:"ë‹¤ë¦¬ë¯¸"}, {q:"ê°•ì„ ê±´ë„ˆê²Œ í•´ì£¼ëŠ” ê¸¸", a:"ë‹¤ë¦¬"}, {q:"ìŒ‰ìŒ€í•œ ë§›ì´ ë‚˜ëŠ” ë¿Œë¦¬ ë°˜ì°¬", a:"ë„ë¼ì§€"},
            {q:"ë³„ ëª¨ì–‘ì˜ ë°”ë‹¤ ë™ë¬¼", a:"ë¶ˆê°€ì‚¬ë¦¬"}, {q:"ë§ì¹˜, í†± ê°™ì€ ì¼í•˜ëŠ” ë¬¼ê±´", a:"ë„êµ¬"}, {q:"ê°€ìš´ë° êµ¬ë© ëš«ë¦° ë¹µ", a:"ë„ë„ˆì¸ "}, {q:"ê¿€ê¿€! ëš±ëš±í•œ ë™ë¬¼", a:"ë¼ì§€"}, {q:"ì¹¼ì§ˆí•  ë•Œ ì“°ëŠ” ë°›ì¹¨ëŒ€", a:"ë„ë§ˆ"},

            // ã„¹
            {q:"ì†Œë¦¬ë¥¼ ë“£ëŠ” ê¸°ê³„", a:"ë¼ë””ì˜¤"}, {q:"ê¼¬ë¶ˆê¼¬ë¶ˆ êµ­ë¬¼ ìš”ë¦¬", a:"ë¼ë©´"}, {q:"ê°ˆê¸° ìˆëŠ” ë™ë¬¼ì˜ ì™• (ì˜ì–´)", a:"ë¼ì´ì˜¨"}, {q:"ì‚ë¦¬ì‚ë¦¬ ê¸°ê³„ ì¸ê°„", a:"ë¡œë´‡"}, {q:"ì•„ì£¼ ì‹  ë…¸ë€ ê³¼ì¼", a:"ë ˆëª¬"}, 
            {q:"ì…ìˆ ì— ë°”ë¥´ëŠ” í™”ì¥í’ˆ", a:"ë¦½ìŠ¤í‹±"}, {q:"ë†€ì´ê³µì›ì˜ ë¬´ì„œìš´ ì—´ì°¨", a:"ë¡¤ëŸ¬ì½”ìŠ¤í„°"}, {q:"ìš°ì£¼ë¡œ ë‚ ì•„ê°€ëŠ” ê²ƒ", a:"ë¡œì¼“"}, {q:"ì„ ë¬¼ ìƒìì— ë¬¶ëŠ” ëˆ", a:"ë¦¬ë³¸"}, {q:"ê³„ë‹¨ ëŒ€ì‹  íƒ€ëŠ” ê¸°ê³„", a:"ì—ìŠ¤ì»¬ë ˆì´í„°"},

            // ã…
            {q:"ê°ê¸° ê±¸ë¦¬ë©´ ì…ì— ì“°ëŠ” ê²ƒ", a:"ë§ˆìŠ¤í¬"}, {q:"ìˆ˜ë¦¬ìˆ˜ë¦¬ ì–! ì‹ ê¸°í•œ ì‡¼", a:"ë§ˆìˆ "}, {q:"ì•„ì¹¨ë§ˆë‹¤ ë§ˆì‹œëŠ” ì‹ ì„ í•œ ìš°ìœ ", a:"ë§¤ì¼ìš°ìœ "}, {q:"ë¨¸ë¦¬ì— ì“°ëŠ” ê²ƒ", a:"ëª¨ì"}, {q:"ì—¬ë¦„ì— í”¼ë¥¼ ë¹ ëŠ” ê³¤ì¶©", a:"ëª¨ê¸°"},
            {q:"ë†€ì´í„°ì—ì„œ íƒ€ê³  ë‚´ë ¤ì˜¤ëŠ” ê²ƒ", a:"ë¯¸ë„ëŸ¼í‹€"}, {q:"ë¹„ ì˜¨ ë’¤ ëœ¨ëŠ” ì¼ê³± ìƒ‰ê¹”", a:"ë¬´ì§€ê°œ"}, {q:"ê¹ë‘ê¸°ë¥¼ ë§Œë“œëŠ” í•˜ì–€ ì±„ì†Œ", a:"ë¬´"}, {q:"ì—¬ë¦„ì— ë§´ë§´ ìš°ëŠ” ê³¤ì¶©", a:"ë§¤ë¯¸"}, {q:"ë¬¼ê±´ì„ íŒŒëŠ” í° ê°€ê²Œ", a:"ë§ˆíŠ¸"},

            // ã…‚
            {q:"ê¸¸ê³  ë…¸ë€ ì›ìˆ­ì´ ê°„ì‹", a:"ë°”ë‚˜ë‚˜"}, {q:"ë§ì€ ì‚¬ëŒì´ íƒ€ëŠ” í° ì°¨", a:"ë²„ìŠ¤"}, {q:"ì§‘ì—ì„œ í‚¤ìš°ëŠ” ì–¼ë£© ê°•ì•„ì§€", a:"ë°”ë‘‘ì´"}, {q:"ë¹„ ì˜¬ ë•Œ ì…ëŠ” ì˜·", a:"ë¹„ì˜·"}, {q:"ë¬¼ë²”ê³¼ ë¹„ìŠ·í•œ ë°”ë‹¤ ë™ë¬¼", a:"ë°”ë‹¤í‘œë²”"},
            {q:"í•˜ëŠ˜ì„ ë‚˜ëŠ” êµí†µìˆ˜ë‹¨", a:"ë¹„í–‰ê¸°"}, {q:"í¬ë„, ê°€ì§€ì˜ ìƒ‰ê¹”", a:"ë³´ë¼ìƒ‰"}, {q:"í•œêµ­ì¸ì˜ ì£¼ì‹, í•˜ì–€ ê³¡ì‹", a:"ë°¥"}, {q:"ì„ í’ê¸°ì—ì„œ ë‚˜ì˜¤ëŠ” ê²ƒ", a:"ë°”ëŒ"}, {q:"ê±°í’ˆì„ ë‚´ì„œ ì”»ëŠ” ê²ƒ", a:"ë¹„ëˆ„"},

            // ã……
            {q:"ì–´í¥! ê°ˆê¸°ê°€ ë©‹ì§„ ë™ë¬¼", a:"ì‚¬ì"}, {q:"ë°±ì„¤ê³µì£¼ê°€ ë¨¹ì€ ê³¼ì¼", a:"ì‚¬ê³¼"}, {q:"ë“±ì´ ë”±ë”±í•˜ê³  ëŠë¦° ë™ë¬¼", a:"ê±°ë¶ì´"}, {q:"ë¿”ì´ ë©‹ì§„ ìˆ²ì† ë™ë¬¼", a:"ì‚¬ìŠ´"}, {q:"ì´ˆë¡ ì¤„ë¬´ëŠ¬, ì†ì€ ë¹¨ê°„ ê³¼ì¼", a:"ìˆ˜ë°•"}, 
            {q:"ì„¸ìˆ˜í•˜ê³  ì† ì”»ëŠ” ê³³", a:"ì„¸ë©´ëŒ€"}, {q:"ê³ ë¯¼ì„ ë“¤ì–´ì£¼ëŠ” ê³³", a:"ìƒë‹´ì‹¤"}, {q:"ì‹œê°„ì„ ì•Œë ¤ì£¼ëŠ” ë¬¼ê±´", a:"ì‹œê³„"}, {q:"í•˜íŠ¸ ëª¨ì–‘ ë§ˆìŒ", a:"ì‚¬ë‘"}, {q:"ë¶ˆì„ ë„ëŸ¬ ì¶œë™í•˜ëŠ” ì°¨", a:"ì†Œë°©ì°¨"}, 

            // ã…‡
            {q:"ì‘ì• ì‘ì•  íƒœì–´ë‚œ ì‚¬ëŒ", a:"ì•„ê¸°"}, {q:"ì°¨ê°‘ê³  ë‹¬ì½¤í•œ ê°„ì‹", a:"ì•„ì´ìŠ¤í¬ë¦¼"}, {q:"ë‚˜ë¥¼ ë‚³ì•„ì£¼ì‹  ë¶„", a:"ì—„ë§ˆ"}, {q:"ë³‘ì›ì—ì„œ ê¸‰í•  ë•Œ ê°€ëŠ” ê³³", a:"ì‘ê¸‰ì‹¤"}, {q:"í•´ê°€ ëœ¨ê³  í•™êµ ê°€ëŠ” ì‹œê°„", a:"ì•„ì¹¨"},
            {q:"ê¸¸ì­‰í•˜ê³  ì´ˆë¡ìƒ‰ì¸ ì±„ì†Œ", a:"ì˜¤ì´"}, {q:"ì –ì†Œì—ê²Œì„œ ë‚˜ì˜¤ëŠ” í•˜ì–€ ë¬¼", a:"ìš°ìœ "}, {q:"ëˆˆ ìœ„ì— ìˆëŠ” ì–¼êµ´ ë¶€ë¶„", a:"ì´ë§ˆ"}, {q:"ëˆˆ ë‚˜ì  ë•Œ ì“°ëŠ” ê²ƒ", a:"ì•ˆê²½"}, {q:"ë¹„ ì˜¬ ë•Œ ì“°ëŠ” ê²ƒ", a:"ìš°ì‚°"},

            // ã…ˆ
            {q:"ë¶•ë¶• ë„ë¡œë¥¼ ë‹¬ë¦¬ëŠ” ê²ƒ", a:"ìë™ì°¨"}, {q:"ë•… ë°‘ìœ¼ë¡œ ë‹¤ë‹ˆëŠ” ê¸°ì°¨", a:"ì§€í•˜ì² "}, {q:"ìš°ë¦¬ê°€ ê°€ì¡±ê³¼ ì‚¬ëŠ” ê³³", a:"ì§‘"}, {q:"ì—°í•„ ê¸€ì”¨ë¥¼ ì§€ìš°ëŠ” ê²ƒ", a:"ì§€ìš°ê°œ"}, {q:"ë”°ë”! ë³‘ì›ì—ì„œ ë§ì•„ìš”", a:"ì£¼ì‚¬"},
            {q:"ì¤„ì„ ë„˜ìœ¼ë©° ë›°ëŠ” ìš´ë™", a:"ì¤„ë„˜ê¸°"}, {q:"ë°”í€´ ë‘ ê°œë¡œ ê°€ëŠ” ê²ƒ", a:"ìì „ê±°"}, {q:"ì ‘ê±°ë‚˜ ìë¥´ë©° ë…¸ëŠ” ê²ƒ", a:"ì¢…ì´"}, {q:"ì˜·ì— ë‹¬ë¦° ë¬¼ê±´ ë„£ëŠ” ê³³", a:"ì£¼ë¨¸ë‹ˆ"}, {q:"ëˆì„ ë„£ì–´ ë‹¤ë‹ˆëŠ” ë¬¼ê±´", a:"ì§€ê°‘"},

            // ã…Š
            {q:"ì¹™ì¹™í­í­ ë ˆì¼ ìœ„ë¥¼ ë‹¬ë ¤ìš”", a:"ê¸°ì°¨"}, {q:"ê½ê½ ì–¸ ë¬¼", a:"ì–¼ìŒ"}, {q:"ê¸€ê³¼ ê·¸ë¦¼ì´ ìˆëŠ” ê²ƒ", a:"ì±…"}, {q:"ì´ë¥¼ ë‹¦ëŠ” ì†”", a:"ì¹«ì†”"}, {q:"ì—¬ìë“¤ì´ ì£¼ë¡œ ì…ëŠ” ì˜·", a:"ì¹˜ë§ˆ"},
            {q:"íš¡ë‹¨ë³´ë„ì˜ ì•ˆì „í•œ ë¶ˆë¹›", a:"ì´ˆë¡ìƒ‰"}, {q:"ì‚¬ì´ì¢‹ê²Œ ì§€ë‚´ëŠ” ë˜ë˜", a:"ì¹œêµ¬"}, {q:"ë¨¼ì§€ë¥¼ ë¹¨ì•„ë“¤ì´ëŠ” ê¸°ê³„", a:"ì²­ì†Œê¸°"}, {q:"ìƒì¼ ì¼€ì´í¬ ìœ„ì— ê½‚ëŠ” ê²ƒ", a:"ì´›ë¶ˆ"}, {q:"ë²½ì— ìˆëŠ” ìœ ë¦¬ ë¬¸", a:"ì°½ë¬¸"},

            // ã…‹
            {q:"ì°°ì¹µ! ì‚¬ì§„ ì°ëŠ” ê¸°ê³„", a:"ì¹´ë©”ë¼"}, {q:"ì£¼ë¨¸ë‹ˆì— ì•„ê¸°ë¥¼ ë„£ê³  ë›°ëŠ” ë™ë¬¼", a:"ìº¥ê±°ë£¨"}, {q:"ì½”ê°€ ì•„ì£¼ ê¸´ ë™ë¬¼", a:"ì½”ë¼ë¦¬"}, {q:"ëª¸ì˜ ë†’ì´", a:"í‚¤"}, {q:"ìƒì¼ì— ë¨¹ëŠ” ë¹µ", a:"ì¼€ì´í¬"}, 
            {q:"ì‚°íƒ€ í• ì•„ë²„ì§€ê°€ ì˜¤ëŠ” ë‚ ", a:"í¬ë¦¬ìŠ¤ë§ˆìŠ¤"}, {q:"ìíŒê¸°ì™€ ë§ˆìš°ìŠ¤ê°€ ìˆì–´ìš”", a:"ì»´í“¨í„°"}, {q:"ë‹¬ì½¤í•˜ê³  ë”°ëœ»í•œ ì´ˆì½” ìŒë£Œ", a:"ì½”ì½”ì•„"}, {q:"ë¨¸ë¦¬ê°€ ë…¸ë€ ì½©ë‚˜ë¬¼", a:"ì½©ë‚˜ë¬¼"}, {q:"ë¬¸ ì—¬ëŠ” ì—´ì‡ (ì˜ì–´)", a:"í‚¤"},

            // ã…Œ
            {q:"ì•Œì´ ì•„ì£¼ í¬ê³  ë¹ ë¥¸ ìƒˆ", a:"íƒ€ì¡°"}, {q:"ì§ì„ ì‹£ëŠ” í° ìë™ì°¨", a:"íŠ¸ëŸ­"}, {q:"ë§Œí™”ë„ ë³´ê³  ë‰´ìŠ¤ë„ ë´ìš”", a:"í…”ë ˆë¹„ì „"}, {q:"ì¼€ì²©ì„ ë§Œë“œëŠ” ë¹¨ê°„ ì±„ì†Œ", a:"í† ë§ˆí† "}, {q:"ê·€ê°€ ê¸¸ê³  ê¹¡ì¶© ë›°ëŠ” ë™ë¬¼", a:"í† ë¼"},
            {q:"ìš°ë¦¬ë‚˜ë¼ êµ­ê¸°", a:"íƒœê·¹ê¸°"}, {q:"ëˆì„ ë‚´ê³  íƒ€ëŠ” ìŠ¹ìš©ì°¨", a:"íƒì‹œ"}, {q:"ê¸°ë¦„ì— ë°”ì‚­í•˜ê²Œ ìš”ë¦¬í•œ ê²ƒ", a:"íŠ€ê¹€"}, {q:"ì‚°ì„ ëš«ì–´ ë§Œë“  ê¸¸", a:"í„°ë„"}, {q:"í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ë‚˜ë¬´", a:"íŠ¸ë¦¬"},

            // ã…
            {q:"ë¼ë©´ì— ë„£ëŠ” ì´ˆë¡ ì±„ì†Œ", a:"íŒŒ"}, {q:"ê±´ë°˜ì„ ëˆ„ë¥´ë©´ ì†Œë¦¬ê°€ ë‚˜ìš”", a:"í”¼ì•„ë…¸"}, {q:"ë§‘ì€ í•˜ëŠ˜ì˜ ìƒ‰ê¹”", a:"íŒŒë€ìƒ‰"}, {q:"ë‚¨ê·¹ì— ì‚¬ëŠ” ì‹ ì‚¬ ìƒˆ", a:"í­ê·„"}, {q:"ë³´ë¼ìƒ‰ ì•Œë§¹ì´ê°€ ì£¼ë ì£¼ë ", a:"í¬ë„"},
            {q:"ì¹˜ì¦ˆê°€ ì­‰ ëŠ˜ì–´ë‚˜ëŠ” ë¹µ", a:"í”¼ì"}, {q:"ë§ˆìŒì„ ì „í•˜ëŠ” ì¢…ì´", a:"í¸ì§€"}, {q:"ìœ™ìœ™ ë²Œë ˆë¥¼ ì¡ëŠ” ì±„", a:"íŒŒë¦¬ì±„"}, {q:"í›„~ ë¶ˆë©´ ì»¤ì§€ëŠ” ê²ƒ", a:"í’ì„ "}, {q:"ì†Œê°€ ëœ¯ì–´ ë¨¹ëŠ” ì´ˆë¡ ì‹ë¬¼", a:"í’€"},

            // ã…
            {q:"ì…ì´ ì•„ì£¼ í° ë¬¼ê°€ ë™ë¬¼", a:"í•˜ë§ˆ"}, {q:"ì¦ê±°ìš¸ ë•Œ ë‚˜ëŠ” ì†Œë¦¬", a:"í•˜í•˜í•˜"}, {q:"ê³µë¶€í•˜ëŸ¬ ê°€ëŠ” ê³³", a:"í•™êµ"}, {q:"êµ¬ë¦„ì´ ë–  ìˆëŠ” ê³³", a:"í•˜ëŠ˜"}, {q:"ë–¡ í•˜ë‚˜ ì£¼ë©´ ì•ˆ ì¡ì•„ë¨¹ì§€", a:"í˜¸ë‘ì´"},
            {q:"ì½” í’€ ë•Œ ì“°ëŠ” ì¢…ì´", a:"íœ´ì§€"}, {q:"í•´ë§Œ ë°”ë¼ë³´ëŠ” ê½ƒ", a:"í•´ë°”ë¼ê¸°"}, {q:"ë¹µ ì‚¬ì´ì— ê³ ê¸° íŒ¨í‹°", a:"í–„ë²„ê±°"}, {q:"í• ë¡œìœˆì˜ ì£¼í™©ìƒ‰ ì±„ì†Œ", a:"í˜¸ë°•"}, {q:"ëˆˆì˜ ìƒ‰ê¹”", a:"í•˜ì–€ìƒ‰"}
        ];

        const bank_vowels = [
            // ã…
            {q:"ë‚˜ë¥¼ ì‚¬ë‘í•´ì£¼ëŠ” ë‚¨ì ì–´ë¥¸", a:"ì•„ë¹ "}, {q:"ê¸°ì €ê·€ë¥¼ ì°¨ëŠ” ì–´ë¦° ì‚¬ëŒ", a:"ì•„ê¸°"}, {q:"ê°ˆê¸°ê°€ ë©‹ì§„ ë™ë¬¼ì˜ ì™•", a:"ì‚¬ì"}, {q:"ì›ìˆ­ì´ê°€ ì¢‹ì•„í•˜ëŠ” ë…¸ë€ ê³¼ì¼", a:"ë°”ë‚˜ë‚˜"}, {q:"ë¬¼ì´ ë§ê³  íŒŒë„ ì¹˜ëŠ” ê³³", a:"ë°”ë‹¤"},
            {q:"ë‹¤ë¦¬ì— ì…ëŠ” ì˜·", a:"ë°”ì§€"}, {q:"ì…ì´ í° ë™ë¬¼", a:"í•˜ë§ˆ"}, {q:"ì² ê¸¸ ìœ„ë¥¼ ë‹¬ë¦¬ëŠ” ì°¨", a:"ê¸°ì°¨"}, {q:"ì‹ í˜¸ë“±ì˜ ê±´ë„ˆê°€ë„ ë˜ëŠ” ìƒ‰", a:"íŒŒë‘"}, {q:"ë°±ì„¤ê³µì£¼ê°€ ë¨¹ì€ ê³¼ì¼", a:"ì‚¬ê³¼"},

            // ã…‘
            {q:"ë°©ë§ì´ë¡œ ê³µì„ ì¹˜ëŠ” ìš´ë™", a:"ì•¼êµ¬"}, {q:"ëª¸ì— ì¢‹ì€ í’€(ì±„ì†Œ)", a:"ì•¼ì±„"}, {q:"ê³ ì–‘ì´ ìš¸ìŒ ì†Œë¦¬", a:"ì•¼ì˜¹"}, {q:"ì˜›ë‚  ì˜›ë‚ ì—~ (ìŠ¤í† ë¦¬)", a:"ì´ì•¼ê¸°"}, {q:"í„¸ì´ ê¸´ ì†Œì²˜ëŸ¼ ìƒê¸´ ë™ë¬¼", a:"ì•¼í¬"},
            {q:"ë”ìš´ ë‚˜ë¼ì— ìˆëŠ” ë‚˜ë¬´", a:"ì•¼ììˆ˜"}, {q:"ë°¤ì— ì‹œì¼œ ë¨¹ëŠ” ìŒì‹", a:"ì•¼ì‹"}, {q:"ì‚°ì—ì„œ ìë¼ëŠ” ë™ë¬¼", a:"ì•¼ìƒ"}, {q:"ì‚° ì •ìƒì—ì„œ ì™¸ì¹˜ëŠ” ì†Œë¦¬", a:"ì•¼í˜¸"}, {q:"ì•¼êµ¬ ê²½ê¸°ë¥¼ í•˜ëŠ” ê³³", a:"ì•¼êµ¬ì¥"},

            // ã…“
            {q:"ë‚˜ë¥¼ ë‚³ì•„ì£¼ì‹  ì—¬ì ë¶„", a:"ì–´ë¨¸ë‹ˆ"}, {q:"ì•„ì´ê°€ ìë¼ì„œ ëœ ì‚¬ëŒ", a:"ì–´ë¥¸"}, {q:"ê¸ˆë¶•ì–´ê°€ ì‚¬ëŠ” ì§‘", a:"ì–´í•­"}, {q:"íŒ”ê³¼ ëª© ì‚¬ì´ì˜ ì‹ ì²´", a:"ì–´ê¹¨"}, {q:"ì´ˆë“±í•™êµ ë‹¤ë‹ˆëŠ” ì•„ì´", a:"ì–´ë¦°ì´"},
            {q:"ì¥ì†Œë¥¼ ë¬¼ì„ ë•Œ í•˜ëŠ” ë§", a:"ì–´ë””"}, {q:"ë¹¨ë¦¬ ì˜¤ë¼ê³  í•  ë•Œ", a:"ì–´ì„œ"}, {q:"ë¶ˆì´ êº¼ì§€ë©´ ì°¾ì•„ì™€ìš”", a:"ì–´ë‘ "}, {q:"ë¬¼ê³ ê¸° ì¡ëŠ” ì‚¬ëŒ", a:"ì–´ë¶€"}, {q:"ìƒì„ ì‚´ë¡œ ë§Œë“  ì«„ê¹ƒí•œ ìŒì‹", a:"ì–´ë¬µ"},

            // ã…•
            {q:"ê¾€ê°€ ë§ì€ ë™ë¬¼", a:"ì—¬ìš°"}, {q:"ì—„ë§ˆ, ëˆ„ë‚˜, ì´ëª¨ì˜ ì„±ë³„", a:"ì—¬ì"}, {q:"ë¥ê³  ìˆ˜ì˜í•˜ëŠ” ê³„ì ˆ", a:"ì—¬ë¦„"}, {q:"ì´ ì¥ì†Œë¥¼ ê°€ë¦¬í‚¤ëŠ” ë§", a:"ì—¬ê¸°"}, {q:"ê°€ë°© ì‹¸ì„œ ë©€ë¦¬ ë†€ëŸ¬ê°€ëŠ” ê²ƒ", a:"ì—¬í–‰"},
            {q:"ì „í™” ë°›ì„ ë•Œ í•˜ëŠ” ë§", a:"ì—¬ë³´ì„¸ìš”"}, {q:"ìˆ«ì 6ì„ ì½ëŠ” ë§", a:"ì—¬ì„¯"}, {q:"ìˆ«ì 8ì„ ì½ëŠ” ë§", a:"ì—¬ëŸ"}, {q:"ì†Œê°€ ë¨¹ëŠ” ë°¥", a:"ì—¬ë¬¼"}, {q:"ì™•ì˜ ë¶€ì¸", a:"ì—¬ì™•"},

            // ã…—
            {q:"ê¸¸ì­‰í•˜ê³  ì•„ì‚­í•œ ì´ˆë¡ ì±„ì†Œ", a:"ì˜¤ì´"}, {q:"ê½¥ê½¥ ìš°ëŠ” ìƒˆ", a:"ì˜¤ë¦¬"}, {q:"ë‹¤ë¦¬ê°€ 10ê°œì¸ ë°”ë‹¤ ë™ë¬¼", a:"ì˜¤ì§•ì–´"}, {q:"ì–´ì œ, ë‚´ì¼, ê·¸ë¦¬ê³  ì§€ê¸ˆ", a:"ì˜¤ëŠ˜"}, {q:"ì—¬ë™ìƒì˜ ë‚¨ì í˜•ì œ", a:"ì˜¤ë¹ "},
            {q:"ì ì‹¬ ë¨¹ê³  ë‚œ ë’¤ì˜ ì‹œê°„", a:"ì˜¤í›„"}, {q:"ì£¼í™©ìƒ‰ ê»ì§ˆ ê³¼ì¼", a:"ì˜¤ë Œì§€"}, {q:"ë¨¸ë¦¬ì— ì“°ëŠ” ê²ƒ", a:"ëª¨ì"}, {q:"ë³´ë¼ìƒ‰ ì†¡ì´ê°€ ì£¼ë ì£¼ë ", a:"í¬ë„"}, {q:"ì°¨ê°€ ë‹¤ë‹ˆëŠ” ê¸¸", a:"ë„ë¡œ"},

            // ã…›
            {q:"ìŒì‹ì„ ë§Œë“œëŠ” ì¼", a:"ìš”ë¦¬"}, {q:"ë§ˆì‹œëŠ” ìƒˆì½¤ë‹¬ì½¤ ìŒë£Œ", a:"ìš”êµ¬ë¥´íŠ¸"}, {q:"ì¤„ì„ ê°ì•˜ë‹¤ í‘¸ëŠ” ì¥ë‚œê°", a:"ìš”ìš”"}, {q:"ì›”, í™”, ìˆ˜, ëª©...", a:"ìš”ì¼"}, {q:"ë™í™” ì† ì‘ê³  ì‹ ê¸°í•œ ì¡´ì¬", a:"ìš”ì •"},
            {q:"ë§ˆë²•ì‚¬ê°€ ë¶€ë¦¬ëŠ” ê²ƒ", a:"ìš”ìˆ "}, {q:"ìµœê·¼ì„ ë¶€ë¥´ëŠ” ë§", a:"ìš”ì¦˜"}, {q:"ëª¸ì„ ìœ ì—°í•˜ê²Œ í•˜ëŠ” ìš´ë™", a:"ìš”ê°€"}, {q:"ë²„ìŠ¤ íƒˆ ë•Œ ë‚´ëŠ” ëˆ", a:"ìš”ê¸ˆ"}, {q:"í”ë“¤í”ë“¤ ì•„ê¸° ì¹¨ëŒ€", a:"ìš”ëŒ"},

            // ã…œ
            {q:"ì –ì†Œê°€ ì£¼ëŠ” í•˜ì–€ ë¬¼", a:"ìš°ìœ "}, {q:"ë¹„ ì˜¬ ë•Œ í´ëŠ” ê²ƒ", a:"ìš°ì‚°"}, {q:"ë‚˜ì™€ ë„ˆë¥¼ í•©ì¹œ ë§", a:"ìš°ë¦¬"}, {q:"ì§€êµ¬ ë°– ë³„ë“¤ì´ ìˆëŠ” ê³³", a:"ìš°ì£¼"}, {q:"ì˜¤ë™í†µí•œ ë©´ ìš”ë¦¬", a:"ìš°ë™"},
            {q:"í¸ì§€ë¥¼ ë¶€ì¹˜ëŠ” ê³³", a:"ìš°ì²´êµ­"}, {q:"í•˜ëŠ˜ì—ì„œ ë–¨ì–´ì§€ëŠ” ì–¼ìŒ ì•Œê°±ì´", a:"ìš°ë°•"}, {q:"ì¹œêµ¬ì™€ì˜ ì‚¬ë‘", a:"ìš°ì •"}, {q:"ê²½ê¸°ì—ì„œ 1ë“± í•˜ëŠ” ê²ƒ", a:"ìš°ìŠ¹"}, {q:"ëª©ì†Œë¦¬ê°€ í¬ê³  ì”©ì”©í•˜ë‹¤", a:"ìš°ë ì°¨ë‹¤"},

            // ã… 
            {q:"íˆ¬ëª…í•˜ê³  ê¹¨ì§€ê¸° ì‰¬ìš´ ê²ƒ", a:"ìœ ë¦¬"}, {q:"í•™êµ ê°€ê¸° ì „ì— ë‹¤ë‹ˆëŠ” ê³³", a:"ìœ ì¹˜ì›"}, {q:"í•˜ì–—ê³  ë¬´ì„œìš´ ê·€ì‹ ", a:"ìœ ë ¹"}, {q:"ë…¸ë€ ìœ ìë¡œ ë§Œë“  ì°¨", a:"ìœ ìì°¨"}, {q:"ì´ë¦„ì´ ë„ë¦¬ ì•Œë ¤ì§„ ê²ƒ", a:"ìœ ëª…í•˜ë‹¤"},
            {q:"ë ë¥¼ ë§¤ê³  í•˜ëŠ” ìš´ë™", a:"ìœ ë„"}, {q:"ë°•ë¬¼ê´€ì— ìˆëŠ” ì˜›ë‚  ë¬¼ê±´", a:"ìœ ë¬¼"}, {q:"ìš”í”Œë ˆì— ë“¤ì–´ìˆëŠ” ê· ", a:"ìœ ì‚°ê· "}, {q:"ë¿” ë‹¬ë¦° í™˜ìƒì˜ ë§", a:"ìœ ë‹ˆì½˜"}, {q:"ê¸°ë¦„ì„ ì‹¤ì–´ë‚˜ë¥´ëŠ” ë°°", a:"ìœ ì¡°ì„ "},

            // ã…¡
            {q:"ì•„ì´ê°€ ìë¼ë©´?", a:"ì–´ë¥¸"}, {q:"ìµœê³ ë¼ëŠ” ëœ»", a:"ìœ¼ëœ¸"}, {q:"í˜ì„ ì“¸ ë•Œ ë‚´ëŠ” ì†Œë¦¬", a:"ìœ¼ë¼ì°¨ì°¨"}, {q:"ì•…ê¸°ë¡œ ì—°ì£¼í•˜ëŠ” ê²ƒ", a:"ìŒì•…"}, {q:"ë°¥, ë°˜ì°¬, ê°„ì‹", a:"ìŒì‹"},
            {q:"ì—°í•„ë¡œ ê¸€ìë¥¼ â¬œ", a:"ì“°ê¸°"}, {q:"í¬ë ˆíŒŒìŠ¤ë¡œ ê·¸ë¦¬ëŠ” ê²ƒ", a:"ê·¸ë¦¼"}, {q:"ë‚˜ë¥¼ ë¶€ë¥´ëŠ” í˜¸ì¹­", a:"ì´ë¦„"}, {q:"í…”ë ˆë¹„ì „ ì—°ì†ê·¹", a:"ë“œë¼ë§ˆ"}, {q:"ë¬¼ì´ ì•„ë˜ë¡œ â¬œ", a:"íë¥´ë‹¤"},

            // ã…£
            {q:"ë‚´ ëª…ì°°ì— ì íŒ ê²ƒ", a:"ì´ë¦„"}, {q:"ëˆˆì¹ ìœ„ì— ìˆëŠ” ì–¼êµ´", a:"ì´ë§ˆ"}, {q:"ì˜ ë•Œ ë®ëŠ” ê²ƒ", a:"ì´ë¶ˆ"}, {q:"ë‹¤ë¥¸ ì§‘ìœ¼ë¡œ ì§ì„ ì˜®ê¸°ëŠ” ê²ƒ", a:"ì´ì‚¬"}, {q:"ì•„ê¸°ê°€ ë¨¹ëŠ” ì£½", a:"ì´ìœ ì‹"},
            {q:"ë²Œì¨, ë‹¤ ëë‚œ", a:"ì´ë¯¸"}, {q:"ì§€ê¸ˆë¶€í„°", a:"ì´ì œ"}, {q:"ì—„ë§ˆì˜ ì—¬ì í˜•ì œ", a:"ì´ëª¨"}, {q:"ê·¸ë¦¼ì´ë‚˜ ì‚¬ì§„ (Image)", a:"ì´ë¯¸ì§€"}, {q:"ìƒˆë²½ í’€ìì— ë§ºíˆëŠ” ë¬¼ë°©ìš¸", a:"ì´ìŠ¬"}
        ];

        const bank_single = [
            // [1. ã„± ë°›ì¹¨]
            {q:"ë”°ëœ»í•œ â¬œì„ ë¨¹ë‹¤.", a:"êµ­", d:["êµ½","êµ¼","ê¶"]}, {q:"ë§›ìˆëŠ” â¬œ.", a:"ë–¡", d:["ë–§","ë–µ","ë–¢"]}, {q:"ìš”ë¦¬í•˜ëŠ” â¬œ.", a:"ë¶€ì—Œ", d:["ë¶€ì–µ","ë¶€ì„Ÿ","ë¶€ì—"]},
            {q:"ì°½ë¬¸ â¬œì„ ë³´ë‹¤.", a:"ë°–", d:["ë°•","ë°—","ë°¬"]}, {q:"ì‚¬ê³¼ë¥¼ â¬œ.", a:"ê¹ë‹¤", d:["ê¹ë‹¤","ê¹ë”°","ì¹µë‹¤"]}, {q:"ë°”ë‹¥ì„ â¬œ.", a:"ë‹¦ë‹¤", d:["ë‹¥ë‹¤","ë‹§ë‹¤","ë‹­ë‹¤"]},
            {q:"ë°¥ì„ â¬œ.", a:"ë³¶ë‹¤", d:["ë³µë‹¤","ë´ˆë‹¤","ë³½ë‹¤"]}, {q:"ì¬ë£Œë¥¼ â¬œ.", a:"ì„ë‹¤", d:["ì„ë‹¤","ì„Ÿë‹¤","ì„´ë‹¤"]}, {q:"ë¬¼ê³ ê¸°ë¥¼ â¬œ.", a:"ë‚šë‹¤", d:["ë‚™ë‹¤","ë‚›ë‹¤","ë‚°ë‹¤"]},
            {q:"ì‹ ë°œ ëˆì„ â¬œ.", a:"ë¬¶ë‹¤", d:["ë¬µë‹¤","ë­ˆë‹¤","ë¬»ë‹¤"]}, {q:"ë‚˜ë­‡ê°€ì§€ë¥¼ â¬œ.", a:"êº¾ë‹¤", d:["êº½ë‹¤","ê»ˆë‹¤","ì»¥ë‹¤"]}, {q:"ë°¥ì„ â¬œ.", a:"ë¨¹ë‹¤", d:["ë§ë‹¤","ë©ë‹¤","ë©Œë‹¤"]},
            {q:"ì¬ë¯¸ìˆëŠ” â¬œ.", a:"ì±…", d:["ì±„","ì±œ","ì±™"]}, {q:"í•™êµì— â¬œ.", a:"ê°€ë‹¤", d:["ì‹«ë‹¤","ê¹Œë‹¤","ì¹´ë‹¤"]}, {q:"í•˜ëŠ˜ì´ â¬œ.", a:"íŒŒë—ë‹¤", d:["íŒŒë¼íƒ€","íŒŒëë‹¤","íŒŒë€ë‹¤"]},

            // [2. ã„´ ë°›ì¹¨]
            {q:"í•˜ëŠ˜ì—ì„œ â¬œì´ ë‚´ë¦¬ë‹¤.", a:"ëˆˆ", d:["ëˆ™","ëˆ”","ëˆ‹"]}, {q:"ìš©â¬œì„ ë°›ë‹¤.", a:"ëˆ", d:["ë™","ë”","ë‹"]}, {q:"ì˜ˆìœ â¬œ.", a:"ì†", d:["ì†”","ì†œ","ì†¡"]},
            {q:"ì¹œêµ¬ì—ê²Œ â¬œë¥¼ ì“°ë‹¤.", a:"í¸ì§€", d:["í´ì§€","í‰ì§€","í„ì§€"]}, {q:"ì–‘ë§ì„ â¬œ.", a:"ì‹ ë‹¤", d:["ì‹¤ë‹¤","ì‹¬ë‹¤","ì‹£ë‹¤"]}, {q:"ì•„ê¸°ë¥¼ â¬œ.", a:"ì•ˆë‹¤", d:["ì•”ë‹¤","ì•Œë‹¤","ì••ë‹¤"]},
            {q:"ë¬¸ì„ â¬œ.", a:"ì—°ë‹¤", d:["ì—¼ë‹¤","ì–€ë‹¤","ì—½ë‹¤"]}, {q:"ì¹œêµ¬ë¥¼ â¬œ.", a:"ë§Œë‚˜ë‹¤", d:["ë§ë‚˜ë‹¤","ë§˜ë‚˜ë‹¤","ë§‰ë‚˜ë‹¤"]}, {q:"ìš°ì‚°ì´ â¬œ.", a:"ìˆë‹¤", d:["ì»ë‹¤","ì‡ë‹¤","ìŠë‹¤"]},

            // [3. ã„·/í‹°ì•(ã…Œ) ê³„ì—´]
            {q:"ê¸¸ì„ â¬œ.", a:"ê±·ë‹¤", d:["ê²ƒë‹¤","ê²†ë‹¤","ê±¸ë‹¤"]}, {q:"ë°©ë¬¸ì„ â¬œ.", a:"ë‹«ë‹¤", d:["ë‹·ë‹¤","ë‹¿ë‹¤","ë‹­ë‹¤"]}, {q:"ë•…ì— â¬œ.", a:"ë¬»ë‹¤", d:["ë­‡ë‹¤","ë­ë‹¤","ë¬µë‹¤"]},
            {q:"ì„ ìƒë‹˜ê»˜ â¬œ.", a:"ë¬»ë‹¤", d:["ë­‡ë‹¤","ë­ë‹¤","ë¬µë‹¤"]}, {q:"ë°¥ ë¨¹ëŠ” â¬œ.", a:"ìˆŸê°€ë½", d:["ìˆ«ê°€ë½","ìˆ ê°€ë½","ìˆ­ê°€ë½"]}, {q:"ë…¸ë˜ë¥¼ â¬œ.", a:"ë“£ë‹¤", d:["ë“¯ë‹¤","ë“²ë‹¤","ë“¤ë‹¤"]},
            {q:"ì¹œêµ¬ë¥¼ â¬œ.", a:"ë¯¿ë‹¤", d:["ë°‹ë‹¤","ë°‘ë‹¤","ë°€ë‹¤"]}, {q:"ì„ ë¬¼ì„ â¬œ.", a:"ë°›ë‹¤", d:["ë°­ë‹¤","ë°§ë‹¤","ë°œë‹¤"]}, {q:"ê³µë¶€ë¥¼ â¬œë‚´ë‹¤.", a:"ë", d:["ë‹","ë—","ë”"]},
            {q:"ì±„ì†Œë¥¼ ì‹¬ì€ â¬œ.", a:"ë°­", d:["ë°›","ë°§","ë°œ"]}, {q:"ë°¥ì„ ì§“ëŠ” â¬œ.", a:"ì†¥", d:["ì†Ÿ","ì†“","ì†œ"]}, {q:"ì˜ì â¬œì— ìˆ¨ë‹¤.", a:"ë°‘", d:["ë¯¿","ë°‹","ë°€"]},
            {q:"ìˆ˜ë°•ì˜ â¬œì€ ì´ˆë¡ìƒ‰.", a:"ê²‰", d:["ê±·","ê²ƒ","ê±¸"]}, {q:"ìš°ë¦¬ëŠ” ì„œë¡œ â¬œ.", a:"ê°™ë‹¤", d:["ê°€íƒ€","ê°‡ë‹¤","ê°–ë‹¤"]}, {q:"ìŠ¤í‹°ì»¤ë¥¼ â¬œ.", a:"ë¶™ë‹¤", d:["ë¶‡ë‹¤","ë¶“ë‹¤","ë¶ˆë‹¤"]},
            {q:"ê°€ê¹Œì´ â¬œ.", a:"ë¶™ë‹¤", d:["ë¶‡ë‹¤","ë¶“ë‹¤","ë¶ˆë‹¤"]},

            // [4. ã„¹ ë°›ì¹¨]
            {q:"ë°¤í•˜ëŠ˜ì˜ â¬œ.", a:"ë‹¬", d:["ë‹«","ë‹·","ë‹¹"]}, {q:"ì‹œì›í•œ â¬œ.", a:"ë¬¼", d:["ë¬´","ë¬»","ë¬µ"]}, {q:"ëœ¨ê±°ìš´ â¬œ.", a:"ë¶ˆ", d:["ë¶€","ë¶‡","ë¶“"]},
            {q:"ì–¼êµ´ì„ ë³´ëŠ” â¬œ.", a:"ê±°ìš¸", d:["ê±°ìš°","ê±°ìš´","ê±°ìš·"]}, {q:"ë‹¨í’ì´ ë“œëŠ” â¬œ.", a:"ê°€ì„", d:["ê°€ìœ¼","ê°€ì€","ê°€ìƒ"]}, {q:"ì•„íŒŒíŠ¸ì— â¬œ.", a:"ì‚´ë‹¤", d:["ì‚¬ë‹¤","ì‚½ë‹¤","ì‚¼ë‹¤"]},
            {q:"ì¹œêµ¬ì™€ â¬œ.", a:"ë†€ë‹¤", d:["ë…¸ë‹¤","ë†‰ë‹¤","ë†ˆë‹¤"]}, {q:"ì •ë‹µì„ â¬œ.", a:"ì•Œë‹¤", d:["ì•„ë‹¤","ì••ë‹¤","ì•”ë‹¤"]}, {q:"ë¹—ìë£¨ë¡œ ë°©ì„ â¬œ.", a:"ì“¸ë‹¤", d:["ì“°ë‹¤","ì”ë‹¤","ì”€ë‹¤"]},
            {q:"ì°½ë¬¸ì„ â¬œ.", a:"ì—´ë‹¤", d:["ì—¬ë‹¤","ì—½ë‹¤","ì—¼ë‹¤"]},

            // [5. ã… ë°›ì¹¨]
            {q:"ë§›ìˆëŠ” â¬œì„ ë¨¹ë‹¤.", a:"ë°¤", d:["ë°¥","ë°©","ë°œ"]}, {q:"ì¿¨ì¿¨ â¬œì„ ìë‹¤.", a:"ì ", d:["ì¡","ì¥","ì˜"]}, {q:"íŠ¼íŠ¼í•œ â¬œ.", a:"ëª¸", d:["ëª¹","ëª½","ëª°"]},
            {q:"ê½ƒì´ í”¼ëŠ” â¬œ.", a:"ë´„", d:["ë´…","ë´‰","ë³¼"]}, {q:"ë”ìš´ â¬œ.", a:"ì—¬ë¦„", d:["ì—¬ë¦…","ì—¬ë¦‰","ì—¬ë¥¼"]}, {q:"í‘¹ì‹ í•œ â¬œ.", a:"ì†œ", d:["ì†","ì†¡","ì†”"]},
            {q:"ì‹ ë‚˜ê²Œ â¬œì„ ì¶”ë‹¤.", a:"ì¶¤", d:["ì¶¥","ì¶©","ì¶œ"]}, {q:"ê·¸ë¦¼ì„ â¬œ.", a:"ê·¸ë¦¼", d:["ê·¸ë¦½","ê·¸ë§","ê·¸ë¦´"]},

            // [6. ã…‚/í”¼ì–(ã…) ê³„ì—´]
            {q:"ë§›ìˆëŠ” â¬œ.", a:"ë°¥", d:["ë°¤","ë°©","ë°­"]}, {q:"â¬œì„ í¬ê²Œ ë²Œë¦¬ë‹¤.", a:"ì…", d:["ì´","ì„","ìµ"]}, {q:"ìš°ë¦¬ â¬œ.", a:"ì§‘", d:["ì§","ì§•","ì§"]},
            {q:"ë‚˜ë¬´ê°€ ë§ì€ â¬œ.", a:"ìˆ²", d:["ìˆ©","ìˆ¨","ìˆŸ"]}, {q:"ë‚˜ë­‡â¬œì´ ë–¨ì–´ì§€ë‹¤.", a:"ì", d:["ì…","ì„","ìµ"]}, {q:"í•™êµ â¬œ.", a:"ì•", d:["ì••","ì•”","ì•—"]},
            {q:"ë‚´ â¬œì— ì•‰ì•„.", a:"ì˜†", d:["ì—½","ì—¼","ì—¿"]}, {q:"â¬œì´ ì•„í”„ë‹¤.", a:"ë¬´ë¦", d:["ë¬´ë¦…","ë¬´ë¦„","ë¬´ë¦"]}, {q:"ì´ë¶ˆì„ â¬œ.", a:"ë®ë‹¤", d:["ë¥ë‹¤","ë¤ë‹¤","ëœë‹¤"]},
            {q:"ì±…ì„ â¬œ.", a:"ë®ë‹¤", d:["ë¥ë‹¤","ë¤ë‹¤","ëœë‹¤"]}, {q:"í•˜ëŠ˜ì´ â¬œ.", a:"ë†’ë‹¤", d:["ë†‰ë‹¤","ë†Šë‹¤","ë†‘ë‹¤"]}, {q:"ê°€ë°©ì´ â¬œ.", a:"ë¬´ê²ë‹¤", d:["ë¬´ê²„ë‹¤","ë¬´ê²€ë‹¤","ë¬´ê²‹ë‹¤"]},
            {q:"ë‚ ì”¨ê°€ â¬œ.", a:"ì¶¥ë‹¤", d:["ì¶›ë‹¤","ì¶¤ë‹¤","ì¶©ë‹¤"]}, {q:"ë‚ ì”¨ê°€ â¬œ.", a:"ë¥ë‹¤", d:["ë›ë‹¤","ë¤ë‹¤","ë©ë‹¤"]}, {q:"ì¹œêµ¬ë¥¼ â¬œ.", a:"ë•ë‹¤", d:["ë…ë‹¤","ë”ë‹¤","ëŒë‹¤"]},
            {q:"ê³µì„ â¬œ.", a:"ì¡ë‹¤", d:["ì£ë‹¤","ì‘ë‹¤","ì ë‹¤"]}, {q:"ì˜·ì„ â¬œ.", a:"ì…ë‹¤", d:["ìë‹¤","ì„ë‹¤","ì‡ë‹¤"]}, {q:"ê°€ë°©ì„ â¬œ.", a:"ë§¤ë‹¤", d:["ë©”ë‹¤","ë¯¸ë‹¤","ë§ˆë‹¤"]},

            // [7. ã…‡ ë°›ì¹¨]
            {q:"íë¥´ëŠ” â¬œ.", a:"ê°•", d:["ê°„","ê°","ê°ˆ"]}, {q:"ë™ê·¸ë€ â¬œ.", a:"ê³µ", d:["ê³¤","ê³°","ê³¨"]}, {q:"ë‚´ â¬œì„ ì²­ì†Œí•˜ë‹¤.", a:"ë°©", d:["ë°˜","ë°¤","ë°œ"]},
            {q:"ë§›ìˆëŠ” â¬œ.", a:"ë¹µ", d:["ë¹¤","ë¹°","ë¹¨"]}, {q:"ì—„ë§ˆ â¬œí•´ìš”.", a:"ì‚¬ë‘", d:["ì‚¬ë€","ì‚¬ëŒ","ì‚¬ë„"]}, {q:"ê·€ì—¬ìš´ â¬œì•„ì§€.", a:"ê°•", d:["ê°„","ê°","ê°ˆ"]},

            // [8. ã……/ìŒì‹œì˜·(ã…†) ê³„ì—´]
            {q:"ì˜ˆìœ â¬œì„ ì…ë‹¤.", a:"ì˜·", d:["ì˜«","ì˜»","ì˜¥"]}, {q:"ë¨¸ë¦¬ë¥¼ â¬œë‹¤.", a:"ë¹—", d:["ë¹š","ë¹›","ë¹„"]}, {q:"ì‚¬íƒ•ì˜ â¬œ.", a:"ë§›", d:["ë§","ë§","ë§Ÿ"]},
            {q:"ê°ê¸°ê°€ â¬œ.", a:"ë‚«ë‹¤", d:["ë‚³ë‹¤","ë‚®ë‹¤","ë‚¯ë‹¤"]}, {q:"ë°¥ì„ â¬œ.", a:"ì§“ë‹¤", d:["ì§–ë‹¤","ì§™ë‹¤","ì§‡ë‹¤"]}, {q:"ì´ë¦„ì„ â¬œ.", a:"ì§“ë‹¤", d:["ì§–ë‹¤","ì§™ë‹¤","ì§‡ë‹¤"]},
            {q:"ì•½ì„ â¬œ.", a:"ì§“ë‹¤", d:["ì§–ë‹¤","ì§™ë‹¤","ì§‡ë‹¤"]}, {q:"ì–¼êµ´ì´ í‰í‰ â¬œ.", a:"ë¶“ë‹¤", d:["ë¶‡ë‹¤","ë¶™ë‹¤","ë¶ˆë‹¤"]}, {q:"ë¬¼ì„ ì»µì— â¬œ.", a:"ë¶“ë‹¤", d:["ë¶‡ë‹¤","ë¶™ë‹¤","ë¶ˆë‹¤"]},
            {q:"ìˆŸê°€ë½ìœ¼ë¡œ â¬œ.", a:"ì “ë‹¤", d:["ì –ë‹¤","ì —ë‹¤","ì ‡ë‹¤"]}, {q:"ê³ ê°œë¥¼ â¬œ.", a:"ì “ë‹¤", d:["ì –ë‹¤","ì —ë‹¤","ì ‡ë‹¤"]}, {q:"í•™êµì— â¬œ.", a:"ìˆë‹¤", d:["ì‡ë‹¤","ìŠë‹¤","ë¹šë‹¤"]},
            {q:"ì§‘ì— â¬œ.", a:"ê°”ë‹¤", d:["ê°“ë‹¤","ê°‡ë‹¤","ê°–ë‹¤"]}, {q:"ê³¼ìë¥¼ â¬œ.", a:"ìƒ€ë‹¤", d:["ì‚¿ë‹¤","ì‹¿ë‹¤","ìƒ‡ë‹¤"]}, {q:"ì†ì„ â¬œ.", a:"ì”»ë‹¤", d:["ì‹¯ë‹¤","ì‹¿ë‹¤","ì”¯ë‹¤"]},
            {q:"ê¸€ì”¨ë¥¼ â¬œ.", a:"ì“°ë‹¤", d:["ìŠ¤ë‹¤","ì‘¤ë‹¤","ì”¨ë‹¤"]}, {q:"ëª¨ìë¥¼ â¬œ.", a:"ì“°ë‹¤", d:["ìŠ¤ë‹¤","ì‘¤ë‹¤","ì”¨ë‹¤"]},

            // [9. ã…ˆ/ì¹˜ì“(ã…Š) ê³„ì—´]
            {q:"â¬œê³¼ ë°¤.", a:"ë‚®", d:["ë‚¯","ë‚«","ë‚³"]}, {q:"â¬œì ì„ ìë‹¤.", a:"ë‚®", d:["ë‚¯","ë‚«","ë‚³"]}, {q:"â¬œì„ ê°šë‹¤.", a:"ë¹š", d:["ë¹—","ë¹›","ë¹„"]},
            {q:"ë§Œë‘ë¥¼ â¬œ.", a:"ë¹šë‹¤", d:["ë¹—ë‹¤","ë¹›ë‹¤","ë¹‹ë‹¤"]}, {q:"ë³´ë¬¼ì„ â¬œ.", a:"ì°¾ë‹¤", d:["ì°»ë‹¤","ì°¯ë‹¤","ì±ƒë‹¤"]}, {q:"ì•½ì†ì„ â¬œ.", a:"ìŠë‹¤", d:["ì‡ë‹¤","ìë‹¤","ì»ë‹¤"]},
            {q:"ì‹œê°„ì— â¬œ.", a:"ëŠ¦ë‹¤", d:["ëŠ£ë‹¤","ëŠ—ë‹¤","ëŠ˜ë‹¤"]}, {q:"ì˜·ì´ ë¬¼ì— â¬œ.", a:"ì –ë‹¤", d:["ì “ë‹¤","ì —ë‹¤","ì ‡ë‹¤"]}, {q:"ê°•ì•„ì§€ê°€ ë©ë© â¬œ.", a:"ì§–ë‹¤", d:["ì§“ë‹¤","ì§™ë‹¤","ì§‡ë‹¤"]},
            {q:"ë„ë‘‘ì„ â¬œ.", a:"ì«“ë‹¤", d:["ì«’ë‹¤","ì«ë‹¤","ì«ƒë‹¤"]}, {q:"ì˜ˆìœ â¬œì´ í”¼ë‹¤.", a:"ê½ƒ", d:["ê¼¿","ê½‚","ê½…"]}, {q:"ë°˜ì§ë°˜ì§ â¬œì´ ë‚˜ë‹¤.", a:"ë¹›", d:["ë¹—","ë¹š","ë¹‹"]},
            {q:"í–‡â¬œì´ ë¹„ì¹˜ë‹¤.", a:"ë¹›", d:["ë¹—","ë¹š","ë¹‹"]}, {q:"ì–¼êµ´ â¬œì´ ì¢‹ë‹¤.", a:"ë¹›", d:["ë¹—","ë¹š","ë¹‹"]}, {q:"ë‚˜ë¬´ â¬œ.", a:"ìˆ¯", d:["ìˆ«","ìˆŸ","ìˆ­"]},
            {q:"ë¨¸ë¦¬í•€ì„ â¬œ.", a:"ê½‚ë‹¤", d:["ê¼¿ë‹¤","ê¼½ë‹¤","ê½…ë‹¤"]},

            // [10. ã… ê³„ì—´]
            {q:"ê¸°ë¶„ì´ â¬œ.", a:"ì¢‹ë‹¤", d:["ì¡°íƒ€","ì¢ƒë‹¤","ì¡¿ë‹¤"]}, {q:"ê°€ë°©ì— ì±…ì„ â¬œ.", a:"ë„£ë‹¤", d:["ë„ˆíƒ€","ë„›ë‹¤","ë„ë‹¤"]}, {q:"ì‹íƒì— ìˆŸê°€ë½ì„ â¬œ.", a:"ë†“ë‹¤", d:["ë…¸íƒ€","ë†ë‹¤","ë†Œë‹¤"]},
            {q:"ê±±ì •ì„ â¬œ.", a:"ë†“ë‹¤", d:["ë…¸íƒ€","ë†ë‹¤","ë†Œë‹¤"]}, {q:"ì•„ê¸°ë¥¼ â¬œ.", a:"ë‚³ë‹¤", d:["ë‚«ë‹¤","ë‚®ë‹¤","ë‚¯ë‹¤"]}, {q:"ë§ˆëŠ˜ì„ â¬œ.", a:"ì°§ë‹¤", d:["ì°Ÿë‹¤","ì°“ë‹¤","ì°Œë‹¤"]},
            {q:"í•˜â¬œë‹¤.", a:"í•˜ì–—ë‹¤", d:["í•˜ì•¼íƒ€","í•˜ì–ë‹¤","í•˜ì–ƒë‹¤"]}, {q:"íŒŒâ¬œë‹¤.", a:"íŒŒë—ë‹¤", d:["íŒŒë¼íƒ€","íŒŒëë‹¤","íŒŒëƒë‹¤"]}, {q:"ë…¸â¬œë‹¤.", a:"ë…¸ë—ë‹¤", d:["ë…¸ë¼íƒ€","ë…¸ëë‹¤","ë…¸ëƒë‹¤"]},
            {q:"ë¹¨â¬œë‹¤.", a:"ë¹¨ê°›ë‹¤", d:["ë¹¨ê°€íƒ€","ë¹¨ê°”ë‹¤","ë¹¨ê°‡ë‹¤"]},

            // [11. ì¶”ê°€ í˜¼ë™í•˜ê¸° ì‰¬ìš´ ë‹¨ì–´ë“¤]
            {q:"â¬œê°€ íŠ¼íŠ¼í•˜ë‹¤.", a:"ì´", d:["ì´","ë‹ˆ","ë¦¬"]}, {q:"í•˜ëŠ˜ì„ â¬œ.", a:"ë‚ ë‹¤", d:["ë‚˜ë‹¤","ë‚©ë‹¤","ë‚¨ë‹¤"]}, {q:"ë•€ì´ â¬œ.", a:"ë‚˜ë‹¤", d:["ë‚ ë‹¤","ë‚©ë‹¤","ë‚¨ë‹¤"]},
            {q:"ì ì´ â¬œ.", a:"ì˜¤ë‹¤", d:["ì˜¤ë‹¤","ìš”ë‹¤","ìš°ë‹¤"]}, {q:"ê¹€ì¹˜ë¥¼ â¬œ.", a:"ë‹´ê·¸ë‹¤", d:["ë‹¹ê·¸ë‹¤","ë‹´í¬ë‹¤","ë‹´ë‹¤"]}, {q:"ë¬¸ì„ â¬œ.", a:"ì ê·¸ë‹¤", d:["ì¥ê·¸ë‹¤","ì í¬ë‹¤","ì ë‹¤"]}
        ];

        const bank_complex = [
            // [1. ã„³]
            {q:"ë‚´ â¬œì„ ì±™ê¸°ë‹¤.", a:"ëª«", d:["ëª©","ëª´","ëªª"]}, {q:"í•  ì¼ì„ ë‹¤ í•˜ëŠ” â¬œ.", a:"ëª«", d:["ëª©","ëª´","ëªª"]}, {q:"í•˜ë£¨ ì¼í•œ â¬œ.", a:"ì‚¯", d:["ì‚­","ì‚®","ì‚´"]},
            {q:"ìˆ˜ê³ í•œ â¬œì„ ë°›ë‹¤.", a:"ì‚¯", d:["ì‚­","ì‚®","ì‚´"]}, {q:"â¬œì„ ìƒê³  ì³ë‹¤ë³´ë‹¤.", a:"ë„‹", d:["ë„‰","ë„”","ë„ "]}, {q:"â¬œì´ ë‚˜ê°€ë‹¤.", a:"ë„‹", d:["ë„‰","ë„”","ë„ "]},

            // [2. ã„µ]
            {q:"ì˜ìì— â¬œ.", a:"ì•‰ë‹¤", d:["ì•ˆë‹¤","ì•Šë‹¤","ì•‹ë‹¤"]}, {q:"ë°”ë‹¥ì— í„¸ì© â¬œ.", a:"ì•‰ë‹¤", d:["ì•ˆë‹¤","ì•Šë‹¤","ì•‹ë‹¤"]}, {q:"ë‚´ ì˜†ìë¦¬ì— â¬œ.", a:"ì•‰ë‹¤", d:["ì•ˆë‹¤","ì•Šë‹¤","ì•‹ë‹¤"]},
            {q:"ì¹œêµ¬ì™€ ë‚˜ë€íˆ â¬œ.", a:"ì•‰ë‹¤", d:["ì•ˆë‹¤","ì•Šë‹¤","ì•‹ë‹¤"]}, {q:"ìì„¸ ë³´ì • ì˜ìì— â¬œ.", a:"ì•‰ë‹¤", d:["ì•ˆë‹¤","ì•Šë‹¤","ì•‹ë‹¤"]}, {q:"ì„ ë°˜ì— ë¬¼ê±´ì„ â¬œ.", a:"ì–¹ë‹¤", d:["ì–¸ë‹¤","ì–»ë‹¤","ì—„ë‹¤"]},
            {q:"ë¨¸ë¦¬ì— ìˆ˜ê±´ì„ â¬œ.", a:"ì–¹ë‹¤", d:["ì–¸ë‹¤","ì–»ë‹¤","ì—„ë‹¤"]}, {q:"ë°¥ ìœ„ì— ë°˜ì°¬ì„ â¬œ.", a:"ì–¹ë‹¤", d:["ì–¸ë‹¤","ì–»ë‹¤","ì—„ë‹¤"]}, {q:"ì–´ê¹¨ì— ì†ì„ â¬œ.", a:"ì–¹ë‹¤", d:["ì–¸ë‹¤","ì–»ë‹¤","ì—„ë‹¤"]},
            {q:"ì¼€ì´í¬ì— ê³¼ì¼ì„ â¬œ.", a:"ì–¹ë‹¤", d:["ì–¸ë‹¤","ì–»ë‹¤","ì—„ë‹¤"]},

            // [3. ã„¶]
            {q:"ì‚¬ëŒì´ ì •ë§ â¬œ.", a:"ë§ë‹¤", d:["ë§Œë‹¤","ë§ë‹¤","ë§ë‹¤"]}, {q:"ìˆ™ì œê°€ ë„ˆë¬´ â¬œ.", a:"ë§ë‹¤", d:["ë§Œë‹¤","ë§ë‹¤","ë§ë‹¤"]}, {q:"ê±±ì •ì´ â¬œ.", a:"ë§ë‹¤", d:["ë§Œë‹¤","ë§ë‹¤","ë§ë‹¤"]},
            {q:"ê°€ìœ„ë¡œ ì¤„ì„ â¬œ.", a:"ëŠë‹¤", d:["ëë‹¤","ë‹ë‹¤","ëŒë‹¤"]}, {q:"ì „í™”ë¥¼ ëš â¬œ.", a:"ëŠë‹¤", d:["ëë‹¤","ë‹ë‹¤","ëŒë‹¤"]}, {q:"ë‹´ë°°ë¥¼ â¬œ.", a:"ëŠë‹¤", d:["ëë‹¤","ë‹ë‹¤","ëŒë‹¤"]},
            {q:"ê¸°ì°¨í‘œë¥¼ â¬œ.", a:"ëŠë‹¤", d:["ëë‹¤","ë‹ë‹¤","ëŒë‹¤"]}, {q:"ë°¥ì„ ë¨¹ì§€ â¬œ.", a:"ì•Šë‹¤", d:["ì•‰ë‹¤","ì•‹ë‹¤","ì•Œë‹¤"]}, {q:"ìˆ™ì œë¥¼ í•˜ì§€ â¬œ.", a:"ì•Šë‹¤", d:["ì•‰ë‹¤","ì•‹ë‹¤","ì•Œë‹¤"]},
            {q:"ê±°ì§“ë§ì„ í•˜ì§€ â¬œ.", a:"ì•Šë‹¤", d:["ì•“ë‹¤","ì•‹ë‹¤","ì•Œë‹¤"]}, {q:"ë‚˜ëŠ” ëª¸ì´ â¬œ.", a:"ê´œì°®ë‹¤", d:["ê´œì°¬ë‹¤","ê´œì°­ë‹¤","ê´œì±¦ë‹¤"]}, {q:"ì„±ê²©ì´ ì°¸ â¬œ.", a:"ê´œì°®ë‹¤", d:["ê´œì°¬ë‹¤","ê´œì°­ë‹¤","ê´œì±¦ë‹¤"]},
            {q:"ì²­ì†Œí•˜ê¸° â¬œ.", a:"ê·€ì°®ë‹¤", d:["ê·€ì°¬ë‹¤","ê·€ì°­ë‹¤","ê·€ì±¦ë‹¤"]}, {q:"ì”»ê¸°ê°€ ë„ˆë¬´ â¬œ.", a:"ê·€ì°®ë‹¤", d:["ê·€ì°¬ë‹¤","ê·€ì°­ë‹¤","ê·€ì±¦ë‹¤"]}, {q:"í• ë¨¸ë‹ˆê»˜ì„œ â¬œ.", a:"í¸ì°®ë‹¤", d:["í¸ì°¬ë‹¤","í¸ì°­ë‹¤","í¸ì±¦ë‹¤"]},

            // [4. ã„º]
            {q:"ì•Œì„ ë‚³ëŠ” â¬œ.", a:"ë‹­", d:["ë‹¥","ë‹¬","ë‹§"]}, {q:"ë§›ìˆëŠ” â¬œê³ ê¸°.", a:"ë‹­", d:["ë‹¥","ë‹¬","ë‹§"]}, {q:"ì¹˜í‚¨ì€ â¬œì„ íŠ€ê¸´ ê²ƒ.", a:"ë‹­", d:["ë‹¥","ë‹¬","ë‹§"]},
            {q:"ë™í™”ì±…ì„ â¬œ.", a:"ì½ë‹¤", d:["ì¼ë‹¤","ìµë‹¤","ì¿ë‹¤"]}, {q:"ì†Œë¦¬ ë‚´ì–´ â¬œ.", a:"ì½ë‹¤", d:["ì¼ë‹¤","ìµë‹¤","ì¿ë‹¤"]}, {q:"ì¹œêµ¬ì˜ ë§ˆìŒì„ â¬œ.", a:"ì½ë‹¤", d:["ì¼ë‹¤","ìµë‹¤","ì¿ë‹¤"]},
            {q:"ê°€ì„ í•˜ëŠ˜ì´ â¬œ.", a:"ë§‘ë‹¤", d:["ë§ë‹¤","ë§‰ë‹¤","ë§Šë‹¤"]}, {q:"ê³„ê³¡ ë¬¼ì´ â¬œ.", a:"ë§‘ë‹¤", d:["ë§ë‹¤","ë§‰ë‹¤","ë§Šë‹¤"]}, {q:"ë¨¸ë¦¬ê°€ â¬œ.", a:"ë§‘ë‹¤", d:["ë§ë‹¤","ë§‰ë‹¤","ë§Šë‹¤"]},
            {q:"ì‚¬ëŒì€ ëˆ„êµ¬ë‚˜ â¬œ.", a:"ëŠ™ë‹¤", d:["ëŠ‘ë‹¤","ëŠ˜ë‹¤","ëŠšë‹¤"]}, {q:"ë‹¨í’ì´ â¬œ.", a:"ë¶‰ë‹¤", d:["ë¶ë‹¤","ë¶ˆë‹¤","ë¶šë‹¤"]}, {q:"ì–¼êµ´ì´ â¬œ.", a:"ë¶‰ë‹¤", d:["ë¶ë‹¤","ë¶ˆë‹¤","ë¶šë‹¤"]},
            {q:"ë³´ë¦„ë‹¬ì´ â¬œ.", a:"ë°ë‹¤", d:["ë°œë‹¤","ë°•ë‹¤","ë° ë‹¤"]}, {q:"í‘œì •ì´ â¬œ.", a:"ë°ë‹¤", d:["ë°œë‹¤","ë°•ë‹¤","ë° ë‹¤"]}, {q:"ì˜¤ë˜ëœ ì§‘ì´ â¬œ.", a:"ë‚¡ë‹¤", d:["ë‚™ë‹¤","ë‚ ë‹¤","ë‚›ë‹¤"]},
            {q:"ì˜·ì´ ë§ì´ â¬œ.", a:"ë‚¡ë‹¤", d:["ë‚™ë‹¤","ë‚ ë‹¤","ë‚›ë‹¤"]}, {q:"ì†ê°€ë½ì´ â¬œ.", a:"êµµë‹¤", d:["êµ­ë‹¤","êµ´ë‹¤","êµ¯ë‹¤"]}, {q:"ë¹—ì¤„ê¸°ê°€ â¬œ.", a:"êµµë‹¤", d:["êµ­ë‹¤","êµ´ë‹¤","êµ¯ë‹¤"]},
            {q:"ëª©ì†Œë¦¬ê°€ â¬œ.", a:"êµµë‹¤", d:["êµ­ë‹¤","êµ´ë‹¤","êµ¯ë‹¤"]}, {q:"ë“±ì„ ì‹œì›í•˜ê²Œ â¬œ.", a:"ê¸ë‹¤", d:["ê·¹ë‹¤","ê¸€ë‹¤","ê¸‡ë‹¤"]}, {q:"ê°€ë ¤ìš´ ê³³ì„ â¬œ.", a:"ê¸ë‹¤", d:["ê·¹ë‹¤","ê¸€ë‹¤","ê¸‡ë‹¤"]},
            {q:"ë³µê¶Œì„ â¬œ.", a:"ê¸ë‹¤", d:["ê·¹ë‹¤","ê¸€ë‹¤","ê¸‡ë‹¤"]},

            // [5. ã„»]
            {q:"í–‰ë³µí•œ â¬œ.", a:"ì‚¶", d:["ì‚¼","ì‚´","ì‚·"]}, {q:"ë°°ì›€ì„ í†µí•œ â¬œ.", a:"ì•", d:["ì•”","ì•Œ","ì•"]}, {q:"ë‹¬ê±€ì„ â¬œ.", a:"ì‚¶ë‹¤", d:["ì‚¼ë‹¤","ì‚»ë‹¤","ì‚½ë‹¤"]},
            {q:"êµ­ìˆ˜ë¥¼ â¬œ.", a:"ì‚¶ë‹¤", d:["ì‚¼ë‹¤","ì‚»ë‹¤","ì‚½ë‹¤"]}, {q:"ë°°ê°€ ê³ íŒŒì„œ â¬œ.", a:"êµ¶ë‹¤", d:["êµ¼ë‹¤","êµ·ë‹¤","êµ½ë‹¤"]}, {q:"í•˜ë£¨ ì¢…ì¼ â¬œ.", a:"êµ¶ë‹¤", d:["êµ¼ë‹¤","êµ´ë‹¤","êµ½ë‹¤"]},
            {q:"ë‚˜ì´ê°€ â¬œ.", a:"ì Šë‹¤", d:["ì ë‹¤","ì ˆë‹¤","ì ‹ë‹¤"]}, {q:"ìƒê°ì´ â¬œ.", a:"ì Šë‹¤", d:["ì ë‹¤","ì ˆë‹¤","ì ‹ë‹¤"]}, {q:"ì§ì„ â¬œ.", a:"ì˜®ê¸°ë‹¤", d:["ì˜´ê¸°ë‹¤","ì˜°ê¸°ë‹¤","ì˜¹ê¸°ë‹¤"]},
            {q:"ë³‘ì„ â¬œ.", a:"ì˜®ê¸°ë‹¤", d:["ì˜´ê¸°ë‹¤","ì˜¯ê¸°ë‹¤","ì˜¹ê¸°ë‹¤"]}, {q:"ì•„ë¹ ë¥¼ â¬œ.", a:"ë‹®ë‹¤", d:["ë‹´ë‹¤","ë‹¬ë‹¤","ë‹µë‹¤"]}, {q:"ì„œë¡œ â¬œ.", a:"ë‹®ë‹¤", d:["ë‹´ë‹¤","ë‹¬ë‹¤","ë‹µë‹¤"]},

            // [6. ã„¼]
            {q:"ìˆ«ì 8ì€ â¬œ.", a:"ì—¬ëŸ", d:["ì—¬ë£","ì—¬ë","ì—¬ë„™"]}, {q:"ë‚˜ëŠ” â¬œ ì‚´ì´ë‹¤.", a:"ì—¬ëŸ", d:["ì—¬ë£","ì—¬ë","ì—¬ë„™"]}, {q:"ìš´ë™ì¥ì´ â¬œ.", a:"ë„“ë‹¤", d:["ë„—ë‹¤","ë„™ë‹¤","ë„”ë‹¤"]},
            {q:"ë§ˆìŒì´ â¬œ.", a:"ë„“ë‹¤", d:["ëŸë‹¤","ë„™ë‹¤","ë„”ë‹¤"]}, {q:"ê±°ì‹¤ì´ ì°¸ â¬œ.", a:"ë„“ë‹¤", d:["ë„ë‹¤","ë„™ë‹¤","ë„”ë‹¤"]}, {q:"ë°”ì§€ê°€ ë„ˆë¬´ â¬œ.", a:"ì§§ë‹¤", d:["ì§¤ë‹¤","ì§­ë‹¤","ì§‹ë‹¤"]},
            {q:"ë¨¸ë¦¬ì¹´ë½ì´ â¬œ.", a:"ì§§ë‹¤", d:["ì§¤ë‹¤","ì§­ë‹¤","ì§‹ë‹¤"]}, {q:"ì‹œê°„ì´ â¬œ.", a:"ì§§ë‹¤", d:["ì§¤ë‹¤","ì§­ë‹¤","ì§‹ë‹¤"]}, {q:"ë•…ì„ â¬œ.", a:"ë°Ÿë‹¤", d:["ë°¥ë‹¤","ë°œë‹¤","ë°ë‹¤"]},
            {q:"ë¸Œë ˆì´í¬ë¥¼ â¬œ.", a:"ë°Ÿë‹¤", d:["ë°¥ë‹¤","ë°œë‹¤","ë°ë‹¤"]}, {q:"ë‚¨ì˜ ë°œì„ â¬œ.", a:"ë°Ÿë‹¤", d:["ë°¥ë‹¤","ë°œë‹¤","ë°ë‹¤"]}, {q:"ì¢…ì´ê°€ â¬œ.", a:"ì–‡ë‹¤", d:["ì–„ë‹¤","ì–ë‹¤","ì–‹ë‹¤"]},
            {q:"ì—¬ë¦„ ì˜·ì€ â¬œ.", a:"ì–‡ë‹¤", d:["ì–„ë‹¤","ì–ë‹¤","ì–‹ë‹¤"]}, {q:"ì±… ë‘ê»˜ê°€ â¬œ.", a:"ì–‡ë‹¤", d:["ì–„ë‹¤","ì–ë‹¤","ì–‹ë‹¤"]}, {q:"ëœ ìµì€ ê°ì´ â¬œ.", a:"ë–«ë‹¤", d:["ë–¯ë‹¤","ë–±ë‹¤","ë–ªë‹¤"]},

            // [8. ã„¾]
            {q:"ì‚¬íƒ•ì„ â¬œ.", a:"í•¥ë‹¤", d:["í•£ë‹¤","í•Ÿë‹¤","í•©ë‹¤"]}, {q:"ê°•ì•„ì§€ê°€ ì†ì„ â¬œ.", a:"í•¥ë‹¤", d:["í•£ë‹¤","í•Ÿë‹¤","í•©ë‹¤"]}, {q:"ì•„ì´ìŠ¤í¬ë¦¼ì„ â¬œ.", a:"í•¥ë‹¤", d:["í•£ë‹¤","í•Ÿë‹¤","í•©ë‹¤"]},
            {q:"ë‚´ìš©ì„ ëŒ€ì¶© â¬œ.", a:"í›‘ë‹¤", d:["í›ë‹¤","í›‹ë‹¤","í›—ë‹¤"]}, {q:"ìœ„ì•„ë˜ë¡œ â¬œ.", a:"í›‘ë‹¤", d:["í›ë‹¤","í›‹ë‹¤","í›—ë‹¤"]},

            // [9. ã„¿]
            {q:"ì‹œë¥¼ ì†Œë¦¬ ë‚´ì–´ â¬œ.", a:"ìŠë‹¤", d:["ìë‹¤","ì„ë‹¤","ì‡ë‹¤"]}, {q:"ì‹œì¡°ë¥¼ â¬œ.", a:"ìŠë‹¤", d:["ìë‹¤","ì„ë‹¤","ì‡ë‹¤"]}, {q:"ê°€ì‚¬ë¥¼ ì¡°ìš©íˆ â¬œ.", a:"ìŠë‹¤", d:["ìë‹¤","ì„ë‹¤","ì‡ë‹¤"]},

            // [10. ã…€]
            {q:"ê¸¸ì„ â¬œ.", a:"ìƒë‹¤", d:["ì¼ë‹¤","ìŠë‹¤","ì„ë‹¤"]}, {q:"ì§€ê°‘ì„ â¬œ.", a:"ìƒë‹¤", d:["ì¼ë‹¤","ìŠë‹¤","ì„ë‹¤"]}, {q:"ì¹œêµ¬ë¥¼ â¬œ.", a:"ìƒë‹¤", d:["ì¼ë‹¤","ìŠë‹¤","ì„ë‹¤"]},
            {q:"ê¸°íšŒë¥¼ â¬œ.", a:"ìƒë‹¤", d:["ì¼ë‹¤","ìŠë‹¤","ì„ë‹¤"]}, {q:"ê³µë¶€í•˜ê¸° â¬œ.", a:"ì‹«ë‹¤", d:["ì‹¦ë‹¤","ì‹·ë‹¤","ì‹¬ë‹¤"]}, {q:"ì½©ì„ ë¨¹ê¸° â¬œ.", a:"ì‹«ë‹¤", d:["ì‹¦ë‹¤","ì‹·ë‹¤","ì‹¬ë‹¤"]},
            {q:"ë‚˜ìœ ëƒ„ìƒˆê°€ â¬œ.", a:"ì‹«ë‹¤", d:["ì‹¦ë‹¤","ì‹·ë‹¤","ì‹¬ë‹¤"]}, {q:"ì†¡ê³³ìœ¼ë¡œ êµ¬ë©ì„ â¬œ.", a:"ëš«ë‹¤", d:["ëš¤ë‹¤","ëš£ë‹¤","ëš¬ë‹¤"]}, {q:"ë§‰íŒ ê¸¸ì„ â¬œ.", a:"ëš«ë‹¤", d:["ëš¤ë‹¤","ëš¦ë‹¤","ëš¬ë‹¤"]},
            {q:"ê·€ë¥¼ â¬œ.", a:"ëš«ë‹¤", d:["ëš¤ë‹¤","ëš£ë‹¤","ëš¦ë‹¤"]}, {q:"ì°Œê°œê°€ ë³´ê¸€ë³´ê¸€ â¬œ.", a:"ë“ë‹¤", d:["ëŒë‹¤","ë‹ë‹¤","ëë‹¤"]}, {q:"ë¼ë©´ ë¬¼ì´ â¬œ.", a:"ë“ë‹¤", d:["ëŒë‹¤","ë‹ë‹¤","ëë‹¤"]},
            {q:"ì»¤í”¼ ë¬¼ì„ â¬œ.", a:"ë“ë‹¤", d:["ëŒë‹¤","ë‹ë‹¤","ëë‹¤"]}, {q:"ê°ê¸°ë¥¼ ì‹¬í•˜ê²Œ â¬œ.", a:"ì•“ë‹¤", d:["ì•Œë‹¤","ì•ë‹¤","ì•”ë‹¤"]}, {q:"ë°°íƒˆì„ â¬œ.", a:"ì•“ë‹¤", d:["ì•Œë‹¤","ì•‹ë‹¤","ì•ë‹¤"]},
            {q:"ê°€ìŠ´ì„ â¬œ.", a:"ì•“ë‹¤", d:["ì•Œë‹¤","ì•‹ë‹¤","ì•ë‹¤"]},

            // [11. ã…„]
            {q:"ì‹œê°„ì´ â¬œ.", a:"ì—†ë‹¤", d:["ì—…ë‹¤","ì—½ë‹¤","ì—„ë‹¤"]}, {q:"ëˆì´ í•˜ë‚˜ë„ â¬œ.", a:"ì—†ë‹¤", d:["ì—…ë‹¤","ì—½ë‹¤","ì—„ë‹¤"]}, {q:"ì§‘ì— ì•„ë¬´ë„ â¬œ.", a:"ì—†ë‹¤", d:["ì—…ë‹¤","ì—½ë‹¤","ì—„ë‹¤"]},
            {q:"ì¬ë¯¸ê°€ â¬œ.", a:"ì—†ë‹¤", d:["ì—…ë‹¤","ì–¾ë‹¤","ì—„ë‹¤"]}, {q:"í•  ë§ì´ â¬œ.", a:"ì—†ë‹¤", d:["ì—…ë‹¤","ì–¾ë‹¤","ì—„ë‹¤"]}, {q:"ê¸°ìš´ì´ â¬œ.", a:"ì—†ë‹¤", d:["ì—…ë‹¤","ì–¾ë‹¤","ì—„ë‹¤"]},
            {q:"ì •ë‹µì´ â¬œ.", a:"ì—†ë‹¤", d:["ì—…ë‹¤","ì–¾ë‹¤","ì—„ë‹¤"]}, {q:"ë¬¼ê±´ì˜ â¬œ.", a:"ê°’", d:["ê°‘","ê°š","ê°‹"]}, {q:"ìŒì‹ â¬œì„ ë‚´ë‹¤.", a:"ê°’", d:["ê°‘","ê°š","ê°‹"]},
            {q:"â¬œì´ ë¹„ì‹¸ë‹¤.", a:"ê°’", d:["ê°‘","ê°š","ê°‹"]}, {q:"ì˜· â¬œì´ ì‹¸ë‹¤.", a:"ê°’", d:["ê°‘","ê°š","ê°‹"]}, {q:"ê°•ì•„ì§€ê°€ ì°¸ â¬œ.", a:"ê°€ì—¾ë‹¤", d:["ê°€ì—½ë‹¤","ê°€ì—…ë‹¤","ê°€ì—†ë‹¤"]},
            {q:"ë°°ê³ í”ˆ ì•„ì´ê°€ â¬œ.", a:"ê°€ì—¾ë‹¤", d:["ê°€ì—½ë‹¤","ê°€ì—…ë‹¤","ê°€ì—†ë‹¤"]}
        ];

        const bank_life_eng = [
            // 1. ì¸ì‚¬ ë° í‘œí˜„
            {q:"ì•ˆë…•í•˜ì„¸ìš”", a:"Hello"}, {q:"ì•ˆë…• (ì¹œêµ¬)", a:"Hi"}, {q:"ì˜ ê°€", a:"Bye"}, {q:"ê³ ë§™ìŠµë‹ˆë‹¤", a:"Thank you"}, {q:"ë¯¸ì•ˆí•©ë‹ˆë‹¤", a:"Sorry"}, {q:"ì‹¤ë¡€í•©ë‹ˆë‹¤", a:"Excuse me"},
            {q:"ë„¤ / ì¢‹ì•„ìš”", a:"Yes"}, {q:"ì•„ë‹ˆìš” / ì‹«ì–´ìš”", a:"No"}, {q:"ì œë°œ / ~í•´ì£¼ì„¸ìš”", a:"Please"}, {q:"ì•Œê² ì–´", a:"Okay"}, {q:"ì¢‹ì€ ì•„ì¹¨", a:"Good morning"}, {q:"ë§Œë‚˜ì„œ ë°˜ê°€ì›Œ", a:"Nice to meet you"},
            // 2. í‘œì§€íŒ/ì•ˆì „
            {q:"ë©ˆì¶¤", a:"Stop"}, {q:"ê°€ë‹¤ / ì¶œë°œ", a:"Go"}, {q:"ë¹„ìƒêµ¬ / ë‚˜ê°€ëŠ” ê³³", a:"Exit"}, {q:"ì•ˆ", a:"In"}, {q:"ë°– (Out)", a:"Out"}, {q:"ë¯¸ì„¸ìš”", a:"Push"},
            {q:"ë‹¹ê¸°ì„¸ìš”", a:"Pull"}, {q:"í™”ì¥ì‹¤", a:"Toilet"}, {q:"ìœ„í—˜", a:"Danger"}, {q:"ì—´ë¦¼ / ì˜ì—… ì¤‘", a:"Open"}, {q:"ë‹«í˜ / ì˜ì—… ì¢…ë£Œ", a:"Close"}, {q:"ì¡°ì‹¬í•´", a:"Watch out"},
            // 3. ì‹ë‹¹/ì¹´í˜
            {q:"ì°¨ë¦¼í‘œ", a:"Menu"}, {q:"ì»¤í”¼", a:"Coffee"}, {q:"ë¬¼", a:"Water"}, {q:"ì£¼ìŠ¤", a:"Juice"}, {q:"ëœ¨ê±°ìš´", a:"Hot"}, {q:"ì°¨ê°€ìš´ / ì–¼ìŒ", a:"Ice"},
            {q:"í¬ì¥", a:"Take out"}, {q:"í¬ê¸°", a:"Size"}, {q:"ë‹­ê³ ê¸°", a:"Chicken"}, {q:"í”¼ì", a:"Pizza"}, {q:"ìš°ìœ ", a:"Milk"}, {q:"ë¹µ", a:"Bread"},
            // 4. ë””ì§€í„¸/ê²Œì„
            {q:"ë¬´ì„  ì¸í„°ë„·", a:"WiFi"}, {q:"ë°ì´í„°", a:"Data"}, {q:"ì¼œì§", a:"On"}, {q:"êº¼ì§", a:"Off"}, {q:"ì‹œì‘", a:"Start"}, {q:"ê²Œì„ ë", a:"Game Over"},
            {q:"ì•„ì´ë””", a:"ID"}, {q:"ë¹„ë°€ë²ˆí˜¸", a:"Password"}, {q:"ê±´ë„ˆë›°ê¸°", a:"Skip"}, {q:"ê²€ìƒ‰", a:"Search"}, {q:"ìŠ¹ë¦¬", a:"Win"}, {q:"íŒ¨ë°°", a:"Lose"},
            // 5. ì‡¼í•‘/ë¬¼ê±´
            {q:"í• ì¸", a:"Sale"}, {q:"ê°€ê²©", a:"Price"}, {q:"ìƒˆë¡œìš´ ê²ƒ", a:"New"}, {q:"ìµœê³  / ì¸ê¸°", a:"Best"}, {q:"ë§¤ì§„ (ë‹¤ íŒ”ë¦¼)", a:"Sold out"}, {q:"í˜„ê¸ˆ", a:"Cash"},
            {q:"ì¹´ë“œ", a:"Card"}, {q:"ê°€ë°© / ë´‰íˆ¬", a:"Bag"}, {q:"ì„ ë¬¼", a:"Gift"}, {q:"ê³µì§œ / ììœ ", a:"Free"}, {q:"ì‹œì¥ / ë§ˆíŠ¸", a:"Market"}, {q:"ìƒì", a:"Box"},
            // 6. ì¥ì†Œ/ì´ë™
            {q:"ë²„ìŠ¤", a:"Bus"}, {q:"íƒì‹œ", a:"Taxi"}, {q:"ì§€í•˜ì² ", a:"Subway"}, {q:"ìŠ¹ê°•ê¸°", a:"Elevator"}, {q:"í•™êµ", a:"School"}, {q:"ì§‘", a:"Home"},
            {q:"ë§ˆíŠ¸ / ê°€ê²Œ", a:"Store"}, {q:"ê³µì›", a:"Park"}, {q:"ì£¼ì°¨ì¥", a:"Parking"}, {q:"í‘œ", a:"Ticket"}, {q:"ë°©", a:"Room"}, {q:"ê¸¸", a:"Road"},
            // 7. ë‚˜/ì‚¬ëŒ
            {q:"ë‚˜", a:"I"}, {q:"ë„ˆ / ë‹¹ì‹ ", a:"You"}, {q:"ì´ë¦„", a:"Name"}, {q:"ì¹œêµ¬", a:"Friend"}, {q:"ì„ ìƒë‹˜", a:"Teacher"}, {q:"í•™ìƒ", a:"Student"},
            {q:"ì—„ë§ˆ", a:"Mom"}, {q:"ì•„ë¹ ", a:"Dad"}, {q:"ê°€ì¡±", a:"Family"}, {q:"ì•„ê¸°", a:"Baby"}, {q:"ë‚¨ì", a:"Man"}, {q:"ì—¬ì", a:"Woman"},
            // 8. ê°ì •/ìƒíƒœ
            {q:"í–‰ë³µí•œ", a:"Happy"}, {q:"ìŠ¬í”ˆ", a:"Sad"}, {q:"ì¢‹ì€", a:"Good"}, {q:"ë‚˜ìœ", a:"Bad"}, {q:"ì‚¬ë‘", a:"Love"}, {q:"í™”ë‚œ", a:"Angry"},
            {q:"ë°°ê³ í”ˆ", a:"Hungry"}, {q:"ëª©ë§ˆë¥¸", a:"Thirsty"}, {q:"ì‰¬ìš´", a:"Easy"}, {q:"ì–´ë ¤ìš´", a:"Hard"}, {q:"ì•„í”ˆ", a:"Sick"}, {q:"í”¼ê³¤í•œ", a:"Tired"},
            // 9. ìˆ«ì/ì‹œê°„/ë‚ ì§œ
            {q:"í•˜ë‚˜ (1)", a:"One"}, {q:"ë‘˜ (2)", a:"Two"}, {q:"ì…‹ (3)", a:"Three"}, {q:"ì—´ (10)", a:"Ten"}, {q:"ì‹œê°„", a:"Time"}, {q:"ë‚® / í•˜ë£¨", a:"Day"},
            {q:"ë°¤", a:"Night"}, {q:"ì•„ì¹¨", a:"Morning"}, {q:"ì§€ê¸ˆ", a:"Now"}, {q:"ë‚ ì§œ", a:"Date"}, {q:"ì£¼ë§", a:"Weekend"}, {q:"ë…„ (í•´)", a:"Year"},
            // 10. ìƒ‰ê¹”/ìì—°/ê¸°íƒ€
            {q:"ë¹¨ê°•", a:"Red"}, {q:"íŒŒë‘", a:"Blue"}, {q:"ë…¸ë‘", a:"Yellow"}, {q:"ì´ˆë¡", a:"Green"}, {q:"ê²€ì •", a:"Black"}, {q:"í•˜ì–‘", a:"White"},
            {q:"í°", a:"Big"}, {q:"ì‘ì€", a:"Small"}, {q:"í•´", a:"Sun"}, {q:"ë‹¬", a:"Moon"}, {q:"ë³„", a:"Star"}, {q:"ë¹„", a:"Rain"}
        ];

        const R_DATA = {
            locations: ["êµ­ë¦½ê³¼í•™ê´€", "ë™ë¬¼ì›", "ë†€ì´ê³µì›", "ì‹ë¬¼ì›", "ì—­ì‚¬ë°•ë¬¼ê´€", "ì•„ì¿ ì•„ë¦¬ì›€", "ë¯¼ì†ì´Œ", "ìë™ì°¨ë°•ë¬¼ê´€"],
            items: ["ë„ì‹œë½", "ë¬¼", "ëª¨ì", "ë‹ë³´ê¸°", "ìš°ì‚°", "í•„ê¸°ë„êµ¬", "ìˆ˜ì²©", "ì¹´ë©”ë¼", "ê°„ì‹", "ë©€ë¯¸ì•½", "íœ´ì§€", "ë—ìë¦¬"],
            weekdays: ["ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† ", "ì¼"],
            cities: ["ì„œìš¸", "ë¶€ì‚°", "ëŒ€êµ¬", "ëŒ€ì „", "ê´‘ì£¼", "ìš¸ì‚°", "ê°•ë¦‰", "ì „ì£¼", "ê²½ì£¼", "í¬í•­"],
            names: ["ê¹€ì² ìˆ˜", "ì´ì˜í¬", "ê¹€ì˜í™˜", "ìœ¤ì§€í˜¸", "ì¥ì˜ì¬", "ìœ¤ì¤€ì˜", "í—ˆì°¬", "ë°•ì§€í›ˆ"],
            medicines: ["ê°ê¸°ì•½", "ë‘í†µì•½", "ì†Œí™”ì œ", "ë¹„ì—¼ì•½", "ì•ˆì•½", "í”¼ë¶€ì•½"],
            warnings: ["ì¡¸ìŒ", "ë³µí†µ", "ë‘í†µ", "ë°œì§„", "ì–´ì§€ëŸ¬ì›€", "ê°€ë ¤ì›€", "ì†ì“°ë¦¼"],
            storage: ["ì‹¤ì˜¨", "ëƒ‰ì¥ê³ ", "ì„œëŠ˜í•œ ê³³", "ë¹›ì´ ì—†ëŠ” ê³³", "ê±´ì¡°í•œ ê³³"],
            foods: ["ë¹„ë¹”ë°¥", "ëˆê°€ìŠ¤", "ê¹€ì¹˜ì°Œê°œ", "ë¶ˆê³ ê¸°", "ì§œì¥ë©´", "ë³¶ìŒë°¥", "í–„ë²„ê±°", "ì¹˜í‚¨"],
            movies: ["ìŠˆí¼íˆì–´ë¡œ", "ê³µë£¡ì˜ ëª¨í—˜", "ìš°ì£¼ ì—¬í–‰", "íƒì • ì½”ë‚œ", "ê²¨ìš¸ ì™•êµ­", "ì•„ë°”íƒ€", "í† ì´ìŠ¤í† ë¦¬"],
            lostItems: ["ì§€ê°‘", "íœ´ëŒ€í°", "ê°€ë°©", "ìš°ì‚°", "ì•ˆê²½", "ëª¨ì", "ì¹´ë“œ", "ì´ì–´í°", "ì¸í˜•", "ì—´ì‡ "]
        };
        
        const SCHEDULE_DATA = {
            STUDENT: { title: "ğŸ§‘â€ğŸ“ ì´í•™ìƒì˜ í•˜ë£¨", items: [ { t: "07:00", a: "ê¸°ìƒ" }, { t: "08:00", a: "ë“±êµ" }, { t: "09:00", a: "1êµì‹œ" }, { t: "12:30", a: "ì ì‹¬" }, { t: "14:30", a: "í•˜êµ" }, { t: "16:00", a: "í•™ì›" }, { t: "19:00", a: "ì €ë…" }, { t: "21:30", a: "ì·¨ì¹¨" } ] },
            WORKER: { title: "ğŸ‘” ê¹€ëŒ€ë¦¬ì˜ í•˜ë£¨", items: [ { t: "06:30", a: "ê¸°ìƒ" }, { t: "08:50", a: "ì¶œê·¼" }, { t: "12:00", a: "ì ì‹¬" }, { t: "13:00", a: "ì—…ë¬´" }, { t: "18:00", a: "í‡´ê·¼" }, { t: "19:30", a: "ì €ë…" }, { t: "21:00", a: "ìš´ë™" }, { t: "00:00", a: "ì·¨ì¹¨" } ] },
            HOUSEWIFE: { title: "ğŸ  ë°•ì£¼ë¶€ì˜ í•˜ë£¨", items: [ { t: "06:00", a: "ê¸°ìƒ" }, { t: "07:00", a: "ì•„ì¹¨ì¤€ë¹„" }, { t: "09:00", a: "ì²­ì†Œ" }, { t: "12:00", a: "ì ì‹¬" }, { t: "14:00", a: "ì¥ë³´ê¸°" }, { t: "17:00", a: "ì €ë…ì¤€ë¹„" }, { t: "20:00", a: "ìœ¡ì•„í‡´ê·¼" }, { t: "23:00", a: "ì·¨ì¹¨" } ] },
            FREELANCER: { title: "ğŸ’» í”„ë¦¬ëœì„œì˜ í•˜ë£¨", items: [ { t: "09:00", a: "ê¸°ìƒ" }, { t: "10:00", a: "ì´ë©”ì¼í™•ì¸" }, { t: "11:00", a: "ì‘ì—…ì‹œì‘" }, { t: "14:00", a: "ëŠ¦ì€ì ì‹¬" }, { t: "15:00", a: "ë¯¸íŒ…" }, { t: "18:00", a: "ì‘ì—…í‡´ê·¼" }, { t: "21:00", a: "ì•¼ê°„ì‘ì—…" }, { t: "02:00", a: "ì·¨ì¹¨" } ] },
            ELEMENTARY_LOW: { title: "ğŸ’ 1í•™ë…„ì˜ í•˜ë£¨", items: [ { t: "07:30", a: "ì¼ì–´ë‚˜ê¸°" }, { t: "08:30", a: "í•™êµê°€ê¸°" }, { t: "09:00", a: "ê³µë¶€í•˜ê¸°" }, { t: "12:00", a: "ê¸‰ì‹ë¨¹ê¸°" }, { t: "13:00", a: "ì§‘ì—ê°€ê¸°" }, { t: "14:00", a: "ë†€ì´í„°" }, { t: "18:00", a: "ì €ë…ë¨¹ê¸°" }, { t: "21:00", a: "ì ìê¸°" } ] },
            HIGH_SCHOOL: { title: "ğŸ“š ê³ 3ì˜ í•˜ë£¨", items: [ { t: "06:00", a: "ê¸°ìƒ" }, { t: "07:00", a: "ë“±êµ" }, { t: "08:00", a: "0êµì‹œ" }, { t: "13:00", a: "ì ì‹¬ì‹œê°„" }, { t: "18:00", a: "ì„ì‹" }, { t: "19:00", a: "ì•¼ì" }, { t: "23:00", a: "í•˜êµ" }, { t: "01:00", a: "ì·¨ì¹¨" } ] }
        };

        const bank_recycle = [
            {q:"íƒë°° ìƒì(í…Œì´í”„ì œê±°)", a:"ì¢…ì´"}, {q:"ì‹ ë¬¸ì§€", a:"ì¢…ì´"}, {q:"ìš°ìœ íŒ©(ë¬¼ë¡œ í—¹êµ¼)", a:"ì¢…ì´"}, {q:"ë‹¤ ì“´ ê³µì±…(ìŠ¤í”„ë§ ì œê±°)", a:"ì¢…ì´"},
            {q:"íˆ¬ëª… ì»¤í”¼ì»µ", a:"í”Œë¼ìŠ¤í‹±"}, {q:"ìƒìˆ˜ë³‘(ë¼ë²¨ì œê±°)", a:"í”Œë¼ìŠ¤í‹±"}, {q:"ìƒ´í‘¸í†µ", a:"í”Œë¼ìŠ¤í‹±"}, {q:"ìš”êµ¬ë¥´íŠ¸ë³‘", a:"í”Œë¼ìŠ¤í‹±"},
            {q:"ì°¸ì¹˜ ìº”", a:"ìº”"}, {q:"ì½œë¼ ìº”", a:"ìº”"}, {q:"ë¶€íƒ„ê°€ìŠ¤(êµ¬ë©ëš«ìŒ)", a:"ìº”"}, {q:"ì†Œì£¼ë³‘", a:"ìœ ë¦¬"}, {q:"ë§¥ì£¼ë³‘", a:"ìœ ë¦¬"}, {q:"ì°¸ê¸°ë¦„ ë³‘", a:"ìœ ë¦¬"},
            {q:"ê³¼ì ë´‰ì§€", a:"ë¹„ë‹"}, {q:"ë¼ë©´ ë´‰ì§€", a:"ë¹„ë‹"}, {q:"ê²€ì • ë¹„ë‹ë´‰íˆ¬", a:"ë¹„ë‹"}, {q:"ì¹˜í‚¨ ë¼ˆ", a:"ì¼ë°˜ì“°ë ˆê¸°"}, {q:"ë¬¼í‹°ìŠˆ", a:"ì¼ë°˜ì“°ë ˆê¸°"},
            {q:"ê¹¨ì§„ ìœ ë¦¬", a:"ì¼ë°˜ì“°ë ˆê¸°"}, {q:"ë°”ë‚˜ë‚˜ ê»ì§ˆ", a:"ìŒì‹ë¬¼"}, {q:"ìˆ˜ë°• ê»ì§ˆ", a:"ìŒì‹ë¬¼"}, {q:"ë‚¨ì€ ë°¥", a:"ìŒì‹ë¬¼"}, {q:"ì»µë¼ë©´ ìš©ê¸°(êµ­ë¬¼ìêµ­)", a:"ì¼ë°˜ì“°ë ˆê¸°"},
            {q:"ì»µë¼ë©´ ìš©ê¸°(ê¹¨ë—í•¨)", a:"ìŠ¤í‹°ë¡œí¼"}, {q:"íƒë°° ìŠ¤í‹°ë¡œí¼", a:"ìŠ¤í‹°ë¡œí¼"}
        ];

        const RANK_SCORE = { 'SSS': 100, 'SS': 95, 'S': 90, 'A+': 88, 'A': 85, 'B+': 83, 'B': 80, 'C+': 75, 'C': 70, '-': 0 };
        const TARGET_SCORE = 50;
   // ==========================================
        // [3] ë¬¸ì œ ìƒì„± ë¡œì§: êµ­ì–´ (ì•ˆë‚´ë¬¸ ë…í•´)
        // Code 2ì˜ ëª¨ë“  ì‹œë‚˜ë¦¬ì˜¤(ê¸°ì´ˆ 0~5, ì‹¬í™” 0~9) ì™„ë²½ ì´ì‹
        // ==========================================

        // [3-1] ì•ˆë‚´ë¬¸ ë…í•´ (ê¸°ì´ˆ) - Code 2 generateReadingQuiz() ì´ì‹
        function generateReadingQuiz() {
            const scenarioType = getRandomInt(0, 5); // 0:ì²´í—˜í•™ìŠµ, 1:ê¸°ì°¨í‘œ, 2:ë³‘ì›, 3:ì•½ë´‰íˆ¬, 4:ë¶„ì‹¤ë¬¼, 5:ì˜í™”í‘œ
            let title, content, qList, answer, options;
            
            // --- ì‹œë‚˜ë¦¬ì˜¤ 0: í˜„ì¥ì²´í—˜í•™ìŠµ ---
            if (scenarioType === 0) {
                const dest = getRand(R_DATA.locations);
                const date = getRandDate();
                const day = getRand(R_DATA.weekdays);
                const timeMeet = getRandTime(8, 9);
                const timeStart = getRandTime(9, 10);
                const timeEnd = getRandTime(14, 16);
                const item1 = getRand(R_DATA.items);
                const item2 = getRand(R_DATA.items);
                const busNum = getRandomInt(1, 5);
                
                title = "í˜„ì¥ì²´í—˜í•™ìŠµ ì•ˆë‚´";
                content = `
                    <div class="text-left space-y-2">
                        <p><strong>1. ì¼ì‹œ:</strong> ${date} (${day}) ${timeStart} ~ ${timeEnd}</p>
                        <p><strong>2. ì¥ì†Œ:</strong> ${dest} (ë²„ìŠ¤ ${busNum}í˜¸ì°¨)</p>
                        <p><strong>3. ì¤€ë¹„ë¬¼:</strong> ${item1}, ${item2}, ìš´ë™í™”</p>
                        <p><strong>4. ëª¨ì´ëŠ” ì‹œê°„:</strong> ${timeMeet}ê¹Œì§€ êµì‹¤ë¡œ</p>
                        <div class="mt-4 p-2 bg-yellow-50/50 rounded text-sm border border-yellow-200">
                            <p class="text-gray-600 font-bold">* ë¹„ê°€ ì˜¤ë©´ 'ì²´ìœ¡ê´€'ì—ì„œ ì§„í–‰í•©ë‹ˆë‹¤.</p>
                        </div>
                    </div>`;

                const qPool = [
                    { q: "ì²´í—˜í•™ìŠµ ì¥ì†ŒëŠ” ì–´ë””ì¸ê°€ìš”?", a: dest, t: 'array', src: R_DATA.locations },
                    { q: "ë¬´ìŠ¨ ìš”ì¼ì— ê°€ë‚˜ìš”?", a: day + "ìš”ì¼", t: 'array', src: R_DATA.weekdays.map(d=>d+"ìš”ì¼") },
                    { q: "ê¼­ ê°€ì ¸ê°€ì•¼ í•  ë¬¼ê±´ì€?", a: item1, t: 'array', src: R_DATA.items },
                    { q: "ëª‡ ì‹œê¹Œì§€ ëª¨ì—¬ì•¼ í•˜ë‚˜ìš”?", a: timeMeet, t: 'time' },
                    { q: "ì²´í—˜í•™ìŠµì´ ëë‚˜ëŠ” ì‹œê°„ì€?", a: timeEnd, t: 'time' },
                    { q: "íƒ€ê³  ê°€ëŠ” ë²„ìŠ¤ëŠ” ëª‡ í˜¸ì°¨ì¸ê°€ìš”?", a: busNum+"í˜¸ì°¨", t: 'text_num' },
                    { q: "ë¹„ê°€ ì˜¤ë©´ ì–´ë””ì„œ ì§„í–‰í•˜ë‚˜ìš”?", a: "ì²´ìœ¡ê´€", t: 'array', src: ["ìš´ë™ì¥", "êµì‹¤", "ì‹ë‹¹", "ê°•ë‹¹"] }
                ];
                const q = getRand(qPool);
                answer = q.a; options = getDistractors(q.a, q.t, q.src); qList = q.q; 
            }

            // --- ì‹œë‚˜ë¦¬ì˜¤ 1: ê¸°ì°¨í‘œ (KTX) ---
            else if (scenarioType === 1) {
                const dep = getRand(R_DATA.cities);
                let arr = getRand(R_DATA.cities);
                while(dep === arr) arr = getRand(R_DATA.cities);
                
                const date = `2025ë…„ ${getRandDate()}`;
                const tDep = getRandTime(6, 20);
                const [h, m] = tDep.split(':').map(Number);
                const tArr = `${String((h+2)%24).padStart(2,'0')}:${String(m+getRandomInt(1,5)*5).padStart(2,'0')}`;
                
                const car = getRandomInt(1, 18);
                const seat = getRandomInt(1, 15) + ["A", "B", "C", "D"][getRandomInt(0,3)];
                const price = getRandomInt(20, 80) * 1000 + getRandomInt(1, 9) * 100;
                const priceStr = price.toLocaleString() + "ì›";

                title = "KTX ìŠ¹ì°¨ê¶Œ";
                content = `
                    <div class="border-2 border-dashed border-gray-400 p-4 rounded bg-gray-50 text-black">
                        <div class="flex justify-between font-black text-lg mb-4 border-b border-gray-300 pb-2">
                            <span>${dep}</span> â¡ <span>${arr}</span>
                        </div>
                        <div class="space-y-1">
                            <p><strong>ë‚ ì§œ:</strong> ${date}</p>
                            <p><strong>ì¶œë°œ:</strong> ${tDep} / <strong>ë„ì°©:</strong> ${tArr}</p>
                            <p><strong>ì¢Œì„:</strong> ${car}í˜¸ì°¨ ${seat}</p>
                            <p><strong>ìš´ì„:</strong> ${priceStr}</p>
                        </div>
                    </div>`;

                const qPool = [
                    { q: "ì¶œë°œí•˜ëŠ” ë„ì‹œëŠ”?", a: dep, t: 'array', src: R_DATA.cities },
                    { q: "ë„ì°©í•˜ëŠ” ë„ì‹œëŠ”?", a: arr, t: 'array', src: R_DATA.cities },
                    { q: "ê¸°ì°¨ê°€ ì¶œë°œí•˜ëŠ” ì‹œê°„ì€?", a: tDep, t: 'time' },
                    { q: "ê¸°ì°¨ì— ë„ì°©í•˜ëŠ” ì‹œê°„ì€?", a: tArr, t: 'time' },
                    { q: "ëª‡ í˜¸ì°¨ì— íƒ€ì•¼ í•˜ë‚˜ìš”?", a: car+"í˜¸ì°¨", t: 'text_num' },
                    { q: "ì¢Œì„ ë²ˆí˜¸ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", a: seat, t: 'array', src: [getRandomInt(1,15)+"A", getRandomInt(1,15)+"B", getRandomInt(1,15)+"C"] },
                    { q: "ê¸°ì°¨í‘œ ê°€ê²©ì€ ì–¼ë§ˆì¸ê°€ìš”?", a: priceStr, t: 'text_num' } 
                ];
                const q = getRand(qPool);
                
                if(q.q.includes("ê°€ê²©")) {
                    let pSet = new Set([priceStr]);
                    let loop = 0;
                    while(pSet.size < 4 && loop < 50) { 
                        pSet.add((price + getRandomInt(-10, 10)*1000).toLocaleString() + "ì›");
                        loop++;
                    }
                    while(pSet.size < 4) pSet.add((price + pSet.size * 1000 + 5000).toLocaleString() + "ì›");
                    options = shuffleArray(Array.from(pSet));
                } else {
                    options = getDistractors(q.a, q.t, q.src);
                }
                answer = q.a; qList = q.q;
            }

            // --- ì‹œë‚˜ë¦¬ì˜¤ 2: ì•½ ë´‰íˆ¬ ---
            else if (scenarioType === 2) {
                const name = getRand(R_DATA.names);
                const med = getRand(R_DATA.medicines);
                const perDay = getRandomInt(1, 5); 
                const days = getRandomInt(3, 7); 
                const timing = ["ì‹ì‚¬ í›„ 30ë¶„", "ì‹ì‚¬ ì „ 30ë¶„", "ì‹ì‚¬ ì§í›„", "ìê¸° ì „"][getRandomInt(0, 3)];
                const warn = getRand(R_DATA.warnings);
                const store = getRand(R_DATA.storage);

                title = "ì•½ ë³µìš© ì•ˆë‚´";
                content = `
                    <div class="bg-white border border-gray-200 p-4 rounded text-left shadow-sm">
                        <p class="font-bold border-b-2 border-gray-800 mb-3 pb-1 text-lg">${name} ë‹˜ (${med})</p>
                        <div class="space-y-1 text-sm">
                            <p><strong>- ìš©ë²•:</strong> 1ì¼ ${perDay}íšŒ, ${days}ì¼ë¶„</p>
                            <p><strong>- ì‹œê°„:</strong> ${timing} ë³µìš©</p>
                            <p><strong>- ë³´ê´€:</strong> ${store}</p>
                            <p class="text-red-600 font-bold mt-2">â€» ì£¼ì˜: ${warn} ì¦ìƒ ê°€ëŠ¥</p>
                        </div>
                    </div>`;

                const qPool = [
                    { q: "ì´ ì•½ì€ ëˆ„êµ¬ì˜ ê²ƒì¸ê°€ìš”?", a: name, t: 'array', src: R_DATA.names },
                    { q: "í•˜ë£¨ì— ëª‡ ë²ˆ ë¨¹ë‚˜ìš”?", a: perDay+"íšŒ", t: 'text_num' },
                    { q: "ë©°ì¹  ë™ì•ˆ ë¨¹ì–´ì•¼ í•˜ë‚˜ìš”?", a: days+"ì¼ë¶„", t: 'text_num' },
                    { q: "ì–¸ì œ ë¨¹ì–´ì•¼ í•˜ë‚˜ìš”?", a: timing, t: 'array', src: ["ì‹ì‚¬ í›„ 30ë¶„", "ì‹ì‚¬ ì „ 30ë¶„", "ì‹ì‚¬ ì§í›„", "ìê¸° ì „"] },
                    { q: "ì–´ë””ì— ë³´ê´€í•´ì•¼ í•˜ë‚˜ìš”?", a: store, t: 'array', src: R_DATA.storage },
                    { q: "ì£¼ì˜í•´ì•¼ í•  ì¦ìƒì€?", a: warn, t: 'array', src: R_DATA.warnings }
                ];
                const q = getRand(qPool);
                answer = q.a; options = getDistractors(q.a, q.t, q.src); qList = q.q;
            }

            // --- ì‹œë‚˜ë¦¬ì˜¤ 3: ì˜í™” ì…ì¥ê¶Œ ---
            else if (scenarioType === 3) {
                const movie = getRand(R_DATA.movies);
                const theater = getRandomInt(1, 9);
                const floor = getRandomInt(1, 7);
                const tStart = getRandTime(10, 22);
                const adults = getRandomInt(1, 3);
                const kids = getRandomInt(0, 3);
                const totalP = adults + kids;

                const fullLocAnswer = `${floor}ì¸µ ${theater}ê´€`;
                const fullLocOptions = [
                    fullLocAnswer,                                      
                    `${floor}ì¸µ ${theater === 9 ? 8 : theater + 1}ê´€`,  
                    `${floor === 7 ? 6 : floor + 1}ì¸µ ${theater}ê´€`,    
                    `${getRandomInt(1, 7)}ì¸µ ${getRandomInt(1, 9)}ê´€`   
                ];

                title = "ì˜í™” ì…ì¥ê¶Œ";
                content = `
                    <div class="text-left bg-gray-900 p-4 rounded border border-gray-700 text-white">
                        <h3 class="text-lg font-bold text-yellow-400 mb-2 border-b border-gray-600 pb-2">MEGA CINEMA</h3>
                        <div class="space-y-1 text-gray-200">
                            <p><strong>ì˜í™”:</strong> ${movie}</p>
                            <p><strong>ìƒì˜ê´€:</strong> <span class="text-green-400 font-bold">${theater}ê´€</span> (${floor}ì¸µ)</p>
                            <p><strong>ì‹œê°„:</strong> ${tStart} ì‹œì‘</p>
                            <p><strong>ì¸ì›:</strong> ì„±ì¸ ${adults}ëª…, ì²­ì†Œë…„ ${kids}ëª…</p>
                            <p class="mt-2 text-sm text-gray-400">â€» ì£¼ì°¨: 3ì‹œê°„ ë¬´ë£Œ</p>
                        </div>
                    </div>`;

                const qPool = [
                    { q: "ì–´ë–¤ ì˜í™”ë¥¼ ë³´ë‚˜ìš”?", a: movie, t: 'array', src: R_DATA.movies },
                    { q: "ìƒì˜ê´€ì€ ëª‡ ê´€ì¸ê°€ìš”?", a: theater+"ê´€", t: 'text_num' },      
                    { q: "ìƒì˜ê´€ì€ ëª‡ ì¸µì— ìˆë‚˜ìš”?", a: floor+"ì¸µ", t: 'text_num' },       
                    { q: "ìƒì˜ê´€ì€ ëª‡ ì¸µ, ëª‡ ê´€ì¸ê°€ìš”?", a: fullLocAnswer, t: 'array', src: fullLocOptions }, 
                    { q: "ì˜í™” ì‹œì‘ ì‹œê°„ì€?", a: tStart, t: 'time' },
                    { q: "ê´€ëŒí•˜ëŠ” ì‚¬ëŒì€ ëª¨ë‘ ëª‡ ëª…?", a: totalP+"ëª…", t: 'text_num' },
                    { q: "ì„±ì¸ì€ ëª‡ ëª…ì¸ê°€ìš”?", a: adults+"ëª…", t: 'text_num' }
                ];
                
                const q = getRand(qPool);
                answer = q.a; 
                if(q.src && q.q.includes("ëª‡ ì¸µ, ëª‡ ê´€")) { options = shuffleArray(q.src); } 
                else { options = getDistractors(q.a, q.t, q.src); }
                qList = q.q;
            }

            // --- ì‹œë‚˜ë¦¬ì˜¤ 4: ë¶„ì‹¤ë¬¼ ---
            else if (scenarioType === 4) {
                const item = getRand(R_DATA.lostItems);
                const color = getRand(["ë¹¨ê°„ìƒ‰", "íŒŒë€ìƒ‰", "ê²€ì€ìƒ‰", "ë…¸ë€ìƒ‰", "í°ìƒ‰", "ì´ˆë¡ìƒ‰"]);
                const place = getRand(["ìš´ë™ì¥", "ê¸‰ì‹ì‹¤", "ë„ì„œê´€", "ìŒì•…ì‹¤", "í™”ì¥ì‹¤", "ë³µë„"]);
                const owner = getRand(R_DATA.names);
                const grade = getRandomInt(1, 6);
                const classNum = getRandomInt(1, 5);
                const storageList = ["í–‰ì •ì‹¤", "êµë¬´ì‹¤", "ë³´ê±´ì‹¤", "ê²½ë¹„ì‹¤", "ë°©ì†¡ì‹¤", "ìƒë‹´ì‹¤"];
                const currentStorage = getRand(storageList);

                title = "ì£¼ì¸ì„ ì°¾ìŠµë‹ˆë‹¤";
                content = `
                    <div class="text-left bg-yellow-50 p-4 rounded border border-yellow-200">
                        <h3 class="text-center font-bold text-xl mb-4 text-yellow-800">ë¶„ì‹¤ë¬¼ ìŠµë“</h3>
                        <div class="space-y-2 text-gray-800">
                            <p><span class="text-gray-500 font-bold">ë¬¼ê±´:</span> ${color} ${item}</p>
                            <p><span class="text-gray-500 font-bold">ë°œê²¬ ì¥ì†Œ:</span> ${place}</p>
                            <p><span class="text-gray-500 font-bold">ë³´ê´€ ì¤‘:</span> ${currentStorage}</p> 
                            <p><span class="text-gray-500 font-bold">ì—°ë½ì²˜:</span> ${grade}í•™ë…„ ${classNum}ë°˜ ${owner}</p>
                        </div>
                    </div>`;

                const qPool = [
                    { q: "ìƒì–´ë²„ë¦° ë¬¼ê±´ì€ ë¬´ì—‡ì¸ê°€ìš”?", a: item, t: 'array', src: R_DATA.lostItems },
                    { q: "ë¬¼ê±´ì˜ ìƒ‰ê¹”ì€?", a: color, t: 'array', src: ["ë¹¨ê°„ìƒ‰", "íŒŒë€ìƒ‰", "ê²€ì€ìƒ‰", "ë…¸ë€ìƒ‰"] },
                    { q: "ì–´ë””ì„œ ì£¼ì› ë‚˜ìš”?", a: place, t: 'array', src: ["ìš´ë™ì¥", "ê¸‰ì‹ì‹¤", "ë„ì„œê´€", "í™”ì¥ì‹¤"] },
                    { q: "ì£¼ì¸ì˜ í•™ë…„ê³¼ ë°˜ì€?", a: `${grade}í•™ë…„ ${classNum}ë°˜`, t: 'text_num' }, 
                    { q: "ì§€ê¸ˆ ì–´ë””ì— ë³´ê´€ ì¤‘ì¸ê°€ìš”?", a: currentStorage, t: 'array', src: storageList },
                    { q: "ì—°ë½í•´ì•¼ í•  í•™ìƒ ì´ë¦„ì€?", a: owner, t: 'array', src: R_DATA.names }
                ];
                const q = getRand(qPool);
                
                if(q.q.includes("í•™ë…„")) {
                     let oSet = new Set([q.a]);
                     let loop = 0;
                     while(oSet.size < 4 && loop < 50) { 
                         oSet.add(`${getRandomInt(1,6)}í•™ë…„ ${getRandomInt(1,5)}ë°˜`);
                         loop++;
                     }
                     while(oSet.size < 4) oSet.add(`${getRandomInt(1,6)}í•™ë…„ ${getRandomInt(6,9)}ë°˜`);
                     options = shuffleArray(Array.from(oSet));
                } else {
                    options = getDistractors(q.a, q.t, q.src);
                }
                answer = q.a; qList = q.q;
            }

            // --- ì‹œë‚˜ë¦¬ì˜¤ 5: ë³‘ì› ì•ˆë‚´ ---
            else if (scenarioType === 5) {
                const hName = getRand(["í–‰ë³µ", "ì‚¬ë‘", "íŠ¼íŠ¼", "ì„œìš¸", "ìš°ë¦¬", "ê±´ê°•", "ì†Œë§", "ë°”ë¥¸"]);
                const type = getRand(["ë‚´ê³¼", "ì†Œì•„ê³¼", "ì´ë¹„ì¸í›„ê³¼", "ì¹˜ê³¼", "ì•ˆê³¼", "ê°€ì •ì˜í•™ê³¼"]);
                const fullName = hName + type;
                
                const openTime = getRandTime(8, 10); 
                const closeTime = getRandTime(17, 19); 
                const satClose = "13:00"; 
                
                const lunchStart = getRand(["12:30", "13:00"]);
                const lunchEnd = lunchStart === "12:30" ? "13:30" : "14:00";
                
                const closedDay = getRand(["ì¼ìš”ì¼", "ì¼ìš”ì¼/ê³µíœ´ì¼", "ìˆ˜ìš”ì¼", "ëª©ìš”ì¼"]);

                title = `${fullName} ì§„ë£Œ ì•ˆë‚´`;
                content = `
                    <div class="text-left bg-white p-4 rounded border border-green-200 shadow-sm">
                        <p class="text-xl font-bold mb-4 text-green-600 text-center">${fullName}</p>
                        <ul class="space-y-2 text-sm text-gray-700">
                            <li><span class="font-bold">í‰ì¼:</span> ${openTime} ~ ${closeTime}</li>
                            <li><span class="font-bold">ì ì‹¬ì‹œê°„:</span> ${lunchStart} ~ ${lunchEnd}</li>
                            <li><span class="font-bold">í† ìš”ì¼:</span> ${openTime} ~ ${satClose}</li>
                            <li><span class="text-red-500 font-bold">íœ´ì§„:</span> ${closedDay}</li>
                        </ul>
                    </div>`;

                const qPool = [
                    { q: "ë³‘ì›ì˜ ì´ë¦„ì€ ë¬´ì—‡ì¸ê°€ìš”?", a: fullName, t: 'array', src: [hName+"ë‚´ê³¼", hName+"ì†Œì•„ê³¼", "ì‚¬ë‘"+type, "í–‰ë³µ"+type] },
                    { q: "ì ì‹¬ì‹œê°„ì€ ì–¸ì œ ì‹œì‘í•˜ë‚˜ìš”?", a: lunchStart, t: 'time' },
                    { q: "í† ìš”ì¼ì€ ëª‡ ì‹œê¹Œì§€ ì§„ë£Œí•˜ë‚˜ìš”?", a: satClose, t: 'time' },
                    { q: "í‰ì¼ ì§„ë£Œê°€ ëë‚˜ëŠ” ì‹œê°„ì€?", a: closeTime, t: 'time' },
                    { q: "ë³‘ì›ì´ ì‰¬ëŠ” ë‚ (íœ´ì§„)ì€?", a: closedDay, t: 'array', src: ["í† ìš”ì¼", "ì›”ìš”ì¼", "ê¸ˆìš”ì¼"] },
                    { q: "ì§„ë£Œë¥¼ ì‹œì‘í•˜ëŠ” ì‹œê°„ì€?", a: openTime, t: 'time' }
                ];
                const q = getRand(qPool);
                options = getDistractors(q.a, q.t, q.src);
                answer = q.a; qList = q.q;
            }

            return {
                problem: qList,
                answer: answer,
                options: options,
                readingData: { title: title, content: content } 
            };
        }

        // [3-2] ì•ˆë‚´ë¬¸ ë…í•´ (ì‹¬í™”) - Code 2 generateReadingQuizHard() ì´ì‹
        // Code 2ì˜ ëª¨ë“  ì„œìˆ í˜•/ì‹¬í™” ì‹œë‚˜ë¦¬ì˜¤(0~9) í¬í•¨
        function generateReadingQuizHard() {
            const makeDate = () => `${getRandomInt(3, 11)}ì›” ${getRandomInt(1, 28)}ì¼`;
            const formatTime = (hour) => {
                if (hour < 12) return `ì˜¤ì „ ${hour}ì‹œ`;
                if (hour === 12) return `ì˜¤í›„ 12ì‹œ`;
                return `ì˜¤í›„ ${hour - 12}ì‹œ`;
            };

            const DB = {
                names: ["ê¹€ì² ìˆ˜", "ìœ¤ì§€í˜¸", "ë°•ë¯¼ì¤€", "ìµœë³‘ìš©", "ê¹€ë¯¼ì§€", "í—ˆì°¬", "ë°•ì§€í›ˆ", "ì¥ì˜ì¬", "ì´ì€ì£¼", "ìœ¤ì¤€ì˜"],
                places_play: ["ìš°ë¦¬ ì§‘ ê±°ì‹¤", "ë°©ë°© ë†€ì´í„°", "í•™êµ ì• ë¶„ì‹ì§‘", "ë™ë„¤ ì¹˜í‚¨ì§‘"],
                places_public: ["ì‹œë¯¼ê³µì› ë¶„ìˆ˜ëŒ€", "ì¤‘ì•™ë„ì„œê´€", "êµ­ë¦½ê³¼í•™ê´€", "ì‹œë¦½ë¯¸ìˆ ê´€"],
                foods: ["ì½¤ë¹„ë„¤ì´ì…˜ í”¼ì", "ìˆœì‚´ ì–‘ë… ì¹˜í‚¨", "ë–¡ë³¶ì´ì™€ íŠ€ê¹€", "í–„ë²„ê±° ì„¸íŠ¸"],
                items: ["ì–¼ìŒë¬¼", "ëª¨ì", "ë—ìë¦¬", "ìš°ì‚°", "ì¥ê°‘", "ë§ˆìŠ¤í¬"],
                weekdays: ["ì›”ìš”ì¼", "í™”ìš”ì¼", "ìˆ˜ìš”ì¼", "ëª©ìš”ì¼", "ê¸ˆìš”ì¼", "í† ìš”ì¼", "ì¼ìš”ì¼"],
                phones: [`010-${getRandomInt(2000, 9999)}-${getRandomInt(2000, 9999)}`]
            };

            const type = getRandomInt(0, 9);
            let title, content, qPool, answer, options;

            // --- ì‹œë‚˜ë¦¬ì˜¤ 0: ìƒì¼ ì´ˆëŒ€ì¥ ---
            if (type === 0) {
                const host = getRand(DB.names);
                const date = makeDate();
                const hour = getRandomInt(13, 17);
                const timeStr = formatTime(hour);
                const place = getRand(DB.places_play);
                const food = getRand(DB.foods);
                
                title = "ğŸ’Œ ë‚´ ìƒì¼ íŒŒí‹°ì— ì´ˆëŒ€í•´!";
                content = `
                    <div>
                        ì•ˆë…•, ì¹œêµ¬ë“¤ì•„! ë‚˜ <strong>${host}</strong>(ì´)ì•¼.<br>
                        ë“œë””ì–´ ê¸°ë‹¤ë¦¬ë˜ ë‚´ ìƒì¼ì´ ë‹¤ê°€ì™”ì–´! ê·¸ë˜ì„œ ì´ë²ˆì— ë„ˆí¬ë‘ ê°™ì´ ë§›ìˆëŠ” ê²ƒë„ ë¨¹ê³  ì‹ ë‚˜ê²Œ ë†€ê³  ì‹¶ì–´ì„œ ì´ˆëŒ€ì¥ì„ ë³´ë‚´.<br>
                        ë‚ ì§œëŠ” <strong>${date}</strong>ì´ê³ , ì‹œê°„ì€ <strong>${timeStr}</strong>ì— ë§Œë‚˜ê¸°ë¡œ í•˜ì.<br><br>
                        ì¥ì†ŒëŠ” ìš°ë¦¬ë¼ë¦¬ ë†€ê¸° ë”± ì¢‹ì€ <strong>${place}</strong>(ìœ¼)ë¡œ ì •í–ˆì–´.<br>
                        ë‚´ê°€ ìš©ëˆì„ ëª¨ì•„ì„œ ë„ˆí¬ê°€ ì¢‹ì•„í•˜ëŠ” <strong>${food}</strong>(ì„)ë¥¼ ë§ì´ ì‹œì¼œì¤„ê²Œ.<br>
                        ê·¸ë¦¬ê³  ì •ë§ ì¤‘ìš”í•œ ê±´ë°, <strong>ì„ ë¬¼ì€ ì§„ì§œ ì•ˆ ê°€ì ¸ì™€ë„ ë¼.</strong> ê·¸ëƒ¥ ëª¸ë§Œ ì™€ì„œ ì¶•í•˜í•´ ì¤˜! ê¼­ ì™€ì•¼ í•´!
                    </div>`;
                
                qPool = [
                    { q: "í¸ì§€ë¥¼ ì“´ ì£¼ì¸ê³µ(ìƒì¼ì¸ ì‚¬ëŒ)ì€?", a: host, t: 'array', src: DB.names },
                    { q: "ì¹œêµ¬ë“¤ì´ ë§Œë‚˜ëŠ” ë‚ ì§œëŠ”?", a: date, t: 'date' }, 
                    { q: "ì•½ì† ì‹œê°„ì€ ì–¸ì œì¸ê°€ìš”?", a: timeStr, t: 'time' },
                    { q: "íŒŒí‹°ë¥¼ í•˜ê¸°ë¡œ í•œ ì¥ì†ŒëŠ”?", a: place, t: 'array', src: DB.places_play },
                    { q: "ì£¼ì¸ê³µì´ ì¤€ë¹„í•œ ìŒì‹ì€?", a: food, t: 'array', src: DB.foods },
                    { q: "ì£¼ì¸ê³µì´ ì¹œêµ¬ë“¤ì—ê²Œ ë¶€íƒí•œ ë‚´ìš©ì€?", a: "ì„ ë¬¼ ê°€ì ¸ì˜¤ì§€ ì•Šê¸°", t: 'array', src: ["ì„ ë¬¼ ê¼­ ì‚¬ì˜¤ê¸°", "ì„ ë¬¼ ê°€ì ¸ì˜¤ì§€ ì•Šê¸°", "íšŒë¹„ ê±·ê¸°", "ë™ìƒ ë°ë ¤ì˜¤ê¸°"] }
                ];
            }

            // --- ì‹œë‚˜ë¦¬ì˜¤ 1: ì•„íŒŒíŠ¸ ì•ˆë‚´ë°©ì†¡ ---
            else if (type === 1) {
                const date = makeDate();
                const startH = getRandomInt(9, 10);
                const duration = getRandomInt(3, 5);
                const endH = startH + duration;
                const startT = formatTime(startH);
                const endT = formatTime(endH);
                const reason = getRand(["ì •ê¸° ì•ˆì „ ì ê²€", "ë…¸í›„ ë¶€í’ˆ êµì²´", "ìŠ¹ê°•ê¸° ë°”ë‹¥ ì²­ì†Œ", "ë¹„ìƒ ë²¨ ì ê²€"]);
                
                title = "ğŸ“¢ ìŠ¹ê°•ê¸° ìš´í–‰ ì •ì§€ ì•ˆë‚´";
                content = `
                    <div>
                        [ê´€ë¦¬ì‚¬ë¬´ì†Œ] ì£¼ë¯¼ ì—¬ëŸ¬ë¶„ ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ.<br>
                        ì…ì£¼ë¯¼ ì—¬ëŸ¬ë¶„ì˜ ì•ˆì „ì„ ìœ„í•´ ì˜¤ëŠ” <strong>${date}</strong>ì— ìŠ¹ê°•ê¸° <strong>${reason}</strong>ì„ ì‹¤ì‹œí•  ì˜ˆì •ì…ë‹ˆë‹¤.<br><br>
                        ì‘ì—… ì‹œê°„ì€ <strong>${startT}</strong>ë¶€í„° <strong>${endT}</strong>ê¹Œì§€ì´ë©°, ì•½ <strong>${duration}ì‹œê°„</strong> ë™ì•ˆ ì§„í–‰ë©ë‹ˆë‹¤.<br>
                        ì´ ì‹œê°„ ë™ì•ˆì€ ìŠ¹ê°•ê¸° ìš´í–‰ì´ ì™„ì „íˆ ë©ˆì¶”ê²Œ ë˜ë‹ˆ, ì™¸ì¶œ ê³„íšì´ ìˆìœ¼ì‹  ë¶„ë“¤ì€ ë¯¸ë¦¬ ì¤€ë¹„í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.<br>
                        ë¶ˆí¸í•˜ì‹œë”ë¼ë„ ì•ˆì „ì„ ìœ„í•´ <strong>ë¹„ìƒ ê³„ë‹¨</strong>ì„ ì´ìš©í•´ ì£¼ì‹œë©´ ê°ì‚¬í•˜ê² ìŠµë‹ˆë‹¤.
                    </div>`;

                qPool = [
                    { q: "ì ê²€ì„ ì‹¤ì‹œí•˜ëŠ” ë‚ ì§œëŠ”?", a: date, t: 'date' },
                    { q: "ì ê²€ì´ ëë‚˜ëŠ” ì‹œê°„ì€?", a: endT, t: 'time' },
                    { q: "ìŠ¹ê°•ê¸° ì ê²€ì„ í•˜ëŠ” ì´ìœ ëŠ”?", a: reason, t: 'array', src: ["ì •ê¸° ì•ˆì „ ì ê²€", "ë…¸í›„ ë¶€í’ˆ êµì²´", "ëŒ€ì²­ì†Œ", "í˜ì¸íŠ¸ ì¹ "] },
                    { q: "ìš´í–‰ ì¤‘ë‹¨ ì‹œ ì´ìš©í•´ì•¼ í•  ìˆ˜ë‹¨ì€?", a: "ë¹„ìƒ ê³„ë‹¨", t: 'array', src: ["í™”ë¬¼ìš© ìŠ¹ê°•ê¸°", "ë¹„ìƒ ê³„ë‹¨", "ì˜† ë™ ìŠ¹ê°•ê¸°", "ì˜¥ìƒ ì‚¬ë‹¤ë¦¬"] },
                    { q: "ì´ ê³µì‚¬(ì ê²€) ì‹œê°„ì€ ëª‡ ì‹œê°„ì¸ê°€ìš”?", a: duration+"ì‹œê°„", t: 'text_num' }
                ];
            }

            // --- ì‹œë‚˜ë¦¬ì˜¤ 2: í•™êµ ê¸‰ì‹ ì•Œë¦¼ ---
            else if (type === 2) {
                const mainList = ["ì†Œê³ ê¸° ë¶ˆê³ ê¸°ë®ë°¥", "ì¹˜í‚¨ë§ˆìš” ë®ë°¥", "ê¹€ì¹˜ë³¶ìŒë°¥", "ì”ì¹˜êµ­ìˆ˜"];
                const soupList = ["ë“¤ê¹¨ ë¯¸ì—­êµ­", "ì–¼í°í•œ ì½©ë‚˜ë¬¼êµ­", "ì‹œê¸ˆì¹˜ ëœì¥êµ­", "ì–´ë¬µíƒ•"];
                const dessertList = ["ë”¸ê¸° ìš”ê±°íŠ¸", "ì¡°ê° ì‚¬ê³¼", "ì»¤ìŠ¤í„°ë“œ í‘¸ë”©", "ì•„ì´ìŠ¤í¬ë¦¼"];

                const day = getRand(DB.weekdays);
                const main = getRand(mainList);
                const soup = getRand(soupList);
                const dessert = getRand(dessertList);
                
                title = "ğŸ± 12ì›”ì˜ ë§›ìˆëŠ” ê¸‰ì‹";
                content = `
                    <div>
                        [í•™êµ ì•Œë¦¼] í•™ë¶€ëª¨ë‹˜, ê°€ì •ì— ëŠ˜ í–‰ë³µì´ ê°€ë“í•˜ì‹œê¸¸ ë°”ëë‹ˆë‹¤.<br>
                        ìš°ë¦¬ í•™êµ ê¸‰ì‹ì‹¤ì—ì„œëŠ” í•™ìƒë“¤ì˜ ê±´ê°•ì„ ìœ„í•´ ë§¤ì¼ ì‹ ì„ í•œ ì¬ë£Œë¡œ ì •ì„±ì„ ë‹¤í•´ ìŒì‹ì„ ë§Œë“¤ê³  ìˆìŠµë‹ˆë‹¤.<br>
                        ëŒì•„ì˜¤ëŠ” <strong>${day}</strong>ì˜ ì ì‹¬ ì‹ë‹¨ì„ ë¯¸ë¦¬ ì•ˆë‚´í•´ ë“œë¦½ë‹ˆë‹¤.<br><br>
                        ì´ë‚ ì˜ ì£¼ë©”ë‰´ëŠ” ì•„ì´ë“¤ì´ ì¢‹ì•„í•˜ëŠ” <strong>${main}</strong>ì´ë©°, êµ­ìœ¼ë¡œëŠ” ë”°ëœ»í•œ <strong>${soup}</strong>ì´(ê°€) ì¤€ë¹„ë©ë‹ˆë‹¤.<br>
                        ì‹ì‚¬ í›„ì—ëŠ” ì…ê°€ì‹¬ì„ ìœ„í•´ ë‹¬ì½¤í•œ <strong>${dessert}</strong>ê¹Œì§€ ì œê³µë  ì˜ˆì •ì´ë‹ˆ, ì•Œë ˆë¥´ê¸°ê°€ ìˆëŠ” í•™ìƒì€ ë¯¸ë¦¬ ë‹´ì„ ì„ ìƒë‹˜ê»˜ ë§ì”€í•´ ì£¼ì„¸ìš”.
                    </div>`;

                qPool = [
                    { q: "ê¸‰ì‹ì´ ì œê³µë˜ëŠ” ìš”ì¼ì€?", a: day, t: 'array', src: DB.weekdays },
                    { q: "ì´ë‚ ì˜ ë©”ì¸ ìš”ë¦¬(ì£¼ë©”ë‰´)ëŠ”?", a: main, t: 'array', src: mainList },
                    { q: "í•¨ê»˜ ë‚˜ì˜¤ëŠ” êµ­ì˜ ì¢…ë¥˜ëŠ”?", a: soup, t: 'array', src: soupList },
                    { q: "ì‹ì‚¬ í›„ì— ë¨¹ëŠ” í›„ì‹ì€?", a: dessert, t: 'array', src: dessertList }
                ];
            }

            // --- ì‹œë‚˜ë¦¬ì˜¤ 3: ë„ì„œê´€ ì—°ì²´ ë¬¸ì ---
            else if (type === 3) {
                const bookList = ["í•´ë¦¬í¬í„°ì™€ ë§ˆë²•ì‚¬ì˜ ëŒ", "Why? ìš°ì£¼ì™€ ë¡œì¼“", "í”í•œë‚¨ë§¤ì˜ ì¼ìƒ", "ê·¸ë¦¬ìŠ¤ë¡œë§ˆì‹ í™”"];
                const book = getRand(bookList);
                const retDate = makeDate();
                const fee = getRandomInt(2, 8) * 100;
                
                title = "ğŸ“š ë„ì„œ ë°˜ë‚© ì•ˆë‚´";
                content = `
                    <div>
                        [ë„ì„œê´€ ì•Œë¦¼í†¡] íšŒì›ë‹˜ê»˜ì„œ ë¹Œë ¤ê°€ì‹  ì±… <strong>ã€${book}ã€</strong>ì˜ ë°˜ë‚© ê¸°ê°„ì´ ì§€ë‚¬ìŠµë‹ˆë‹¤.<br>
                        ì›ë˜ëŒ€ë¡œë¼ë©´ <strong>${retDate}</strong>ê¹Œì§€ ë°˜ë‚©í•´ì£¼ì…¨ì–´ì•¼ í•˜ëŠ”ë° ì•„ì§ í™•ì¸ë˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤.<br>
                        ì§€ê¸ˆ ì´ ì±…ì„ ë³´ê³  ì‹¶ì–´ì„œ ê¸°ë‹¤ë¦¬ëŠ” ë‹¤ë¥¸ ì¹œêµ¬ë“¤ì´ ë§ì´ ìˆìŠµë‹ˆë‹¤.<br><br>
                        ì˜¤ëŠ˜ê¹Œì§€ ê³„ì‚°ëœ ì—°ì²´ë£ŒëŠ” <strong>${fee}ì›</strong>ì…ë‹ˆë‹¤.<br>
                        ë‚´ì¼ê¹Œì§€ ê¼­ ë„ì„œê´€ <strong>1ì¸µ ì•ˆë‚´ë°ìŠ¤í¬</strong>ë¡œ ì˜¤ì…”ì„œ ì±…ì„ ëŒë ¤ì£¼ì‹œê³  ì—°ì²´ë£Œë„ ë‚´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.
                    </div>`;

                qPool = [
                    { q: "ëŒë ¤ì£¼ì§€ ì•Šì€ ì±…ì˜ ì œëª©ì€?", a: book, t: 'array', src: bookList },
                    { q: "ì›ë˜ ì±…ì„ ë°˜ë‚©í–ˆì–´ì•¼ í•  ë‚ ì§œëŠ”?", a: retDate, t: 'date' },
                    { q: "ì§€ê¸ˆê¹Œì§€ ë°€ë¦° ì—°ì²´ë£ŒëŠ” ì–¼ë§ˆ?", a: fee+"ì›", t: 'text_num' },
                    { q: "ì±…ì„ ë°˜ë‚©í•´ì•¼ í•˜ëŠ” ì¥ì†ŒëŠ”?", a: "1ì¸µ ì•ˆë‚´ë°ìŠ¤í¬", t: 'array', src: ["1ì¸µ ì•ˆë‚´ë°ìŠ¤í¬", "2ì¸µ ì—´ëŒì‹¤", "ê²½ë¹„ì‹¤", "êµë¬´ì‹¤"] }
                ];
            }

            // --- ì‹œë‚˜ë¦¬ì˜¤ 4: ë°©ê³¼í›„ ìˆ˜ì—… ë³€ê²½ ---
            else if (type === 4) {
                const classList = ["ì¶•êµ¬ êµì‹¤", "ë¯¸ìˆ ë°˜", "ë¡œë´‡ ê³¼í•™", "ìš”ë¦¬ êµì‹¤", "ìŒì•… ì¤„ë„˜ê¸°"];
                const placeList = ["ê°•ë‹¹", "ìŒì•…ì‹¤", "ê³¼í•™ì‹¤", "ê°€ì‚¬ì‹¤", "ìš´ë™ì¥"];
                
                const className = getRand(classList);
                const teacher = getRand(DB.names);
                const newRoom = getRand(placeList);
                
                title = "ğŸ« ìˆ˜ì—… ì¥ì†Œ ë³€ê²½ ì•ˆë‚´";
                content = `
                    <div>
                        ì•ˆë…•í•˜ì„¸ìš”. <strong>${className}</strong> ìˆ˜ì—…ì„ ê°€ë¥´ì¹˜ëŠ” <strong>${teacher}</strong> ì„ ìƒë‹˜ì…ë‹ˆë‹¤.<br>
                        ì˜¤ëŠ˜ ìš°ë¦¬ê°€ ìˆ˜ì—…í•˜ë ¤ë˜ êµì‹¤ ì²œì¥ì— ê°‘ìê¸° ë¬¼ì´ ìƒˆëŠ” ë°”ëŒì— ê¸´ê¸‰ ê³µì‚¬ë¥¼ í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.<br><br>
                        ê·¸ë˜ì„œ ì˜¤ëŠ˜ í•˜ë£¨ë§Œ ìˆ˜ì—… ì¥ì†Œë¥¼ ë°”ê¿”ì•¼ í•  ê²ƒ ê°™ì•„ìš”.<br>
                        í•™ìƒë“¤ì€ í‰ì†Œ ê°€ë˜ êµì‹¤ë¡œ ê°€ì§€ ë§ê³  <strong>${newRoom}</strong>(ìœ¼)ë¡œ ë°”ë¡œ ì™€ì£¼ì„¸ìš”.<br>
                        ìˆ˜ì—… ì‹œê°„ì€ ë°”ë€Œì§€ ì•Šê³  ê·¸ëŒ€ë¡œë‹ˆê¹Œ ëŠ¦ì§€ ì•Šê²Œ ì™€ì£¼ì„¸ìš”. ë¶ˆí¸ì„ ì¤˜ì„œ ë¯¸ì•ˆí•´ìš”!
                    </div>`;

                qPool = [
                    { q: "ì–´ë–¤ ìˆ˜ì—…ì— ëŒ€í•œ ì•ˆë‚´ì¸ê°€ìš”?", a: className, t: 'array', src: classList },
                    { q: "ì„ ìƒë‹˜ì˜ ì´ë¦„ì€?", a: teacher, t: 'array', src: DB.names },
                    { q: "ë³€ê²½ëœ ìˆ˜ì—… ì¥ì†ŒëŠ” ì–´ë””ì¸ê°€ìš”?", a: newRoom, t: 'array', src: placeList }
                ];
            }

            // --- ì‹œë‚˜ë¦¬ì˜¤ 5: ì¼ê¸° ì˜ˆë³´ ---
            else if (type === 5) {
                const weatherList = ["ë§‘ìŒ", "íë¦¼", "ë¹„", "ëˆˆ"];
                const weather = getRand(weatherList);
                const temp = getRandomInt(20, 32);
                const item = weather === "ë¹„" ? "ìš°ì‚°" : (weather === "ëˆˆ" ? "ì¥ê°‘" : (weather === "ë§‘ìŒ" ? "ëª¨ì" : "ê²‰ì˜·"));
                const humidity = getRandomInt(40, 80);
                
                title = "ğŸŒ¤ ì˜¤ëŠ˜ì˜ ë‚ ì”¨";
                content = `
                    <div>
                        ì—¬ëŸ¬ë¶„ ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ, ê¸°ìƒ ìºìŠ¤í„°ì…ë‹ˆë‹¤.<br>
                        ì˜¤ëŠ˜ ìš°ë¦¬ ì§€ì—­ì˜ ë‚ ì”¨ë¥¼ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.<br>
                        í˜„ì¬ êµ¬ë¦„ì˜ ì˜í–¥ìœ¼ë¡œ ì˜¤ëŠ˜ í•˜ë£¨ëŠ” <strong>${weather}</strong> ìƒíƒœê°€ ê³„ì†ë  ê²ƒìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.<br>
                        ìŠµë„ëŠ” ${humidity}% ì •ë„ì´ë©°, ë‚® ìµœê³  ê¸°ì˜¨ì€ <strong>${temp}ë„</strong>ê¹Œì§€ ì˜¬ë¼ê°€ê² ìŠµë‹ˆë‹¤.<br><br>
                        ì•„ì¹¨ì €ë…ìœ¼ë¡œ ê¸°ì˜¨ ì°¨ì´ê°€ í¬ë‹ˆ ì™¸ì¶œí•˜ì‹¤ ë•ŒëŠ” <strong>${item}</strong>ì„(ë¥¼) ì±™ê¸°ì‹œëŠ” ê²Œ ì¢‹ê² ìŠµë‹ˆë‹¤.<br>
                        ê±´ê°• ê´€ë¦¬ì— ìœ ì˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
                    </div>`;

                qPool = [
                    { q: "ì˜¤ëŠ˜ì˜ ë‚ ì”¨ ìƒíƒœëŠ”?", a: weather, t: 'array', src: weatherList },
                    { q: "ë‚® ìµœê³  ê¸°ì˜¨ì€ ëª‡ ë„ì¸ê°€ìš”?", a: temp+"ë„", t: 'text_num' },
                    { q: "ì™¸ì¶œ ì‹œ ì±™ê²¨ì•¼ í•  ë¬¼ê±´ì€?", a: item, t: 'array', src: DB.items }
                ];
            }

            // --- ì‹œë‚˜ë¦¬ì˜¤ 6: ìš”ë¦¬ ë ˆì‹œí”¼ ---
            else if (type === 6) {
                const water = getRandomInt(450, 600);
                const time = getRandomInt(3, 5);
                const addList = ["ëŒ€íŒŒ", "ê³„ë€", "ì¹˜ì¦ˆ", "ë–¡", "ë§Œë‘"];
                const add = getRand(addList); 

                title = "ğŸœ ë§›ìˆëŠ” ë¼ë©´ ë“ì´ê¸°";
                content = `
                    <div>
                        ì§‘ì—ì„œë„ ë¶„ì‹ì§‘ì²˜ëŸ¼ ë§›ìˆëŠ” ë¼ë©´ì„ ë“ì´ëŠ” ë°©ë²•ì„ ì•Œë ¤ë“œë¦´ê²Œìš”.<br>
                        ê°€ì¥ ì¤‘ìš”í•œ ê±´ ë¬¼ì˜ ì–‘ì¸ë°ìš”, ëƒ„ë¹„ì— ë¬¼ <strong>${water}ml</strong>ë¥¼ ì •í™•í•˜ê²Œ ë„£ê³  ì„¼ ë¶ˆë¡œ ë“ì—¬ì£¼ì„¸ìš”.<br><br>
                        ë¬¼ì´ ë³´ê¸€ë³´ê¸€ ë“ìœ¼ë©´ ë©´ê³¼ ìŠ¤í”„ë¥¼ ë„£ê³  <strong>${time}ë¶„</strong> ë™ì•ˆ ë” ë“ì—¬ì•¼ ë©´ì´ ì«„ê¹ƒí•´ì§‘ë‹ˆë‹¤.<br>
                        ë§ˆì§€ë§‰ìœ¼ë¡œ ë¶ˆì„ ë„ê¸° ì§ì „ì— <strong>${add}</strong>ì„(ë¥¼) ë„£ìœ¼ë©´ êµ­ë¬¼ ë§›ì´ í›¨ì”¬ ì¢‹ì•„ì§„ë‹µë‹ˆë‹¤.<br>
                        ì˜¤ëŠ˜ ì ì‹¬ìœ¼ë¡œ ë”°ëœ»í•œ ë¼ë©´ í•œ ê·¸ë¦‡ ì–´ë– ì„¸ìš”?
                    </div>`;

                qPool = [
                    { q: "ë¬¼ì˜ ì–‘ì€ ì–¼ë§ˆë¥¼ ë„£ì–´ì•¼ í•˜ë‚˜ìš”?", a: water+"ml", t: 'text_num' },
                    { q: "ë©´ì„ ë„£ê³  ëª‡ ë¶„ê°„ ë“ì—¬ì•¼ í•˜ë‚˜ìš”?", a: time+"ë¶„", t: 'text_num' },
                    { q: "ë§ˆì§€ë§‰ì— ë„£ëŠ” ì¬ë£ŒëŠ”?", a: add, t: 'array', src: addList }
                ];
            }

            // --- ì‹œë‚˜ë¦¬ì˜¤ 7: ê°•ì•„ì§€ ì°¾ê¸° ---
            else if (type === 7) {
                const dogList = ["ë½€ì‚", "ì´ˆì½”", "ë‘ë¶€", "í•˜ëŠ˜ì´"];
                const breedList = ["ë§í‹°ì¦ˆ", "í‘¸ë“¤", "ì‹œë°”ê²¬", "ë¦¬íŠ¸ë¦¬ë²„"];
                const colorList = ["í•˜ì–€ìƒ‰", "ê°ˆìƒ‰", "ê²€ì€ìƒ‰", "ëˆ„ëŸ°ìƒ‰"];
                
                const dogName = getRand(dogList);
                const breed = getRand(breedList);
                const color = getRand(colorList);
                const contact = DB.phones[0];
                const location = getRand(DB.places_public);

                title = "ğŸ• ê°•ì•„ì§€ë¥¼ ì°¾ì•„ì£¼ì„¸ìš”";
                content = `
                    <div>
                        ì†Œì¤‘í•œ ì €í¬ ì§‘ ê°•ì•„ì§€ë¥¼ ìƒì–´ë²„ë ¤ì„œ ì°¾ê³  ìˆìŠµë‹ˆë‹¤.<br>
                        ì´ë¦„ì€ <strong>${dogName}</strong>ì´ê³ , <strong>${breed}</strong>ì´ë©° í„¸ ìƒ‰ê¹”ì€ <strong>${color}</strong>ì…ë‹ˆë‹¤.<br><br> 
                        ì§€ë‚œì£¼ì— <strong>${location}</strong> ê·¼ì²˜ì—ì„œ ì‚°ì±…ì„ í•˜ë‹¤ê°€ ê·¸ë§Œ ë†“ì¹˜ê³  ë§ì•˜ìŠµë‹ˆë‹¤.<br>
                        ì‚¬ëŒì„ ì•„ì£¼ ì˜ ë”°ë¥´ê³  ìˆœí•œ ì„±ê²©ì…ë‹ˆë‹¤.<br>
                        ë³´í˜¸í•˜ê³  ê³„ì‹œê±°ë‚˜ ë¹„ìŠ·í•œ ê°•ì•„ì§€ë¥¼ ë³´ì‹  ë¶„ì€ <strong>${contact}</strong>(ìœ¼)ë¡œ ê¼­ ì—°ë½ ë¶€íƒë“œë¦½ë‹ˆë‹¤.<br>
                        ì‚¬ë¡€í•˜ê² ìŠµë‹ˆë‹¤.
                    </div>`;

                qPool = [
                    { q: "ìƒì–´ë²„ë¦° ê°•ì•„ì§€ì˜ ì´ë¦„ì€?", a: dogName, t: 'array', src: dogList },
                    { q: "ê°•ì•„ì§€ì˜ ì¢…ë¥˜(ê²¬ì¢…)ëŠ”?", a: breed, t: 'array', src: breedList },
                    { q: "ê°•ì•„ì§€ì˜ í„¸ ìƒ‰ê¹”ì€?", a: color, t: 'array', src: colorList },
                    { q: "ì£¼ì¸ì˜ ì—°ë½ì²˜ ë’·ìë¦¬ëŠ”?", a: contact.split('-')[2], t: 'text_num' }
                ];
            }

            // --- ì‹œë‚˜ë¦¬ì˜¤ 8: ë°•ë¬¼ê´€ ì„¤ëª… ---
            else if (type === 8) {
                const relicList = ["ê¸ˆê´€", "ì²­ì", "ë™ê²€", "í† ê¸°"];
                const eraList = ["ì‹ ë¼", "ê³ ë ¤", "ì¡°ì„ ", "ê³ êµ¬ë ¤"];
                const usageList = ["ì œì‚¬", "ì „ìŸ", "ì €ì¥", "ì¥ì‹"];
                
                const relic = getRand(relicList);
                const era = getRand(eraList);
                const usage = getRand(usageList);

                title = "ğŸ› ìœ ë¬¼ ì„¤ëª…";
                content = `
                    <div>
                        ê´€ëŒê° ì—¬ëŸ¬ë¶„, ì´ ìœ ë¬¼ì„ ë´ì£¼ì„¸ìš”. ìš°ë¦¬ ì—­ì‚¬ì—ì„œ ì•„ì£¼ ì¤‘ìš”í•œ ë³´ë¬¼ì…ë‹ˆë‹¤.<br>
                        ì´ê²ƒì€ ì˜›ë‚  <strong>${era}</strong> ì‹œëŒ€ì— ë§Œë“¤ì–´ì§„ <strong>${relic}</strong>ì…ë‹ˆë‹¤.<br>
                        ëª¨ì–‘ì´ ì•„ì£¼ ë…íŠ¹í•˜ê³  ì•„ë¦„ë‹µì§€ ì•Šë‚˜ìš”?<br><br>
                        ì—­ì‚¬í•™ìë“¤ì˜ ì—°êµ¬ì— ë”°ë¥´ë©´, ì˜›ë‚  ì‚¬ëŒë“¤ì€ ì´ê²ƒì„ ì£¼ë¡œ <strong>${usage}</strong>ì„(ë¥¼) í•  ë•Œ ì‚¬ìš©í–ˆë‹¤ê³  í•©ë‹ˆë‹¤.<br>
                        ì˜¤ë˜ëœ ë¬¼ê±´ì´ë¼ ê¹¨ì§€ê¸° ì‰¬ìš°ë‹ˆ ëˆˆìœ¼ë¡œë§Œ ë´ì£¼ì‹œê³  ì ˆëŒ€ ì†ìœ¼ë¡œ ë§Œì§€ì§€ ë§ˆì„¸ìš”.
                    </div>`;

                qPool = [
                    { q: "ì–´ëŠ ì‹œëŒ€ì˜ ìœ ë¬¼ì¸ê°€ìš”?", a: era, t: 'array', src: eraList },
                    { q: "ì „ì‹œëœ ìœ ë¬¼ì˜ ì´ë¦„ì€?", a: relic, t: 'array', src: relicList },
                    { q: "ì˜›ë‚ ì— ì–´ë–¤ ìš©ë„ë¡œ ì“°ì˜€ë‚˜ìš”?", a: usage, t: 'array', src: usageList }
                ];
            }
            
            // --- ì‹œë‚˜ë¦¬ì˜¤ 9: ì²´í—˜í•™ìŠµ ì•ˆë‚´ (ê°€ì •í†µì‹ ë¬¸ ìƒì„¸) ---
            else {
                const destList = ["ë†€ì´ê³µì›", "ë™ë¬¼ì›", "ì‹ë¬¼ì›", "ì—­ì‚¬ ë°•ë¬¼ê´€", "ë¯¼ì†ì´Œ"];
                const dest = getRand(destList);
                const day = getRand(DB.weekdays);
                const item = getRand(DB.items);
                const time = "ì˜¤ì „ 9ì‹œ";
                const busNum = getRandomInt(1, 5);

                title = "ğŸšŒ í˜„ì¥ì²´í—˜í•™ìŠµ ì•ˆë‚´";
                content = `
                    <div>
                        í•™ë¶€ëª¨ë‹˜ ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ? ìš°ë¦¬ í•™êµì—ì„œëŠ” í•™ìƒë“¤ì˜ ë‹¤ì–‘í•œ ê²½í—˜ì„ ìœ„í•´<br>
                        ì´ë²ˆ ì£¼ <strong>${day}</strong>ì— <strong>${dest}</strong>(ìœ¼)ë¡œ ì²´í—˜í•™ìŠµì„ ë– ë‚˜ê¸°ë¡œ í–ˆìŠµë‹ˆë‹¤.<br><br>
                        ì¶œë°œ ë‹¹ì¼ í•™ìƒë“¤ì€ ëŠ¦ì–´ë„ <strong>${time}</strong>ê¹Œì§€ í•™êµ ìš´ë™ì¥ìœ¼ë¡œ ëª¨ì—¬ì•¼ í•©ë‹ˆë‹¤.<br>
                        í™œë™í•˜ê¸° í¸í•œ ìš´ë™í™”ë¥¼ ì‹ ê³  ì˜¤ê²Œ í•´ì£¼ì‹œê³ , ê°œì¸ ì¤€ë¹„ë¬¼ë¡œëŠ” <strong>${item}</strong>ê³¼ ë§›ìˆëŠ” ì ì‹¬ ë„ì‹œë½ì„ ì±™ê²¨ì£¼ì„¸ìš”.<br>
                        ${busNum}í˜¸ì°¨ ë²„ìŠ¤ë¥¼ íƒ€ê³  ì•ˆì „í•˜ê³  ì¦ê²ê²Œ ë‹¤ë…€ì˜¤ê² ìŠµë‹ˆë‹¤.
                    </div>`;

                qPool = [
                    { q: "ì²´í—˜í•™ìŠµì„ ê°€ëŠ” ìš”ì¼ì€?", a: day, t: 'array', src: DB.weekdays },
                    { q: "ì–´ë””ë¡œ ê²¬í•™ì„ ê°€ë‚˜ìš”?", a: dest, t: 'array', src: destList },
                    { q: "ëª‡ ì‹œê¹Œì§€ ìš´ë™ì¥ìœ¼ë¡œ ëª¨ì—¬ì•¼ í•˜ë‚˜ìš”?", a: time, t: 'time' },
                    { q: "ê¼­ ì±™ê²¨ì•¼ í•  ì¤€ë¹„ë¬¼ì€?", a: item, t: 'array', src: DB.items }
                ];
            }

            // --- ê³µí†µ ì²˜ë¦¬ ---
            const q = getRand(qPool);
            answer = q.a;
            
            // [ë³´ê¸° ìƒì„± ë¡œì§]
            if (q.t === 'date') {
                let oSet = new Set([answer]);
                while(oSet.size < 4) oSet.add(makeDate());
                options = shuffleArray(Array.from(oSet));
            } 
            else if (q.t === 'text_num') { 
                let oSet = new Set([answer]);
                const numVal = parseInt(answer.replace(/[^0-9]/g, "")) || 0;
                const unit = answer.replace(/[0-9\-\.]/g, "");
                while(oSet.size < 4) {
                    let wrongNum = numVal + getRandomInt(-3, 3) * (numVal > 100 ? 100 : 1);
                    if(wrongNum <= 0) wrongNum = numVal + getRandomInt(1, 5);
                    if(wrongNum !== numVal) oSet.add(wrongNum + unit);
                    if(oSet.size < 4) oSet.add((numVal + oSet.size + 10) + unit);
                }
                options = shuffleArray(Array.from(oSet));
            } 
            else if (q.t === 'time') {
                let oSet = new Set([answer]);
                if (answer.includes('ì‹œ') && (answer.includes('ì˜¤ì „') || answer.includes('ì˜¤í›„'))) {
                    let hour = parseInt(answer.replace(/[^0-9]/g, ''));
                    const isAm = answer.includes('ì˜¤ì „');
                    while(oSet.size < 4) {
                        let wrongHour = hour + getRandomInt(-3, 3);
                        if (wrongHour <= 0) wrongHour += 12;
                        if (wrongHour > 12) wrongHour -= 12;
                        let wrongAm = Math.random() < 0.5 ? isAm : !isAm;
                        let wrongStr = (wrongAm ? 'ì˜¤ì „ ' : 'ì˜¤í›„ ') + wrongHour + 'ì‹œ';
                        if (wrongStr !== answer) oSet.add(wrongStr);
                        if (oSet.size < 4) oSet.add(`ì˜¤ì „ ${getRandomInt(1,12)}ì‹œ`);
                    }
                } 
                else if (answer.includes(':')) {
                     const [h, m] = answer.split(':').map(Number);
                     while(oSet.size < 4) {
                         let wrongH = (h + getRandomInt(-3, 3) + 24) % 24;
                         let wrongM = m; 
                         if(Math.random() < 0.3) wrongM = (m + 30) % 60;
                         let wrongStr = `${String(wrongH).padStart(2,'0')}:${String(wrongM).padStart(2,'0')}`;
                         if(wrongStr !== answer) oSet.add(wrongStr);
                     }
                }
                else {
                     while(oSet.size < 4) oSet.add(getRandomInt(1, 12) + "ì‹œ");
                }
                options = shuffleArray(Array.from(oSet));
            }
            else {
                let pool = q.src ? [...q.src] : [];
                let distractors = pool.filter(x => x !== answer);
                distractors = shuffleArray(distractors);
                let oSet = new Set([answer]);
                for (let d of distractors) {
                    if (oSet.size >= 4) break;
                    oSet.add(d);
                }
                const fillers = ["ì—†ìŒ", "ëª¨ë¦„", "í™•ì¸ ë¶ˆê°€", "ë¯¸ì •"];
                let fIdx = 0;
                while(oSet.size < 4) {
                    oSet.add(fillers[fIdx++ % fillers.length]);
                }
                options = shuffleArray(Array.from(oSet));
            }

            return {
                problem: q.q, // í…ìŠ¤íŠ¸ë§Œ ë¦¬í„´ (í™”ë©´ í‘œì‹œëŠ” nextLearningProblemì—ì„œ í•¨)
                answer: answer,
                options: options,
                readingData: { title: title, content: content } 
            };
        }

        // [3-3] íŒì—…ì— ë…í•´ ë‚´ìš© í‘œì‹œ (ê³µí†µ í•¨ìˆ˜)
        function renderReadingText(pid, data) {
            // ì´ í•¨ìˆ˜ëŠ” 1ë²ˆ ì½”ë“œ êµ¬ì¡°ì—ì„œëŠ” 'data-modal'ì„ ë„ìš¸ ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤.
            currentModalContent = `<div class="text-left"><h3 class="text-xl font-bold mb-4 border-b pb-2">${data.title}</h3><div class="reading-content-wrapper">${data.content}</div></div>`;
            showDataModal();
        }
   // ==========================================
        // [4] ë¬¸ì œ ìƒì„± ë¡œì§: ìˆ˜í•™ & ê¸°ì´ˆ í•™ìŠµ (Code 2 ì™„ë²½ ì´ì‹)
        // ==========================================

        // [4-1] ëˆ ê³„ì‚° í€´ì¦ˆ (Code 2: 7ê°€ì§€ ìœ í˜• - ê±°ìŠ¤ë¦„ëˆ, ì´ì•¡, ì”ì•¡, êµ¬ë§¤ê°€ëŠ¥, í•©ê³„, ë”ì¹˜í˜ì´, ì €ì¶•)
        function generateMoneyQuiz(depth=0) {
            if(depth > 10) return { problem: "ì˜¤ë¥˜", answer: 0, options: ["0","1","2","3"] }; 
            
            const items = ['ìš°ìœ ', 'ê³¼ì', 'ê»Œ', 'ê³µì±…', 'ì—°í•„', 'ì§€ìš°ê°œ', 'ìŒë£Œìˆ˜', 'ì•„ì´ìŠ¤í¬ë¦¼', 'ìƒŒë“œìœ„ì¹˜'];
            const prices = [500, 800, 300, 1000, 400, 200, 1200, 1500, 2500];
            
            // 0~6ê¹Œì§€ ìœ í˜• í™•ì¥ (5: ë”ì¹˜í˜ì´, 6: ì €ì¶•í•˜ê¸°)
            const type = getRandomInt(0, 6); 
            
            let p, a;
            let o = new Set();
            let unit = ""; // ë‹¨ìœ„ (ì›, ì£¼ ë“±)

            // [ìœ í˜• 0] ê±°ìŠ¤ë¦„ëˆ ê³„ì‚°
   // [ìœ í˜• 0] ê±°ìŠ¤ë¦„ëˆ ê³„ì‚°
            if (type === 0) { 
                const idx = getRandomInt(0, items.length-1);
                const item = items[idx];
                const price = prices[idx];
                const held = (Math.floor(Math.random() * 5) + 2) * 1000;
                if(held < price) return generateMoneyQuiz(depth+1);
                
                // [ìˆ˜ì •] ì„œìˆ í˜• ë³€ê²½
                p = `${held}ì›ì„ ë‚´ê³  ${price}ì›ì§œë¦¬ ${item} 1ê°œë¥¼ ìƒ€ìŠµë‹ˆë‹¤. ê±°ìŠ¤ë¦„ëˆì€ ì–¼ë§ˆì¸ê°€ìš”?`; 
                a = held - price;
                o.add(a); o.add(a+100); o.add(a-100); o.add(a+500);
            } 
            // [ìœ í˜• 1] ì´ ê°€ê²© (ë‹¨ìˆœ ê³±ì…ˆ)
            else if (type === 1) { 
                const idx = getRandomInt(0, items.length-1);
                const item = items[idx];
                const price = prices[idx];
                const cnt = getRandomInt(2, 6);
                
                // [ìˆ˜ì •] ì„œìˆ í˜• ë³€ê²½
                p = `${price}ì›ì§œë¦¬ ${item} ${cnt}ê°œë¥¼ ì‚¬ë©´ ëª¨ë‘ ì–¼ë§ˆì¸ê°€ìš”?`; 
                a = price * cnt;
                o.add(a); o.add(a+price); o.add(a-price); o.add(price * (cnt+1));
            } 
            // [ìœ í˜• 2] ì—¬ëŸ¬ ê°œ ì‚¬ê³  ë‚¨ì€ ëˆ
            else if (type === 2) { 
                const idx = getRandomInt(0, items.length-1);
                const item = items[idx];
                const price = prices[idx];
                const cnt = getRandomInt(2, 3); const cost = price * cnt;
                const held = Math.ceil((cost + 1000) / 1000) * 1000;
                
                // [ìˆ˜ì •] ì„œìˆ í˜• ë³€ê²½
                p = `${held}ì›ì„ ê°€ì§€ê³  ${price}ì›ì§œë¦¬ ${item} ${cnt}ê°œë¥¼ ìƒ€ìŠµë‹ˆë‹¤. ë‚¨ì€ ëˆì€ ì–¼ë§ˆì¸ê°€ìš”?`; 
                a = held - cost;
                o.add(a); o.add(a+100); o.add(a-100); o.add(held - price);
            } 
            // [ìœ í˜• 3] êµ¬ë§¤ ê°€ëŠ¥ ì—¬ë¶€ (Yes/No)
            else if (type === 3) { 
                const idx = getRandomInt(0, items.length-1);
                const item = items[idx];
                const price = prices[idx];
                const cnt = getRandomInt(3, 5); const total = price * cnt;
                const myMoney = Math.random() < 0.5 ? total - 100 : total + 1000;
                const isPossible = myMoney >= total;
                
                // [ìˆ˜ì •] ì„œìˆ í˜• ë³€ê²½
                p = `${myMoney}ì›ìœ¼ë¡œ ${price}ì›ì§œë¦¬ ${item} ${cnt}ê°œë¥¼ ì‚´ ìˆ˜ ìˆì„ê¹Œìš”?`;
                a = isPossible ? "ì‚´ ìˆ˜ ìˆë‹¤" : "ì‚´ ìˆ˜ ì—†ë‹¤";
                o.add("ì‚´ ìˆ˜ ìˆë‹¤"); o.add("ì‚´ ìˆ˜ ì—†ë‹¤"); o.add("ëª¨ë¥´ê² ë‹¤"); o.add("ê¸€ì„ìš”");
            } 
            // [ìœ í˜• 4] ë‘ ë¬¼ê±´ í•©ê³„
            else if (type === 4) { 
                const idx = getRandomInt(0, items.length-1);
                const idx2 = (idx + 1) % items.length;
                // [ìˆ˜ì •] ì„œìˆ í˜• ë³€ê²½
                p = `${prices[idx]}ì›ì§œë¦¬ ${items[idx]} 1ê°œì™€ ${prices[idx2]}ì›ì§œë¦¬ ${items[idx2]} 1ê°œëŠ” ëª¨ë‘ ì–¼ë§ˆì¸ê°€ìš”?`;
                a = prices[idx] + prices[idx2];
                o.add(a); o.add(a+100); o.add(a-100); o.add(Math.abs(prices[idx]-prices[idx2]));
            }
            // [ìœ í˜• 5] ë”ì¹˜í˜ì´ (ë‚˜ëˆ„ì–´ ë‚´ê¸°)
            else if (type === 5) {
                const people = getRandomInt(2, 4); // 2~4ëª…
                const perPerson = getRandomInt(2, 9) * 1000; // 1ì¸ë‹¹ 2000~9000ì›
                const totalBill = people * perPerson;

                // [ìˆ˜ì •] ì„œìˆ í˜• ë³€ê²½
                p = `ìŒì‹ê°’ ${totalBill}ì›ì„ ${people}ëª…ì´ ë˜‘ê°™ì´ ë‚˜ëˆ„ì–´ ë‚´ë©´ í•œ ì‚¬ëŒì€ ì–¼ë§ˆë¥¼ ë‚´ì•¼ í•˜ë‚˜ìš”?`;
                a = perPerson;
                
                o.add(a); 
                o.add(a + 1000); 
                o.add(a - 1000); 
                o.add(Math.floor(totalBill / (people + 1))); // ì¸ì›ìˆ˜ ì°©ê° ì˜¤ë‹µ
            }
            // [ìœ í˜• 6] ì €ì¶• ëª©í‘œ
            else if (type === 6) {
                const weeks = getRandomInt(3, 8); // 3~8ì£¼
                const saving = getRandomInt(2, 5) * 1000; // ë§¤ì£¼ 2000~5000ì› ì €ì¶•
                const target = weeks * saving;
                
                // [ìˆ˜ì •] ì„œìˆ í˜• ë³€ê²½
                p = `${target}ì›ì§œë¦¬ ì¥ë‚œê°ì„ ì‚¬ë ¤ê³  ë§¤ì£¼ ${saving}ì›ì”© ëª¨ìë‹ˆë‹¤. ëª¨ë‘ ëª¨ìœ¼ë ¤ë©´ ëª‡ ì£¼ê°€ ê±¸ë¦´ê¹Œìš”?`;
                a = weeks;
                unit = "ì£¼";

                o.add(a);
                o.add(a + 1);
                o.add(a - 1);
                o.add(weeks * 2);
            }
            // ë³´ê¸° ì™„ì„± ë° ë¦¬í„´ ì²˜ë¦¬
            if (typeof a === 'number') {
                const safeO = Array.from(o).filter(n => n > 0).slice(0, 4);
                while(safeO.length < 4) safeO.push(a + (safeO.length + 1) * (type === 6 ? 1 : 1000));
                
                if (type === 6) {
                    return { 
                        problem: p, 
                        answer: a + unit, 
                        options: shuffleArray(safeO).map(opt => opt + unit) 
                    };
                } else {
                    return { 
                        problem: p, 
                        answer: a + "ì›", // Code 2ëŠ” ìˆ«ìë§Œ ê´€ë¦¬í–ˆìœ¼ë‚˜ ì—¬ê¸°ì„  "ì›" ë¶™ì—¬ì¤Œ
                        options: shuffleArray(safeO).map(opt => opt + "ì›")
                    };
                }
            } else {
                // "ì‚´ ìˆ˜ ìˆë‹¤/ì—†ë‹¤" ê°™ì€ ë¬¸ìì—´ ì •ë‹µì¸ ê²½ìš°
                return { 
                    problem: p, 
                    answer: a, 
                    options: shuffleArray(Array.from(o)) 
                };
            }
        }

        // [4-2] ë‹¨ìœ„ ë³€í™˜ í€´ì¦ˆ (Code 2 ì •ë°€ ë¡œì§ ì´ì‹)
        function generateUnitProblem() {
            // 1. ë‹¨ìœ„ í…œí”Œë¦¿
            const templates = [
                { large: 'kg', small: 'g', factor: 1000, type: 'decimal' },
                { large: 'L', small: 'mL', factor: 1000, type: 'decimal' },
                { large: 'km', small: 'm', factor: 1000, type: 'decimal' },
                { large: 'm', small: 'cm', factor: 100, type: 'decimal' },
                { large: 'cm', small: 'mm', factor: 10, type: 'decimal' },
                { large: 'ë¶„', small: 'ì´ˆ', factor: 60, type: 'time' },
                { large: 'ì‹œê°„', small: 'ë¶„', factor: 60, type: 'time' },
                { large: 'ì¼', small: 'ì‹œê°„', factor: 24, type: 'day' },
                { large: 'ë…„', small: 'ì¼', factor: 365, type: 'year' }
            ];

            const t = templates[getRandomInt(0, templates.length-1)];
            
            // ë‚œì´ë„ ì¡°ì ˆ ë¡œì§
            let val;
            if (t.type === 'decimal') {
                val = getRandomInt(1, 9); 
            } else if (t.type === 'year') {
                val = getRandomInt(1, 2); 
            } else {
                val = getRandomInt(1, 3); 
            }

            const direction = getRandomInt(0, 1); // 0: í°->ì‘, 1: ì‘->í°
            let p, ans;
            let o = new Set();

            if (direction === 0) {
                // ì˜ˆ: 2m -> 200cm
                ans = val * t.factor; 
                p = `<span class="text-3xl font-bold text-blue-600">${val}${t.large}</span><br><span class="text-sm text-gray-500">ëŠ” ëª‡ ${t.small}ì¼ê¹Œìš”?</span>`;
                o.add(ans);

                // ì˜¤ë‹µ ìƒì„± ë¡œì§
                if (t.type === 'decimal') {
                    o.add(val * 10); o.add(val * 100); o.add(val * 1000);    
                } else if (t.type === 'time') {
                    o.add(val * 100); o.add(val * 10); o.add(ans + 10); o.add(ans - 10);
                } else if (t.type === 'day') { 
                    o.add(val * 10); o.add(val * 12); o.add(ans + 2);
                } else if (t.type === 'year') {
                    o.add(val * 360); o.add(val * 300); o.add(val * 100 + 65);
                }
            } else {
                // ì˜ˆ: 120ì´ˆ -> 2ë¶„
                const questionVal = val * t.factor; 
                ans = val; 
                p = `<span class="text-3xl font-bold text-green-600">${questionVal}${t.small}</span><br><span class="text-sm text-gray-500">ì€ ëª‡ ${t.large}ì¼ê¹Œìš”?</span>`;
                o.add(ans);

                // ì˜¤ë‹µ ìƒì„± ë¡œì§
                if (t.type === 'decimal') {
                    o.add(ans * 10);
                    o.add(Math.floor(questionVal / 10));
                } else if (t.type === 'time') {
                    o.add(questionVal); o.add(10); o.add(ans + 1); o.add(Math.max(1, ans - 1));
                } else if (t.type === 'day') {
                    o.add(questionVal); o.add(ans + 12);
                } else if (t.type === 'year') {
                    o.add(1); o.add(10); o.add(val + 1);
                }
            }

            // ë¬´í•œ ë£¨í”„ ë°©ì§€ ë° ì˜¤ë‹µ ì±„ìš°ê¸°
            let loopGuard = 0;
            while(o.size < 4 && loopGuard < 50) {
                const wrong = ans + getRandomInt(1, 5) * (getRandomInt(0,1)===0 ? 1 : -1);
                if (wrong > 0 && wrong !== ans) o.add(wrong);
                loopGuard++;
            }
            while(o.size < 4) {
                o.add(ans + (o.size + 1) * (ans > 10 ? 10 : 1));
            }

            return { problem: p, answer: ans, options: shuffleArray(Array.from(o).slice(0,4)) };
        }

        // [4-3] ê¸°ë³¸ ì‚¬ì¹™ì—°ì‚° (ê°€ë¡œ/ì„¸ë¡œ ëª¨ë“œ ì§€ì›)
        function generateMathQuiz(op, min, max) {
            let n1 = getRandomInt(min, max), n2 = getRandomInt(min, max);
            let a;
            if(op==='+') a=n1+n2; 
            else if(op==='-') { if(n1<n2)[n1,n2]=[n2,n1]; a=n1-n2; } 
            else a=n1*n2;

            let o = new Set([a]);
            let loopGuard = 0; 
            while(o.size<4 && loopGuard < 50) { 
                let wa = a+getRandomInt(-5,5); 
                if(wa>=0&&wa!==a) o.add(wa); 
                loopGuard++;
            }
            while(o.size<4) o.add(a + o.size + 1);

            // ê°€ë¡œ/ì„¸ë¡œ ëª¨ë“œ (ê¸°ë³¸ì€ ì„¸ë¡œ, í•„ìš”ì‹œ ë³€ê²½ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ê³„)
            let problemHtml = '';
            // ì—¬ê¸°ì„œëŠ” 1ë²ˆ ì½”ë“œ ìŠ¤íƒ€ì¼ì¸ ì„¸ë¡œì…ˆì„ ê¸°ë³¸ìœ¼ë¡œ ì ìš©í•˜ë˜, Code 2ì˜ HTML êµ¬ì¡°ë¥¼ ë”°ë¦„
            problemHtml = `
                <div class="inline-block text-right font-mono font-bold text-5xl leading-tight text-gray-800 p-4">
                    <div class="mb-2 tracking-widest mr-2">${n1}</div>
                    <div class="border-b-4 border-gray-800 pb-2 flex justify-end gap-4 items-center">
                        <span class="text-blue-600 text-4xl mr-2">${op}</span>
                        <span class="tracking-widest mr-2">${n2}</span>
                    </div>
                    <div class="pt-4 text-gray-300 text-center text-4xl">?</div>
                </div>
            `;
            return { problem: problemHtml, answer: a, options: shuffleArray(Array.from(o)) };
        }

        // [4-4] ë‹¨ê³„ë³„ ì—°ì‚° (ë°›ì•„ì˜¬ë¦¼/ë‚´ë¦¼ ê°•ì œ ë¡œì§ í¬í•¨)
        function generateMathSteppedQuiz(op, digits, difficulty) {
            let n1, n2, ans;
            const min = digits === 2 ? 10 : 100;
            const max = digits === 2 ? 99 : 999;
            const limitLoop = 100;

            if (op === '+') {
                if (difficulty === 'easy') {
                    // ë°›ì•„ì˜¬ë¦¼ ì—†ìŒ
                    let s1 = '', s2 = '';
                    for (let i=0; i<digits; i++) {
                        const d1Min = (i===0) ? 1 : 0;
                        const d1 = getRandomInt(d1Min, 9);
                        const d2 = getRandomInt(0, 9 - d1);
                        s1 += d1; s2 += d2;
                    }
                    n1 = parseInt(s1); n2 = parseInt(s2);
                } else {
                    // ë°›ì•„ì˜¬ë¦¼ ìˆìŒ (ê°•ì œ)
                    let tryCount = 0;
                    do {
                        n1 = getRandomInt(min, max);
                        n2 = getRandomInt(min, max);
                        let carry = false;
                        let s1 = n1.toString(), s2 = n2.toString();
                        while(s1.length < digits) s1 = '0'+s1;
                        while(s2.length < digits) s2 = '0'+s2;
                        for(let i=0; i<digits; i++) {
                            if (parseInt(s1[i]) + parseInt(s2[i]) >= 10) carry = true;
                        }
                        if (carry) break;
                        tryCount++;
                    } while(tryCount < limitLoop);
                }
                ans = n1 + n2;
            } else { 
                if (difficulty === 'easy') {
                    // ë°›ì•„ë‚´ë¦¼ ì—†ìŒ
                    let s1 = '', s2 = '';
                    for (let i=0; i<digits; i++) {
                         const d1Min = (i===0) ? 1 : 0;
                         const d1 = getRandomInt(d1Min, 9);
                         const d2 = getRandomInt(0, d1);
                         s1 += d1; s2 += d2;
                    }
                    n1 = parseInt(s1); n2 = parseInt(s2);
                } else {
                    // ë°›ì•„ë‚´ë¦¼ ìˆìŒ (ê°•ì œ)
                    let tryCount = 0;
                    do {
                        n1 = getRandomInt(min, max);
                        n2 = getRandomInt(min, max);
                        if (n1 <= n2) continue;
                        let borrow = false;
                        let s1 = n1.toString(), s2 = n2.toString();
                        while(s1.length < digits) s1 = '0'+s1;
                        while(s2.length < digits) s2 = '0'+s2;
                        for(let i=0; i<digits; i++) {
                             if (parseInt(s1[i]) < parseInt(s2[i])) borrow = true;
                        }
                        if (borrow) break;
                        tryCount++;
                    } while(tryCount < limitLoop);
                    if(n1 <= n2) { n1 = max; n2 = min; } 
                }
                ans = n1 - n2;
            }

            // ì˜¤ë‹µ ìƒì„± ë¡œì§
            let o = new Set([ans]);
            let loopGuard = 0;
            while(o.size < 4 && loopGuard < 50) {
                let diff = getRandomInt(-10, 10) * (digits===3?10:1);
                if(diff === 0) diff = 5;
                let wa = ans + diff;
                if (wa >= 0 && wa !== ans) o.add(wa);
                loopGuard++;
            }
            while(o.size < 4) o.add(ans + o.size + 1);
            
            const problemHtml = `
                <div class="inline-block text-right font-mono font-bold text-5xl leading-tight text-gray-800 p-4">
                    <div class="mb-2 tracking-widest mr-2">${n1}</div>
                    <div class="border-b-4 border-gray-800 pb-2 flex justify-end gap-4 items-center">
                        <span class="text-blue-600 text-4xl mr-2">${op}</span>
                        <span class="tracking-widest mr-2">${n2}</span>
                    </div>
                    <div class="pt-4 text-gray-300 text-center text-4xl">?</div>
                </div>
            `;
            return { problem: problemHtml, answer: ans, options: shuffleArray(Array.from(o)) };
        }

        // [4-5] ìˆ«ì ì²´ê³„ (í•œê¸€<->ìˆ«ì)
        function generateNumberSystemQuiz(level) {
            const max = level === 'easy' ? 10 : 100;
            const targetNum = getRandomInt(level==='easy'?1:11, max);
            const type = getRandomInt(0, 1);
            let p, a, o = new Set();
            if (type===0) { 
                p = `<span class="text-sm text-gray-400">ìˆ«ì</span><br>${targetNum}<br><span class="text-sm text-gray-400">ìš°ë¦¬ë§ë¡œ?</span>`; 
                a = getNativeNumber(targetNum); 
                o.add(a); 
                while(o.size<4) o.add(getNativeNumber(getRandomInt(1,max))); 
            }
            else { 
                const v = getNativeNumber(targetNum); 
                p = `<span class="text-sm text-gray-400">ìš°ë¦¬ë§</span><br>${v}<br><span class="text-sm text-gray-400">ìˆ«ìë¡œ?</span>`; 
                a = targetNum; 
                o.add(a); 
                while(o.size<4) o.add(getRandomInt(1,max)); 
            }
            return { problem: `<span class="text-4xl font-bold">${p}</span>`, answer: a, options: shuffleArray(Array.from(o)) };
        }
        
        // [4-6] ì•ŒíŒŒë²³ í€´ì¦ˆ
        function generateAlphabetQuiz(mode) {
            const alphabets = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split('');
            const alphaReads = ['ì—ì´','ë¹„','ì”¨','ë””','ì´','ì—í”„','ì§€','ì—ì´ì¹˜','ì•„ì´','ì œì´','ì¼€ì´','ì—˜','ì— ','ì—”','ì˜¤','í”¼','í','ì•Œ','ì—ìŠ¤','í‹°','ìœ ','ë¸Œì´','ë”ë¸”ìœ ','ì—‘ìŠ¤','ì™€ì´','ì§€(ì œíŠ¸)'];
            const idx = getRandomInt(0, 25); const char = alphabets[idx];
            let p, a, o = new Set();
            if(mode==='order') { p=`${char} ë‹¤ìŒì€?`; a=alphabets[idx+1]||'A'; o.add(a); while(o.size<4) o.add(alphabets[getRandomInt(0,25)]); }
            else if(mode==='case') { p=`${char}ì˜ ì†Œë¬¸ìëŠ”?`; a=char.toLowerCase(); o.add(a); while(o.size<4) o.add(alphabets[getRandomInt(0,25)].toLowerCase()); }
            else { p=`${char} ì½ëŠ” ë²•?`; a=alphaReads[idx]; o.add(a); while(o.size<4) o.add(alphaReads[getRandomInt(0,25)]); }
            return { problem: `<span class="text-5xl font-bold text-blue-500">${p}</span>`, answer: a, options: shuffleArray(Array.from(o)) };
        }
   // ==========================================
        // [5] ë¬¸ì œ ìƒì„± ë¡œì§: ë‹¬ë ¥, ì¼ê³¼í‘œ, ì‹œê°„, ë¬¸ì¥ì œ (Code 2 ì™„ë²½ ì´ì‹)
        // ==========================================

  // [ë‹¬ë ¥ ì „ìš© ìƒìˆ˜ ì„ ì–¸ - ì¸ë±ìŠ¤ ë¶ˆì¼ì¹˜ í•´ê²°ì„ ìœ„í•´ ë…ë¦½ ì •ì˜]
const CAL_DAYS = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];

// [5-1] ë‹¬ë ¥ ë°ì´í„° ìƒì„± (í† ìš”ì¼ ë¡œì§ ìˆ˜ì •)
function createRandomMonth() {
    const lastDate = [30, 31][getRandomInt(0, 1)];
    const startDayIndex = getRandomInt(0, 6); // 0:ì¼ìš”ì¼ ~ 6:í† ìš”ì¼
    const holidays = new Set();
    
    // ì¼ìš”ì¼ì€ ìë™ìœ¼ë¡œ holidaysì— ì¶”ê°€í•˜ì§€ ì•Šê³  CSS í´ë˜ìŠ¤ë¡œ ì²˜ë¦¬ (CSS ì¶©ëŒ ë°©ì§€)
    // ëœë¤ í‰ì¼ íœ´ì¼ ì¶”ê°€ (1~3ì¼ ì •ë„)
    while(holidays.size < getRandomInt(1, 3)) {
        const d = getRandomInt(1, lastDate);
        const dayIdx = (startDayIndex + d - 1) % 7;
        // í† , ì¼ìš”ì¼ì´ ì•„ë‹ ë•Œë§Œ íœ´ì¼(ë¹¨ê°„ë‚ ) ì¶”ê°€
        if (dayIdx !== 0 && dayIdx !== 6) {
            holidays.add(d);
        }
    }
    return { lastDate, startDayIndex, holidays };
}

// [5-1-B] ë‹¬ë ¥ HTML ê·¸ë¦¬ê¸° (CSS í´ë˜ìŠ¤ ë§¤í•‘ ìˆ˜ì •)
function getCalendarHTML(md) {
    const { lastDate, startDayIndex, holidays } = md;
    let html = '<div class="calendar-grid-container">';
    
    // ìš”ì¼ í—¤ë” (ì¼~í† )
    CAL_DAYS.forEach(d => html += `<div class="day-header">${d}</div>`);
    
    // ì‹œì‘ì¼ ì „ ë¹ˆì¹¸
    for(let i=0; i<startDayIndex; i++) html += `<div></div>`;
    
    // ë‚ ì§œ ì±„ìš°ê¸°
    for(let d=1; d<=lastDate; d++) {
        let cls = ''; // ê¸°ë³¸ í´ë˜ìŠ¤ ì—†ìŒ
        const dayIdx = (startDayIndex + d - 1) % 7; // 0(ì¼) ~ 6(í† )
        
        if (holidays.has(d)) {
            cls = 'holiday'; // ê³µíœ´ì¼ (ë¹¨ê°•)
        } else if (dayIdx === 0) {
            cls = 'sunday';  // ì¼ìš”ì¼ (ë¹¨ê°•)
        } else if (dayIdx === 6) {
            cls = 'saturday'; // í† ìš”ì¼ (íŒŒë‘)
        }
        
        html += `<div class="${cls}">${d}</div>`;
    }
    html += '</div>';
    return html;
}

// [5-2] ë‹¬ë ¥ í€´ì¦ˆ ìƒì„± (ì •ë‹µ ë¡œì§ ë™ê¸°í™”)
function generateCalendarQuestion() {
    const md = createRandomMonth();
    const { lastDate, startDayIndex, holidays } = md;
    
    // ì˜¤ëŠ˜ ë‚ ì§œ ëœë¤ ì„¤ì • (ë§ì¼ ì œì™¸)
    const today = getRandomInt(1, lastDate - 7);
    const type = getRandomInt(0, 5); 
    
    let p, a, o = new Set();

    // í—¬í¼: ë‚ ì§œ -> ìš”ì¼ ì¸ë±ìŠ¤ (0:ì¼ ~ 6:í† )
    const getDayIdx = (date) => (startDayIndex + date - 1) % 7;

    // ìœ í˜• 0: íŠ¹ì • ë‚ ì§œì˜ ìš”ì¼ ì°¾ê¸°
    if (type === 0) { 
        const t = getRandomInt(1, lastDate);
        const dayIdx = getDayIdx(t);
        p = `<span class="text-blue-600 font-bold">${t}ì¼</span>ì€ ë¬´ìŠ¨ ìš”ì¼ì¸ê°€ìš”?`; 
        a = CAL_DAYS[dayIdx] + 'ìš”ì¼';
        
        o.add(a); 
        while(o.size < 4) o.add(CAL_DAYS[getRandomInt(0, 6)] + 'ìš”ì¼');
    } 
    // ìœ í˜• 1: Nì¼ ë’¤ ìš”ì¼ ì°¾ê¸°
    else if (type === 1) { 
        const after = getRandomInt(2, 10);
        // ë‚ ì§œê°€ ë‹¬ì„ ë„˜ì–´ê°€ì§€ ì•Šë„ë¡ ì¡°ì •í•˜ê±°ë‚˜, ë‹¨ìˆœíˆ ìš”ì¼ë§Œ ê³„ì‚°
        // ì—¬ê¸°ì„œëŠ” ìš”ì¼ë§Œ ë¬¼ì–´ë³´ë¯€ë¡œ ë‹¨ìˆœ ê³„ì‚°
        const futureDate = today + after;
        // ë¯¸ë˜ ë‚ ì§œê°€ ì´ë²ˆë‹¬ì„ ë„˜ì–´ê°€ë„ ìš”ì¼ ê·œì¹™ì€ ê°™ìŒ
        const futureDayIdx = getDayIdx(futureDate);
        
        p = `ì˜¤ëŠ˜ì´ <span class="text-blue-600 font-bold">${today}ì¼</span>ì´ë¼ë©´<br>${after}ì¼ ë’¤ëŠ” ë¬´ìŠ¨ ìš”ì¼?`; 
        a = CAL_DAYS[futureDayIdx] + 'ìš”ì¼';
        
        o.add(a); 
        while(o.size < 4) o.add(CAL_DAYS[getRandomInt(0, 6)] + 'ìš”ì¼');
    } 
    // ìœ í˜• 2: íŠ¹ì • ìš”ì¼ ê°œìˆ˜ ì„¸ê¸° (ì˜ˆ: ì¼ìš”ì¼ì´ ëª‡ ë²ˆ?)
    else if (type === 2) { 
        const targetIdx = getRandomInt(0, 6);
        const targetName = CAL_DAYS[targetIdx];
        
        let cnt = 0;
        for(let d=1; d<=lastDate; d++) {
            if(getDayIdx(d) === targetIdx) cnt++;
        }
        
        p = `<span class="text-green-600 font-bold">${targetName}ìš”ì¼</span>ì€<br>ëª¨ë‘ ëª‡ ë²ˆ ìˆë‚˜ìš”?`; 
        a = cnt + "ë²ˆ";
        
        o.add(a); o.add("3ë²ˆ"); o.add("4ë²ˆ"); o.add("5ë²ˆ");
    } 
    // ìœ í˜• 3: ë¹¨ê°„ ë‚ (íœ´ì¼+ì¼ìš”ì¼) ê°œìˆ˜ ì„¸ê¸°
    else if (type === 3) { 
        let cnt = 0;
        for(let d=1; d<=lastDate; d++) {
            // ì¼ìš”ì¼(0)ì´ê±°ë‚˜ holidaysì— í¬í•¨ëœ ê²½ìš°
            if(getDayIdx(d) === 0 || holidays.has(d)) cnt++;
        }
        
        p = `ë‹¬ë ¥ì˜ <span class="text-red-500 font-bold">ë¹¨ê°„ ë‚ </span>ì€<br>ëª¨ë‘ ë©°ì¹ ì¸ê°€ìš”?`; 
        a = cnt + "ì¼";
        
        o.add(a); o.add((cnt+1)+"ì¼"); o.add((cnt-1)+"ì¼"); o.add((cnt+2)+"ì¼");
    } 
    // ìœ í˜• 4: Në²ˆì§¸ Xìš”ì¼ì€ ë©°ì¹ ?
    else if (type === 4) { 
        const targetIdx = getRandomInt(0, 6);
        const targetName = CAL_DAYS[targetIdx];
        
        // í•´ë‹¹ ìš”ì¼ì˜ ë‚ ì§œë“¤ì„ ìˆ˜ì§‘
        const dates = [];
        for(let d=1; d<=lastDate; d++) {
            if(getDayIdx(d) === targetIdx) dates.push(d);
        }
        
        // ëœë¤í•˜ê²Œ Në²ˆì§¸ ì„ íƒ
        const nth = getRandomInt(1, dates.length);
        const targetDate = dates[nth-1];
        
        p = `<span class="text-purple-600 font-bold">${nth}ë²ˆì§¸ ${targetName}ìš”ì¼</span>ì€<br>ë©°ì¹ ì¸ê°€ìš”?`; 
        a = targetDate + "ì¼";
        
        o.add(a); 
        o.add((targetDate+7 > lastDate ? targetDate-7 : targetDate+7) + "ì¼");
        o.add((targetDate+1) + "ì¼");
        o.add((targetDate-1) + "ì¼");
    } 
    // ìœ í˜• 5: ë‚ ì§œ ê°„ê²© ê³„ì‚°
    else { 
        const d1 = getRandomInt(1, 15);
        const d2 = getRandomInt(d1 + 2, lastDate);
        
        p = `${d1}ì¼ë¶€í„° ${d2}ì¼ê¹Œì§€ëŠ”<br>ëª¨ë‘ ë©°ì¹ ì¼ê¹Œìš”?<br><span class="text-sm text-gray-400">(ì‹œì‘ì¼ í¬í•¨)</span>`; 
        a = (d2 - d1 + 1) + "ì¼";
        
        const wrong1 = (d2 - d1);
        o.add(a); o.add(wrong1 + "ì¼"); o.add((wrong1+2) + "ì¼"); o.add((wrong1-1) + "ì¼");
    }
    
    // ë³´ê¸° 4ê°œë¡œ ë§ì¶”ê¸°
    const finalOptions = Array.from(o);
    while(finalOptions.length < 4) {
        const r = getRandomInt(1, 31) + "ì¼"; // ëŒ€ì¶© ì•„ë¬´ê±°ë‚˜ ì¶”ê°€
        if(!finalOptions.includes(r)) finalOptions.push(r);
    }

    return { 
        problem: `<span class="text-2xl font-bold">${p}</span>`, 
        answer: a, 
        options: shuffleArray(finalOptions), 
        monthData: md // ë³´ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ íŒì—…ì— ë„ìš¸ ë°ì´í„°
    };
}

        // [5-3] ì¼ê³¼í‘œ ë¶„ì„ í€´ì¦ˆ (Code 2: 6ê°€ì§€ ìœ í˜• - ì§ì „/ì§í›„/ì‹œê°„ì°¨ ë“±)
        function generateScheduleQuiz(depth=0) {
            if(depth > 10) return generateScheduleQuizSafeFallback();
            
            const keys = Object.keys(SCHEDULE_DATA);
            const r = keys[getRandomInt(0, keys.length-1)];
            const d = SCHEDULE_DATA[r];
            const items = d.items;
            const tIdx = getRandomInt(0, items.length-1);
            const tItem = items[tIdx];
            const type = getRandomInt(0, 5); 
            
            let p, a, o = new Set();

            if(type===0) { 
                p = `${tItem.t}ì—ëŠ”<br>ë¬´ì—‡ì„ í•˜ë‚˜ìš”?`; a = tItem.a;
                o.add(a); while(o.size<4) o.add(items[getRandomInt(0, items.length-1)].a);
            } else if(type===1) { 
                p = `"${tItem.a}"<br>ì‹œê°„ì€ ì–¸ì œì¸ê°€ìš”?`; a = tItem.t;
                o.add(a); while(o.size<4) o.add(items[getRandomInt(0, items.length-1)].t);
            } else if(type===2) { 
                if(tIdx < items.length-1) {
                    p = `"${tItem.a}"<br>ë‹¤ìŒì— í•˜ëŠ” ì¼ì€?`; a = items[tIdx+1].a;
                } else {
                    p = `"${tItem.a}"<br>ì§ì „ì— í•œ ì¼ì€?`; a = items[tIdx-1].a;
                }
                o.add(a); while(o.size<4) o.add(items[getRandomInt(0, items.length-1)].a);
            } else if(type===3) { 
                if(tIdx < items.length-1) {
                    const [h, m] = tItem.t.split(':').map(Number);
                    const newM = m + 10;
                    const timeStr = `${String(h).padStart(2,'0')}:${String(newM).padStart(2,'0')}`;
                    p = `${timeStr}ì—ëŠ”<br>ë¬´ì—‡ì„ í•˜ê³  ìˆë‚˜ìš”?`; a = tItem.a;
                    o.add(a); while(o.size<4) o.add(items[getRandomInt(0, items.length-1)].a);
                } else {
                    return generateScheduleQuiz(depth+1); 
                }
            } else if(type===4) { 
                if(tIdx < items.length-1) {
                    const item1 = items[tIdx];
                    const item2 = items[tIdx+1];
                    p = `"${item1.a}"ë¶€í„°<br>"${item2.a}" ì „ê¹Œì§€<br>ì‹œê°„ì€ ì–¼ë§ˆì¸ê°€ìš”?`;
                    const h1 = parseInt(item1.t.split(':')[0]);
                    const h2 = parseInt(item2.t.split(':')[0]);
                    let diff = h2 - h1; 
                    if (diff < 0) diff += 24;
                    a = diff + "ì‹œê°„";
                    o.add(a); o.add((diff+1)+"ì‹œê°„"); o.add((diff-1)+"ì‹œê°„"); o.add((diff*60)+"ë¶„");
                } else {
                    return generateScheduleQuiz(depth+1);
                }
            } else if(type===5) { 
                const targetItem = items.find(i => i.a.includes('í‡´ê·¼') || i.a.includes('í•˜êµ') || i.a.includes('ì§‘ì—ê°€ê¸°'));
                if(targetItem) {
                    const [h, m] = targetItem.t.split(':').map(Number);
                    const addedTime = getRandomInt(1, 2); 
                    let newH = h + addedTime;
                    if(newH >= 24) newH -= 24;
                    const ansTimeStr = `${String(newH).padStart(2,'0')}:${String(m).padStart(2,'0')}`;
                    const eventName = (targetItem.a.includes('í‡´ê·¼') || targetItem.a.includes('ì§‘ì—ê°€ê¸°')) ? "ì•¼ê·¼" : "ë³´ì¶©ìˆ˜ì—…";
                    p = `<span class="text-blue-600 font-bold">${addedTime}ì‹œê°„ ${eventName}</span>ì„ í•˜ë©´<br>ëª‡ ì‹œì— ì§‘ì— ê°€ê²Œ ë ê¹Œìš”?`;
                    a = ansTimeStr;
                    o.add(a); o.add(targetItem.t); 
                    let wrongH1 = (newH + 1) % 24;
                    let wrongH2 = (newH - 1 + 24) % 24;
                    o.add(`${String(wrongH1).padStart(2,'0')}:${String(m).padStart(2,'0')}`);
                    o.add(`${String(wrongH2).padStart(2,'0')}:${String(m).padStart(2,'0')}`);
                } else {
                    return generateScheduleQuiz(depth+1);
                }
            }
            return { 
                problem: `<span class="text-2xl font-bold">${p}</span>`, 
                answer: a, 
                options: shuffleArray(Array.from(o)), 
                scheduleData: d // Code 1 UIì—ì„œ ì¼ê³¼í‘œ ê·¸ë¦¬ê¸°ì— ì‚¬ìš©
            };
        }

        function generateScheduleQuizSafeFallback() {
             const d = SCHEDULE_DATA['STUDENT'];
             return { problem: "í•™êµ ê°ˆ ì‹œê°„ì€?", answer: "08:00", options: ["07:00","08:00","09:00","10:00"], scheduleData: d };
        }

   // [5-X] ì‹œê³„ ë³´ê¸° í€´ì¦ˆ ìƒì„± í•¨ìˆ˜ (ëˆ„ë½ëœ ë¡œì§ ì¶”ê°€)
        function generateClockQuiz(level) {
            let h, m;
            
            // ë‚œì´ë„ë³„ ì‹œê°„ ìƒì„±
            if (level === 'easy') {
                // ì •ê° ë˜ëŠ” 30ë¶„
                h = getRandomInt(1, 12);
                m = Math.random() < 0.5 ? 0 : 30;
            } else {
                // 1ë¶„ ë˜ëŠ” 5ë¶„ ë‹¨ìœ„ (Hard)
                h = getRandomInt(1, 12);
                m = getRandomInt(0, 59);
            }

            // ì •ë‹µ ë¬¸ìì—´ ìƒì„±
            const answerStr = `${h}ì‹œ ${m}ë¶„`;
            
            // ë³´ê¸° ìƒì„± (ì˜¤ë‹µ)
            let o = new Set([answerStr]);
            let loopGuard = 0;
            
            while(o.size < 4 && loopGuard < 50) {
                loopGuard++;
                
                // ì˜¤ë‹µ íŒ¨í„´ 1: ì‹œê°„ë§Œ ë‹¤ë¥´ê²Œ
                let wh = getRandomInt(1, 12);
                if(wh !== h) o.add(`${wh}ì‹œ ${m}ë¶„`);
                
                // ì˜¤ë‹µ íŒ¨í„´ 2: ë¶„ë§Œ ë‹¤ë¥´ê²Œ
                let wm;
                if(level === 'easy') wm = m === 0 ? 30 : 0;
                else wm = getRandomInt(0, 59);
                if(wm !== m) o.add(`${h}ì‹œ ${wm}ë¶„`);
                
                // ì˜¤ë‹µ íŒ¨í„´ 3: ì‹œì™€ ë¶„ì„ ë°”ê¿ˆ (ì˜ˆ: 3ì‹œ 6ë¶„ -> 6ì‹œ 3ë¶„)
                if(m >= 1 && m <= 12) o.add(`${m}ì‹œ ${h * 5}ë¶„`); // ë°”ëŠ˜ ìœ„ì¹˜ ì°©ê° ìœ ë„
            }
            
            // ë¶€ì¡±í•œ ë³´ê¸° ì±„ìš°ê¸°
            while(o.size < 4) {
                o.add(`${getRandomInt(1,12)}ì‹œ ${getRandomInt(0,5)*10}ë¶„`);
            }

            // ì‹œê³„ ê·¸ë¦¬ê¸°ëŠ” nextQuiz í•¨ìˆ˜ì—ì„œ q.h, q.m ë°ì´í„°ë¥¼ ë°›ì•„ ì²˜ë¦¬í•¨
return { 
                problem: "ì‹œê³„ê°€ ë‚˜íƒ€ë‚´ëŠ” ì‹œê°ì€?", 
                answer: answerStr, 
                options: shuffleArray(Array.from(o)).slice(0, 4), 
                type: 'clock_quiz', 
                h: h, 
                m: m 
            };
        }
   
        // [5-4] ì‹œê°„ ê³„ì‚° (Code 2: Easy/Hard ë‚œì´ë„ ë¶„ê¸° ë¡œì§)
        function generateTimeProblem(level) {
            const sh = getRandomInt(1, 12);
            const sm = getRandomInt(0, 5) * 10;
            const isAfter = Math.random() < 0.5; 
            let dh = getRandomInt(0, 3); 
            let dm = 0; 
            const maxAttempts = 10;

            if (level === 'easy') {
                if (isAfter) { 
                    const maxDm = 50 - sm;
                    const available = [];
                    for(let i=0; i<=maxDm; i+=10) if(dh>0 || i>0) available.push(i); 
                    if(available.length === 0) { dh=1; available.push(0); }
                    dm = available[getRandomInt(0, available.length-1)];
                } else { 
                    const available = [];
                    for(let i=0; i<=sm; i+=10) if(dh>0 || i>0) available.push(i);
                    if(available.length === 0) { dh=1; available.push(0); }
                    dm = available[getRandomInt(0, available.length-1)];
                }
            } else { // hard
                let attempts = 0;
                while(attempts < maxAttempts) {
                    if (isAfter) { 
                        const minDm = 60 - sm;
                        const available = [];
                        for(let i=minDm; i<=50; i+=10) available.push(i);
                        if(available.length > 0) {
                            dm = available[getRandomInt(0, available.length-1)];
                            break;
                        }
                    } else { 
                        const minDm = sm + 10;
                        const available = [];
                        for(let i=minDm; i<=50; i+=10) available.push(i);
                        if(available.length > 0) {
                            dm = available[getRandomInt(0, available.length-1)];
                            break;
                        }
                    }
                    attempts++;
                }
                if(attempts >= maxAttempts) return generateTimeProblem('easy'); 
            }

            const startDate = new Date(2025, 0, 1, sh, sm);
            const deltaTotal = (dh * 60) + dm;
            const targetDate = new Date(startDate.getTime() + (isAfter ? deltaTotal : -deltaTotal) * 60000);

            const format = (d) => {
                let h = d.getHours();
                const m = d.getMinutes();
                if (h === 0) h = 12; else if (h > 12) h -= 12;
                return `${h}ì‹œ ${String(m).padStart(2,'0')}ë¶„`;
            };

            const startTimeStr = format(startDate);
            const endTimeStr = format(targetDate);
            const durationStr = `${dh > 0 ? dh+'ì‹œê°„ ' : ''}${dm > 0 ? dm+'ë¶„' : ''}`;
            const problemHtml = `${startTimeStr}<br><span class="text-blue-600 font-bold">${durationStr} ${isAfter ? 'í›„' : 'ì „'}</span>ëŠ”?`;
            
            let options = new Set([endTimeStr]);
            
            // [Code 2: ì •ë°€ ì˜¤ë‹µ ìƒì„±]
            let timeLoopGuard = 0;
            while(options.size < 4 && timeLoopGuard < 50) { 
                options.add(format(new Date(targetDate.getTime() + getRandomInt(-12, 12) * 30 * 60000))); 
                timeLoopGuard++;
            }
            while(options.size < 4) {
                options.add(format(new Date(targetDate.getTime() + (options.size + 1) * 60000)));
            }

            return { problem: `<span class="text-3xl font-bold">${problemHtml}</span>`, answer: endTimeStr, options: shuffleArray(Array.from(options).slice(0, 4)) };
        }

        // [5-5] ë¬¸ì¥ì œ ë¬¸ì œ (Code 2: 40ê°œ ì‹œë‚˜ë¦¬ì˜¤ ì „ì²´ í¬í•¨)
        function generateWordProblem(type) {
            // 1. ë§ì…ˆ ì‹œë‚˜ë¦¬ì˜¤
            const scenariosAdd = [
                { t: "ë²„ìŠ¤ì— {0}ëª…ì´ íƒ€ê³  ìˆì—ˆìŠµë‹ˆë‹¤.<br>ì •ë¥˜ì¥ì—ì„œ {1}ëª…ì´ ë” íƒ”ë‹¤ë©´<br>ëª¨ë‘ ëª‡ ëª…ì¼ê¹Œìš”?", unit: "ëª…" },
                { t: "ëƒ‰ì¥ê³ ì— ì‚¬ê³¼ê°€ {0}ê°œ,<br>ì‹íƒì— {1}ê°œ ìˆìŠµë‹ˆë‹¤.<br>ì‚¬ê³¼ëŠ” ëª¨ë‘ ëª‡ ê°œì¼ê¹Œìš”?", unit: "ê°œ" },
                { t: "ì² ìˆ˜ëŠ” ë”±ì§€ë¥¼ {0}ì¥ ê°€ì§€ê³  ìˆê³ ,<br>ì˜í¬ëŠ” {1}ì¥ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.<br>ë‘ ì‚¬ëŒì˜ ë”±ì§€ëŠ” ëª¨ë‘ ëª‡ ì¥?", unit: "ì¥" },
                { t: "ì•„ì¹¨ì— ë¬¼ì„ {0}ì” ë§ˆì‹œê³ ,<br>ì €ë…ì— {1}ì” ë§ˆì…¨ìŠµë‹ˆë‹¤.<br>ë§ˆì‹  ë¬¼ì€ ëª¨ë‘ ëª‡ ì”ì¼ê¹Œìš”?", unit: "ì”" },
                { t: "í•„í†µì— ì—°í•„ì´ {0}ìë£¨,<br>ì±…ìƒ ìœ„ì— {1}ìë£¨ ìˆìŠµë‹ˆë‹¤.<br>ì—°í•„ì€ ëª¨ë‘ ëª‡ ìë£¨ì¼ê¹Œìš”?", unit: "ìë£¨" },
                { t: "ë†€ì´í„°ì— ë¹„ë‘˜ê¸°ê°€ {0}ë§ˆë¦¬ ìˆê³ ,<br>{1}ë§ˆë¦¬ê°€ ë” ë‚ ì•„ì™”ìŠµë‹ˆë‹¤.<br>ë¹„ë‘˜ê¸°ëŠ” ëª¨ë‘ ëª‡ ë§ˆë¦¬ì¼ê¹Œìš”?", unit: "ë§ˆë¦¬" },
                { t: "ì–´ì œ ë™í™”ì±…ì„ {0}ê¶Œ ì½ê³ ,<br>ì˜¤ëŠ˜ {1}ê¶Œ ë” ì½ì—ˆìŠµë‹ˆë‹¤.<br>ì½ì€ ì±…ì€ ëª¨ë‘ ëª‡ ê¶Œì¼ê¹Œìš”?", unit: "ê¶Œ" },
                { t: "ì£¼ì°¨ì¥ì— ì°¨ê°€ {0}ëŒ€ ìˆì—ˆëŠ”ë°,<br>{1}ëŒ€ê°€ ë” ë“¤ì–´ì™”ìŠµë‹ˆë‹¤.<br>ì°¨ëŠ” ëª¨ë‘ ëª‡ ëŒ€ì¼ê¹Œìš”?", unit: "ëŒ€" },
                { t: "ì§€ìš°ê°œ {0}ê°œì™€<br>ì—°í•„ {1}ê°œë¥¼ ìƒ€ìŠµë‹ˆë‹¤.<br>í•™ìš©í’ˆì€ ëª¨ë‘ ëª‡ ê°œì¼ê¹Œìš”?", unit: "ê°œ" },
                { t: "ë¹¨ê°„ í’ì„  {0}ê°œì™€<br>íŒŒë€ í’ì„  {1}ê°œë¥¼ ë¶ˆì—ˆìŠµë‹ˆë‹¤.<br>í’ì„ ì€ ëª¨ë‘ ëª‡ ê°œì¼ê¹Œìš”?", unit: "ê°œ" }
            ];
            // 2. ëº„ì…ˆ ì‹œë‚˜ë¦¬ì˜¤
            const scenariosSub = [
                { t: "ì¿ í‚¤ê°€ {0}ê°œ ìˆì—ˆìŠµë‹ˆë‹¤.<br>ì¹œêµ¬ì™€ {1}ê°œë¥¼ ë‚˜ëˆ  ë¨¹ì—ˆë‹¤ë©´<br>ë‚¨ì€ ì¿ í‚¤ëŠ” ëª‡ ê°œì¼ê¹Œìš”?", unit: "ê°œ" },
                { t: "ë²„ìŠ¤ì— {0}ëª…ì´ íƒ€ê³  ìˆì—ˆìŠµë‹ˆë‹¤.<br>ì´ë²ˆ ì—­ì—ì„œ {1}ëª…ì´ ë‚´ë ¸ë‹¤ë©´<br>ëª‡ ëª…ì´ ë‚¨ì•˜ì„ê¹Œìš”?", unit: "ëª…" },
                { t: "ë‹¬ê±€ {0}ê°œ ì¤‘ì—ì„œ<br>{1}ê°œê°€ ê¹¨ì¡ŒìŠµë‹ˆë‹¤.<br>ë‚¨ì€ ë‹¬ê±€ì€ ëª‡ ê°œì¼ê¹Œìš”?", unit: "ê°œ" },
                { t: "ë‚˜ë¬´ì— ì°¸ìƒˆ {0}ë§ˆë¦¬ê°€ ì•‰ì•„ìˆë‹¤ê°€<br>{1}ë§ˆë¦¬ê°€ ë‚ ì•„ê°”ìŠµë‹ˆë‹¤.<br>ë‚¨ì€ ì°¸ìƒˆëŠ” ëª‡ ë§ˆë¦¬ì¼ê¹Œìš”?", unit: "ë§ˆë¦¬" },
                { t: "ìš©ëˆì„ {0}ì²œ ì› ë°›ì•„ì„œ<br>{1}ì²œ ì›ì„ ì¼ìŠµë‹ˆë‹¤.<br>ì–¼ë§ˆê°€ ë‚¨ì•˜ì„ê¹Œìš”? (ë‹¨ìœ„: ì²œ ì›)", unit: "" },
                { t: "ì±…ì´ {0}ê¶Œ ê½‚í˜€ìˆì—ˆëŠ”ë°<br>{1}ê¶Œì„ ë¹Œë ¤ ê°”ìŠµë‹ˆë‹¤.<br>ë‚¨ì€ ì±…ì€ ëª‡ ê¶Œì¼ê¹Œìš”?", unit: "ê¶Œ" },
                { t: "ìš°ìœ ê°€ {0}ê°œ ìˆì—ˆìŠµë‹ˆë‹¤.<br>{1}ê°œë¥¼ ë§ˆì…¨ë‹¤ë©´<br>ëª‡ ê°œê°€ ë‚¨ì•˜ì„ê¹Œìš”?", unit: "ê°œ" },
                { t: "ì£¼ì°¨ì¥ì— ì°¨ê°€ {0}ëŒ€ ìˆì—ˆëŠ”ë°,<br>{1}ëŒ€ê°€ ë‚˜ê°”ìŠµë‹ˆë‹¤.<br>ë‚¨ì€ ì°¨ëŠ” ëª‡ ëŒ€ì¼ê¹Œìš”?", unit: "ëŒ€" },
                { t: "ìƒ‰ì¢…ì´ {0}ì¥ ì¤‘ì—ì„œ<br>{1}ì¥ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.<br>ë‚¨ì€ ìƒ‰ì¢…ì´ëŠ” ëª‡ ì¥ì¼ê¹Œìš”?", unit: "ì¥" },
                { t: "ì‚¬íƒ• {0}ê°œ ì¤‘<br>{1}ê°œë¥¼ ë™ìƒì—ê²Œ ì£¼ì—ˆìŠµë‹ˆë‹¤.<br>ë‚´ê°€ ê°€ì§„ ì‚¬íƒ•ì€ ëª‡ ê°œì¼ê¹Œìš”?", unit: "ê°œ" }
            ];
            // 3. ê³±ì…ˆ ì‹œë‚˜ë¦¬ì˜¤
            const scenariosMul = [
                { t: "ê±°ë¯¸ì˜ ë‹¤ë¦¬ëŠ” {0}ê°œì…ë‹ˆë‹¤.<br>ê±°ë¯¸ {1}ë§ˆë¦¬ì˜ ë‹¤ë¦¬ëŠ”<br>ëª¨ë‘ ëª‡ ê°œì¼ê¹Œìš”?", unit: "ê°œ", fixed: 8 },
                { t: "ìë™ì°¨ í•œ ëŒ€ì— ë°”í€´ê°€ {0}ê°œì…ë‹ˆë‹¤.<br>ìë™ì°¨ {1}ëŒ€ì˜ ë°”í€´ëŠ”<br>ëª¨ë‘ ëª‡ ê°œì¼ê¹Œìš”?", unit: "ê°œ", fixed: 4 },
                { t: "í•œ ìƒìì— ë„ë„›ì´ {0}ê°œì”© ë“¤ì–´ìˆìŠµë‹ˆë‹¤.<br>{1}ìƒìì˜ ë„ë„›ì€<br>ëª¨ë‘ ëª‡ ê°œì¼ê¹Œìš”?", unit: "ê°œ" },
                { t: "í•™ìƒ í•œ ëª…ì—ê²Œ ê³µì±…ì„ {0}ê¶Œì”©<br>ì£¼ë ¤ê³  í•©ë‹ˆë‹¤. {1}ëª…ì—ê²Œ ì£¼ë ¤ë©´<br>ê³µì±…ì€ ëª‡ ê¶Œ í•„ìš”í• ê¹Œìš”?", unit: "ê¶Œ" },
                { t: "ì¼ì£¼ì¼ì€ {0}ì¼ì…ë‹ˆë‹¤.<br>{1}ì£¼ì¼ì€ ëª¨ë‘ ë©°ì¹ ì¼ê¹Œìš”?", unit: "ì¼", fixed: 7 },
                { t: "ì‚¬íƒ•ì´ í•œ ë´‰ì§€ì— {0}ê°œì”© ìˆìŠµë‹ˆë‹¤.<br>{1}ë´‰ì§€ì— ë“¤ì–´ìˆëŠ” ì‚¬íƒ•ì€<br>ëª¨ë‘ ëª‡ ê°œì¼ê¹Œìš”?", unit: "ê°œ" },
                { t: "ë”±ì •ë²Œë ˆì˜ ë‹¤ë¦¬ëŠ” {0}ê°œì…ë‹ˆë‹¤.<br>ë”±ì •ë²Œë ˆ {1}ë§ˆë¦¬ì˜ ë‹¤ë¦¬ëŠ”<br>ëª¨ë‘ ëª‡ ê°œì¼ê¹Œìš”?", unit: "ê°œ", fixed: 6 },
                { t: "í•˜ë£¨ì— ì¤„ë„˜ê¸°ë¥¼ {0}ë²ˆì”© í•©ë‹ˆë‹¤.<br>{1}ì¼ ë™ì•ˆ ì¤„ë„˜ê¸°ë¥¼<br>ëª¨ë‘ ëª‡ ë²ˆ í–ˆì„ê¹Œìš”?", unit: "ë²ˆ" },
                { t: "í•œ ë¬¶ìŒì— ê½ƒì´ {0}ì†¡ì´ ìˆìŠµë‹ˆë‹¤.<br>{1}ë¬¶ìŒì˜ ê½ƒì€<br>ëª¨ë‘ ëª‡ ì†¡ì´ì¼ê¹Œìš”?", unit: "ì†¡ì´" },
                { t: "500ì›ì§œë¦¬ ë™ì „ì„<br>{1}ê°œ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.<br>ëª¨ë‘ ì–¼ë§ˆì¼ê¹Œìš”?", unit: "ì›", fixed: 500 }
            ];
            // 4. ë‚˜ëˆ—ì…ˆ ì‹œë‚˜ë¦¬ì˜¤
            const scenariosDiv = [
                { t: "ì‚¬íƒ• {0}ê°œë¥¼<br>ì¹œêµ¬ {1}ëª…ì—ê²Œ ë˜‘ê°™ì´ ë‚˜ëˆ„ì–´ ì£¼ë©´<br>í•œ ëª…ë‹¹ ëª‡ ê°œì”© ê°€ì§ˆê¹Œìš”?", unit: "ê°œ" },
                { t: "ì—°í•„ {0}ìë£¨ë¥¼<br>í•œ ëª…ì—ê²Œ {1}ìë£¨ì”© ì£¼ë©´<br>ëª‡ ëª…ì—ê²Œ ì¤„ ìˆ˜ ìˆì„ê¹Œìš”?", unit: "ëª…" },
                { t: "ê·¤ {0}ê°œë¥¼<br>í•œ ë°”êµ¬ë‹ˆì— {1}ê°œì”© ë‹´ìœ¼ë ¤ í•©ë‹ˆë‹¤.<br>ë°”êµ¬ë‹ˆëŠ” ëª‡ ê°œ í•„ìš”í• ê¹Œìš”?", unit: "ê°œ" },
                { t: "í•™ìƒ {0}ëª…ì´<br>í•œ ëª¨ë‘ ì— {1}ëª…ì”© ì§ì„ ì§€ìœ¼ë©´<br>ëª‡ ëª¨ë‘ ì´ ìƒê¸¸ê¹Œìš”?", unit: "ëª¨ë‘ " },
                { t: "ì±… {0}ê¶Œì„<br>ì±…ê½‚ì´ {1}ì¹¸ì— ë˜‘ê°™ì´ ë‚˜ëˆ„ì–´ ê½‚ìœ¼ë©´<br>í•œ ì¹¸ì— ëª‡ ê¶Œì”© ê½‚íê¹Œìš”?", unit: "ê¶Œ" },
                { t: "ê¸¸ì´ê°€ {0}cmì¸ ë¦¬ë³¸ì„<br>{1}ëª…ì´ ë˜‘ê°™ì´ ë‚˜ëˆ„ì–´ ê°€ì§€ë©´<br>í•œ ëª…ì´ ëª‡ cmë¥¼ ê°€ì§ˆê¹Œìš”?", unit: "cm" },
                { t: "ìš°ìœ  {0}ê°œë¥¼<br>{1}ì¼ ë™ì•ˆ ë§¤ì¼ ë˜‘ê°™ì´ ë§ˆì‹ ë‹¤ë©´<br>í•˜ë£¨ì— ëª‡ ê°œì”© ë§ˆì…”ì•¼ í• ê¹Œìš”?", unit: "ê°œ" },
                { t: "ì¥ë¯¸ê½ƒ {0}ì†¡ì´ë¥¼<br>ê½ƒë³‘ {1}ê°œì— ë˜‘ê°™ì´ ë‚˜ëˆ„ì–´ ê½‚ìœ¼ë ¤ í•©ë‹ˆë‹¤.<br>í•œ ë³‘ì— ëª‡ ì†¡ì´ì”© ê½‚íê¹Œìš”?", unit: "ì†¡ì´" },
                { t: "ë§Œë‘ {0}ê°œë¥¼<br>ì ‘ì‹œ {1}ê°œì— ë˜‘ê°™ì´ ë‚˜ëˆ„ì–´ ë‹´ìœ¼ë©´<br>í•œ ì ‘ì‹œì— ëª‡ ê°œì”© ë‹´ê¸¸ê¹Œìš”?", unit: "ê°œ" },
                { t: "ì¢…ì´í•™ {0}ë§ˆë¦¬ë¥¼<br>{1}ëª…ì´ ë˜‘ê°™ì´ ë‚˜ëˆ„ì–´ ê°€ì¡ŒìŠµë‹ˆë‹¤.<br>í•œ ëª…ì´ ëª‡ ë§ˆë¦¬ë¥¼ ê°€ì¡Œì„ê¹Œìš”?", unit: "ë§ˆë¦¬" }
            ];

            let currentMode = type;
            if (type === 'mixed') currentMode = Math.random() < 0.5 ? 'add' : 'sub';
            if (type === 'mul_div') currentMode = Math.random() < 0.5 ? 'mul' : 'div';

            let n1, n2, ans, text, unit;

            // --- ë¬¸ì œ ì¶œì œ ë¡œì§ ---
            if (currentMode === 'add') {
                n1 = getRandomInt(2, 20); n2 = getRandomInt(2, 20); ans = n1 + n2;
                const sc = scenariosAdd[getRandomInt(0, scenariosAdd.length - 1)];
                text = sc.t; unit = sc.unit;
            } else if (currentMode === 'sub') {
                n1 = getRandomInt(5, 30); n2 = getRandomInt(1, n1 - 1); ans = n1 - n2;
                const sc = scenariosSub[getRandomInt(0, scenariosSub.length - 1)];
                text = sc.t; unit = sc.unit;
            } else if (currentMode === 'mul') {
                const sc = scenariosMul[getRandomInt(0, scenariosMul.length - 1)];
                n1 = sc.fixed ? sc.fixed : getRandomInt(2, 9);
                n2 = getRandomInt(2, 9); ans = n1 * n2;
                text = sc.t; unit = sc.unit;
            } else { // div
                const sc = scenariosDiv[getRandomInt(0, scenariosDiv.length - 1)];
                n2 = getRandomInt(2, 9); 
                ans = getRandomInt(2, 9); 
                n1 = n2 * ans;            
                text = sc.t; unit = sc.unit;
            }

            // í…ìŠ¤íŠ¸ì— ìˆ«ì ë„£ê¸° (Code 2 ìŠ¤íƒ€ì¼)
            text = text.replace("{0}", `<span class="text-blue-600 font-bold">${n1}</span>`)
                       .replace("{1}", `<span class="text-blue-600 font-bold">${n2}</span>`);

            // --- ì˜¤ë‹µ ìƒì„± ë¡œì§ (í•¨ì • ë³´ê¸° í¬í•¨) ---
            let o = new Set([ans]);

            if (currentMode === 'mul') {
                o.add(n1 + n2); // ë§ì…ˆ ì°©ê°
                o.add(ans + n1); 
                o.add(ans - n1); 
            } 
            else if (currentMode === 'div') {
                o.add(n1 * n2); // ê³±ì…ˆ ì°©ê°
                o.add(n1 + n2); 
                o.add(n1 - n2); 
            }
            else if (currentMode === 'add') {
                o.add(Math.abs(n1 - n2)); 
            }
            else if (currentMode === 'sub') {
                o.add(n1 + n2); 
            }

            let loopGuard = 0;
            while(o.size < 4 && loopGuard < 50) {
                let range = (currentMode==='mul'||currentMode==='div') ? 10 : 5;
                let wa = ans + getRandomInt(-range, range);
                if (wa > 0 && wa !== ans) o.add(wa);
                loopGuard++;
            }
            while(o.size < 4) o.add(ans + o.size + 1);

            const options = shuffleArray(Array.from(o)).map(opt => unit ? `${opt}${unit}` : opt);
            const answerStr = unit ? `${ans}${unit}` : ans;

            return { problem: `<span class="text-xl md:text-2xl font-bold leading-normal block word-keep">${text}</span>`, answer: answerStr, options: options };
        }
   // ==========================================
        // [6] ë¹„ì£¼ì–¼ & ì‹¬í™” ìˆ˜í•™ ë¬¸ì œ ìƒì„± (Code 2 ì™„ë²½ ì´ì‹)
        // ==========================================
// [ì‹ ê·œ] ì €ìš¸ ê²Œì„ ë¡œì§
        function generateInteractiveScale() {
            const target = getRandomInt(2, 20) * 10; // 20g ~ 200g
            return {
                type: 'scale_interactive',
                target: target,
                answer: target, // ì •ë‹µ í™•ì¸ìš©
                problem: 'scale_ui' // ë Œë”ë§ìš© í”Œë˜ê·¸
            };
        }

        function updateScaleWeight(amount) {
            AppState.scaleState.current += amount;
            if (AppState.scaleState.current < 0) AppState.scaleState.current = 0;
            drawInteractiveScale('scale-canvas', AppState.scaleState.current);
        }

   function drawInteractiveScale(id, weight) {
    const cvs = document.getElementById(id);
    if (!cvs) return;
    const ctx = cvs.getContext('2d');
    
    // [ìˆ˜ì •] ë†’ì´ë¥¼ 400ìœ¼ë¡œ ëŠ˜ë ¤ ìƒë‹¨ ì—¬ë°± í™•ë³´
    cvs.width = 300; cvs.height = 400; 
    const w = cvs.width; const h = cvs.height;
    
    // [ìˆ˜ì •] bottomYë¥¼ h - 50ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ì•„ë˜ìª½ì—ë„ ì—¬ìœ ë¥¼ ë‘ 
    const centerX = w / 2; const bottomY = h - 50;

            ctx.clearRect(0, 0, w, h);

            // ì €ìš¸ ë³¸ì²´
            ctx.fillStyle = '#4b5563'; ctx.fillRect(centerX - 80, bottomY - 50, 160, 50);
            
            // ì•¡ì •
            ctx.fillStyle = '#d1fae5'; ctx.fillRect(centerX - 60, bottomY - 40, 120, 30);
            ctx.fillStyle = '#065f46'; ctx.font = 'bold 24px monospace'; ctx.textAlign = 'right';
            ctx.fillText(weight + 'g', centerX + 50, bottomY - 18);

            // ì ‘ì‹œ ë°›ì¹¨
            ctx.fillStyle = '#9ca3af'; ctx.beginPath();
            ctx.moveTo(centerX - 15, bottomY - 50); ctx.lineTo(centerX + 15, bottomY - 50);
            ctx.lineTo(centerX + 15, bottomY - 80); ctx.lineTo(centerX - 15, bottomY - 80);
            ctx.fill();

            // ì ‘ì‹œ
            ctx.fillStyle = '#e5e7eb'; ctx.beginPath();
            ctx.ellipse(centerX, bottomY - 80, 100, 20, 0, 0, 2 * Math.PI);
            ctx.fill(); ctx.stroke();

            // ë¬¼ê±´ (ë¬´ê²Œì— ë”°ë¼ ì»¤ì§)
            if (weight > 0) {
                const visualSize = Math.min(weight, 500) / 500;
                const radius = 20 + (visualSize * 40);
                ctx.fillStyle = '#f87171'; ctx.beginPath();
                ctx.arc(centerX, bottomY - 90 - radius/2, radius, 0, 2 * Math.PI);
                ctx.fill();
            }
        }
        // [6-1] ë¬¶ì–´ ì„¸ê¸° / ê·œì¹™ ì°¾ê¸° (ë¹„ì£¼ì–¼)
        function generateGroupCountingQuiz() {
            const items = ['ğŸŒ¸', 'ğŸŸ', 'ğŸ', 'â­', 'ğŸª', 'âš½', 'ğŸ¬', 'ğŸ¦‹'];
            const item = items[getRandomInt(0, items.length - 1)];
            
            const perGroup = getRandomInt(2, 5); 
            const groups = getRandomInt(2, 4);      
            const total = perGroup * groups;

            // ê·¸ë¦¼ ìƒì„± (Code 2 ìŠ¤íƒ€ì¼)
            let visual = '<div class="flex flex-col gap-2 items-center justify-center p-2 h-full">';
            for(let i=0; i<groups; i++) {
                visual += '<div class="flex gap-2 bg-white/50 px-4 py-2 rounded-xl border border-gray-300 shadow-sm">';
                for(let j=0; j<perGroup; j++) {
                    visual += `<span class="text-3xl filter drop-shadow-md leading-none">${item}</span>`;
                }
                visual += '</div>';
            }
            visual += '</div>';

            const type = getRandomInt(0, 3);
            let qText = "";
            let ansVal = 0;
            let unit = "";

            if (type === 0) {
                qText = `<span class="text-blue-600 font-bold">í•œ ë¬¶ìŒì—</span> ëª‡ ê°œì”© ìˆë‚˜ìš”?`;
                ansVal = perGroup; unit = "ê°œì”©";
            } else if (type === 1) {
                qText = `ëª¨ë‘ <span class="text-green-600 font-bold">ëª‡ ë¬¶ìŒ</span>ì¸ê°€ìš”?`;
                ansVal = groups; unit = "ë¬¶ìŒ";
            } else if (type === 2) {
                qText = `ëª¨ë‘ <span class="text-purple-600 font-bold">ëª‡ ê°œ</span>ì¼ê¹Œìš”?`;
                ansVal = total; unit = "ê°œ";
            } else {
                let seq = [];
                for(let k=1; k<=groups; k++) seq.push(perGroup * k);
                const hideIdx = getRandomInt(0, groups - 1);
                ansVal = seq[hideIdx]; unit = ""; 

                const seqHtml = seq.map((val, idx) => {
                    if (idx === hideIdx) return `<span class="inline-block w-12 py-1 text-center border-2 border-dashed border-gray-400 text-gray-400 rounded bg-white mx-1 text-2xl font-bold">?</span>`;
                    return `<span class="mx-1 text-2xl font-bold text-gray-800">${val}</span>`;
                }).join(`<span class="text-gray-400 font-light mx-1 text-lg">âœ</span>`);

                qText = `
                    <div class="text-lg text-gray-500 mb-2 whitespace-nowrap font-bold">ë¹ˆì¹¸ì— ì•Œë§ì€ ìˆ˜ëŠ”?</div>
                    <div class="flex justify-center items-center bg-gray-100 px-4 py-2 rounded-xl border border-gray-300 whitespace-nowrap">
                        ${seqHtml}
                    </div>
                `;
            }

            const problemHtml = `<div class="w-full flex items-center justify-center"><div class="text-[4vw] md:text-3xl font-bold text-gray-800 leading-normal whitespace-nowrap">${qText}</div></div>`;

            const answer = ansVal + unit;
            const o = new Set([answer]);
            let loop = 0;
            while(o.size < 4 && loop < 50) {
                loop++;
                let wrongVal = ansVal + getRandomInt(-2, 2);
                if (type === 3) wrongVal = ansVal + (Math.random()<0.5 ? getRandomInt(1, perGroup) : -getRandomInt(1, perGroup));
                else if (type === 2) wrongVal = (Math.random()<0.5) ? ansVal + getRandomInt(-3, 3) : ansVal + perGroup;
                
                if (wrongVal > 0 && wrongVal !== ansVal) o.add(wrongVal + unit);
            }
            while(o.size < 4) o.add((ansVal + o.size + 1) + unit);

            return {
                problem: problemHtml,
                answer: answer,
                options: shuffleArray(Array.from(o)),
                visualData: { html: visual, title: "ê·¸ë¦¼ ìë£Œ" } 
            };
        }

        // [6-2] ìˆ˜ ëª¨ìœ¼ê¸° / ê°€ë¥´ê¸° (ì²´ë¦¬ ë‹¤ì´ì–´ê·¸ë¨)
        function generateNumberBondQuiz() {
            const partA = getRandomInt(1, 5);
            const partB = getRandomInt(1, 5);
            const whole = partA + partB;
            
            const mode = getRandomInt(0, 1); // 0: ëª¨ìœ¼ê¸°, 1: ê°€ë¥´ê¸°
            let qText, answer;
            let dispWhole, dispA, dispB;

            const circleStyle = "w-16 h-16 rounded-full flex items-center justify-center text-3xl font-black border-4 shadow-lg";
            const boxWhole = `${circleStyle} bg-yellow-100 border-yellow-400 text-yellow-800`; 
            const boxPart = `${circleStyle} bg-blue-100 border-blue-400 text-blue-800`;   
            const boxQuestion = `${circleStyle} bg-white border-dashed border-gray-400 text-gray-400 animate-pulse`;

            if (mode === 0) { 
                qText = "ë‘ ìˆ˜ë¥¼ ëª¨ìœ¼ë©´?";
                answer = whole;
                dispWhole = `<div class="${boxQuestion}">?</div>`;
                dispA = `<div class="${boxPart}">${partA}</div>`;
                dispB = `<div class="${boxPart}">${partB}</div>`;
            } else {
                qText = `${whole}ì„(ë¥¼) ê°€ë¥´ë©´?`;
                if (Math.random() < 0.5) {
                    answer = partB;
                    dispWhole = `<div class="${boxWhole}">${whole}</div>`;
                    dispA = `<div class="${boxPart}">${partA}</div>`;
                    dispB = `<div class="${boxQuestion}">?</div>`;
                } else {
                    answer = partA;
                    dispWhole = `<div class="${boxWhole}">${whole}</div>`;
                    dispA = `<div class="${boxQuestion}">?</div>`;
                    dispB = `<div class="${boxPart}">${partB}</div>`;
                }
            }

            const problemHtml = `
                <div class="flex flex-col items-center justify-center w-full h-full py-2">
                    <div class="mb-4 text-gray-500 font-bold text-xl">${qText}</div>
                    <div class="relative flex flex-col items-center">
                        <div class="z-10 mb-8">${dispWhole}</div>
                        <svg class="absolute top-10 w-32 h-16 pointer-events-none" style="z-index: 0;">
                            <line x1="64" y1="10" x2="20" y2="50" stroke="#9ca3af" stroke-width="4" />
                            <line x1="64" y1="10" x2="108" y2="50" stroke="#9ca3af" stroke-width="4" />
                        </svg>
                        <div class="flex gap-8 z-10">
                            ${dispA}
                            ${dispB}
                        </div>
                    </div>
                </div>
            `;

            let o = new Set([answer]);
            let loop = 0;
            while(o.size < 4 && loop < 50) {
                loop++;
                let wrong = answer + getRandomInt(-3, 3);
                if (wrong >= 0 && wrong !== answer && wrong <= 10) o.add(wrong);
            }
            while(o.size < 4) o.add(answer + o.size + 1);

            return { problem: problemHtml, answer: answer, options: shuffleArray(Array.from(o)) };
        }

        // [6-3] í¬ê¸° ë¹„êµ (ì•„ì´ì½˜ vs ìˆ«ì)
        function generateCompareSizeQuiz(level) {
            const items = ['ğŸ', 'âš½', 'â­', 'ğŸª', 'ğŸŸ', 'ğŸŒ¸'];
            const item = items[getRandomInt(0, items.length - 1)];
            let valA, valB, visualA, visualB;
            
            const containerStyle = "grid grid-cols-2 gap-1 place-content-center place-items-center bg-white p-2 rounded-lg border border-gray-200 w-full h-full overflow-hidden shadow-inner";

            if (level === 'easy') {
                valA = getRandomInt(1, 9);
                valB = getRandomInt(1, 9);
                const makeVisual = (cnt) => {
                    let html = `<div class="${containerStyle}">`;
                    for(let i=0; i<cnt; i++) {
                        html += `<span class="text-2xl leading-none filter drop-shadow-sm">${item}</span>`;
                    }
                    html += `</div>`;
                    return html;
                };
                visualA = makeVisual(valA);
                visualB = makeVisual(valB);
            } else {
                valA = getRandomInt(10, 99);
                valB = getRandomInt(10, 99);
                const makeNum = (n) => `<div class="flex items-center justify-center bg-white rounded-lg border border-gray-200 w-full h-full text-5xl font-black text-gray-800 tracking-widest shadow-inner">${n}</div>`;
                visualA = makeNum(valA);
                visualB = makeNum(valB);
            }

            let answer;
            if (valA > valB) answer = ">";
            else if (valA < valB) answer = "<";
            else answer = "=";

            const problemHtml = `
                <div class="flex flex-col items-center justify-center w-full h-[200px] py-1">
                    <div class="flex w-full h-full gap-2 items-center justify-center px-2">
                        <div class="flex-1 h-full flex justify-center items-center">${visualA}</div>
                        <div class="text-gray-400 font-bold text-xs uppercase tracking-widest shrink-0">VS</div>
                        <div class="flex-1 h-full flex justify-center items-center">${visualB}</div>
                    </div>
                    <div class="text-base font-bold text-gray-500 mt-3">ì•Œë§ì€ ë¶€ë“±í˜¸ëŠ”?</div>
                </div>
            `;
            return { problem: problemHtml, answer: answer, options: [">", "<", "=", "?"] };
        }

        // [6-4] ë¶„ë¦¬ìˆ˜ê±°
        function generateRecycleQuiz() {
            const qIdx = getRandomInt(0, bank_recycle.length - 1);
            const qItem = bank_recycle[qIdx];
            const categories = ["í”Œë¼ìŠ¤í‹±", "ì¢…ì´", "ìº”", "ìœ ë¦¬", "ë¹„ë‹", "ì¼ë°˜ì“°ë ˆê¸°", "ìŒì‹ë¬¼", "ìŠ¤í‹°ë¡œí¼"];
            let o = new Set([qItem.a]);
            let loopGuard = 0;
            while(o.size < 4 && loopGuard < 50) {
                const wrong = categories[getRandomInt(0, categories.length - 1)];
                if (wrong !== qItem.a) o.add(wrong);
                loopGuard++;
            }
            const problemHtml = `
                <div class="flex flex-col items-center justify-center h-full">
                    <div class="text-sm text-gray-400 font-bold mb-4 tracking-widest uppercase">ì–´ë””ì— ë²„ë¦´ê¹Œìš”?</div>
                    <div class="text-4xl md:text-5xl font-black text-green-600 break-keep leading-snug drop-shadow-md text-center bg-white px-8 py-6 rounded-2xl border-2 border-green-100 shadow-xl">
                        ${qItem.q}
                    </div>
                </div>
            `;
            return { problem: problemHtml, answer: qItem.a, options: shuffleArray(Array.from(o)) };
        }

        // [6-5] ë¶„ìˆ˜ ê¸°ì´ˆ (5ê°€ì§€ ìœ í˜• ì™„ë²½ êµ¬í˜„)
        function generateFractionBasicQuiz() {
            const getFracHtml = (whole, num, den) => {
                let html = '<div class="inline-flex items-center font-bold align-middle mx-1">';
                if (whole && whole > 0) {
                    html += `<span class="mr-1 text-3xl text-gray-800">${whole}</span>`;
                }
                html += `<div class="flex flex-col items-center justify-center leading-none">
                            <span class="border-b-2 border-gray-800 pb-0.5 mb-0.5 block text-xl text-gray-800">${num}</span>
                            <span class="block text-xl text-gray-800">${den}</span>
                         </div>`;
                html += '</div>';
                return html;
            };

            const type = getRandomInt(0, 4);
            const den = getRandomInt(3, 9);
            let innerHtml = '', answer = '', questionText = '', o = new Set();

            // ìœ í˜• 0: ëŒ€ë¶„ìˆ˜ -> ê°€ë¶„ìˆ˜
            if (type === 0) {
                const whole = getRandomInt(1, 5);
                const num = getRandomInt(1, den - 1);
                const improperNum = whole * den + num;
                innerHtml = `${getFracHtml(whole, num, den)} <span class="text-2xl text-gray-400 mx-2">=</span> ${getFracHtml(null, '<span class="text-green-500 animate-pulse">?</span>', den)}`;
                questionText = "ë„¤ëª¨ì— ë“¤ì–´ê°ˆ ìˆ˜ëŠ”?";
                answer = improperNum;
                o.add(answer); o.add(whole * den - num); o.add(whole + num); o.add(improperNum + den);
            } 
            // ìœ í˜• 1: ê°€ë¶„ìˆ˜ -> ëŒ€ë¶„ìˆ˜
            else if (type === 1) {
                const whole = getRandomInt(1, 4);
                const num = getRandomInt(1, den - 1);
                const improperNum = whole * den + num;
                innerHtml = `${getFracHtml(null, improperNum, den)} <span class="text-2xl text-gray-400 mx-2">=</span> <span class="text-3xl font-bold text-green-500">?</span>`;
                questionText = "ëŒ€ë¶„ìˆ˜ë¡œ ë°”ê¾¸ë©´?";
                answer = `${whole}ì™€ ${num}/${den}`;
                o.add(answer); o.add(`${whole + 1}ì™€ ${num}/${den}`); o.add(`${whole}ì™€ ${num + 1}/${den}`);
                let wrongNum = (num - 1 > 0) ? num - 1 : num + 2;
                o.add(`${whole}ì™€ ${wrongNum}/${den}`);
            } 
            // ìœ í˜• 2,3,4: í¬ê¸° ë¹„êµ
            else {
                const makeFrac = (isMixed) => {
                    const w = getRandomInt(1, 4);
                    const n = getRandomInt(1, den - 1);
                    if (isMixed) return { val: w + n/den, html: getFracHtml(w, n, den) };
                    else {
                        const impN = w * den + n;
                        return { val: impN/den, html: getFracHtml(null, impN, den) };
                    }
                };
                let f1, f2;
                if (type === 2) { f1 = makeFrac(false); f2 = makeFrac(false); } 
                else if (type === 3) { f1 = makeFrac(true); f2 = makeFrac(true); } 
                else { f1 = makeFrac(false); f2 = makeFrac(true); }
                if (f1.val === f2.val && Math.random() < 0.8) f2 = makeFrac(type === 3);

                innerHtml = `<div class="flex items-center gap-4">${f1.html} <div class="w-12 h-12 rounded-full border-2 border-gray-300 flex items-center justify-center text-2xl font-bold text-gray-400 bg-gray-50">?</div> ${f2.html}</div>`;
                questionText = "ì•Œë§ì€ ë¶€ë“±í˜¸ëŠ”?";
                if (f1.val > f2.val) answer = ">"; else if (f1.val < f2.val) answer = "<"; else answer = "=";
                o.add(">"); o.add("<"); o.add("="); o.add("?");
            }

            // ì˜¤ë‹µ ì±„ìš°ê¸°
            let safeGuard = 0;
            while(o.size < 4 && safeGuard < 20) {
                 if(typeof answer === 'number') {
                     let fake = answer + getRandomInt(-5, 5);
                     if(fake > 0 && fake !== answer) o.add(fake);
                 } else if (typeof answer === 'string' && answer.includes('ì™€')) {
                     o.add(`${getRandomInt(1,5)}ì™€ ${getRandomInt(1,den-1)}/${den}`);
                 }
                 safeGuard++;
            }
            while(o.size < 4) o.add("ì˜¤ë‹µ" + o.size);

            const finalHtml = `
                <div class="flex flex-col items-center justify-center w-full h-full gap-3">
                    <div class="flex items-center justify-center scale-110">${innerHtml}</div>
                    <div class="text-sm text-gray-500 font-medium bg-white px-4 py-1 rounded-full border border-gray-200 shadow-sm mt-2">${questionText}</div>
                </div>`;
            
            return { problem: finalHtml, answer: answer, options: shuffleArray(Array.from(o).slice(0, 4)) };
        }

        // [6-6] ì–´ë¦¼í•˜ê¸° (ìƒ) - ë¶€ë“±í˜¸ ì¶”ë¡ 
        function generateDivEstimHard() {
            const divisor = getRandomInt(3, 9);
            const answerVal = getRandomInt(2, 9);
            const remainder = getRandomInt(1, divisor - 1); 
            const target = divisor * answerVal + remainder;

            const problemHtml = `
                <div class="flex flex-col items-center justify-center w-full h-full p-2">
                    <div class="bg-white border-2 border-indigo-100 rounded-2xl py-4 px-6 w-full max-w-[90%] shadow-lg flex flex-col items-center gap-2">
                        <div class="text-indigo-500 text-xs font-bold mb-1 uppercase tracking-wider">ë„¤ëª¨ì— ë“¤ì–´ê°ˆ ê°€ì¥ í° ìˆ˜ëŠ”?</div>
                        <div class="flex flex-col items-center gap-0">
                            <div class="flex items-center gap-2">
                                <span class="text-gray-800 font-black text-5xl">${divisor}</span>
                                <span class="text-gray-400 font-bold text-2xl">Ã—</span>
                                <div class="w-12 h-12 border-b-4 border-indigo-500 bg-indigo-50 rounded flex items-center justify-center">
                                    <span class="text-indigo-600 font-black text-3xl animate-pulse">?</span>
                                </div>
                            </div>
                            <div class="flex items-center gap-2 -mt-1">
                                <span class="text-red-400 font-black text-3xl">&lt;</span>
                                <span class="text-gray-800 font-black text-4xl tracking-widest">${target}</span>
                            </div>
                        </div>
                    </div>
                    <div class="text-center mt-3 leading-tight space-y-1">
                        <p class="text-gray-800 font-bold text-sm">${target}<span class="text-gray-400 font-normal">ë³´ë‹¤</span> <span class="text-red-500">ì‘ìœ¼ë©´ì„œ</span></p>
                        <p class="text-indigo-600 font-bold text-sm">ê°€ì¥ ê°€ê¹Œìš´ ìˆ˜</p>
                    </div>
                </div>
            `;
            let o = new Set([answerVal]);
            o.add(answerVal + 1); 
            o.add(answerVal - 1);
            while(o.size < 4) {
                let wrong = answerVal + getRandomInt(-3, 3);
                if(wrong > 0 && wrong !== answerVal) o.add(wrong);
            }
            return { problem: problemHtml, answer: answerVal, options: shuffleArray(Array.from(o)) };
        }
   // ==========================================
        // [7] í€´ì¦ˆ ì„¤ì • ë° ì—°ê²° (Code 2 difficultySettings ì™„ë²½ ì´ì‹)
        // Code 1ì˜ ë©”ë‰´ IDì™€ Code 2ì˜ ìƒì„± ë¡œì§ì„ ë§¤í•‘í•˜ëŠ” ì„¤ì •ê°’ì…ë‹ˆë‹¤.
        // ==========================================
   const QUIZ_CONFIG = {
            // [1ë‹¨ê³„: ë°˜ì‚¬ì‹ ê²½ë¥˜ - S:1.2 / A:2.0 / B:3.0]
            'k_consonant': { type: 'lang', subType: 'consonant', bank: bank_consonants, limits: [1.2, 2.0, 3.0] },
            'k_vowel': { type: 'lang', subType: 'vowel', bank: bank_vowels, limits: [1.2, 2.0, 3.0] },
            'compare_size_easy': { type: 'compare_size', level: 'easy', limits: [1.2, 2.0, 3.0] },
            'number_system_easy': { type: 'number_system', level: 'easy', limits: [1.2, 2.0, 3.0] },

            // [2ë‹¨ê³„: ê¸°ì´ˆ ì—°ì‚°/ë‹¨ì–´ - S:1.5 / A:2.5 / B:4.0]
            'add_1d': { type: 'math', min: 1, max: 9, operator: '+', limits: [1.5, 2.5, 4.0] },
            'sub_1d': { type: 'math', min: 1, max: 9, operator: '-', limits: [1.5, 2.5, 4.0] },
            'mul_99': { type: 'math', min: 2, max: 9, operator: '*', limits: [1.5, 2.5, 4.0] },
            'dict_single': { type: 'lang', subType: 'dictation', bank: bank_single, limits: [1.5, 2.5, 4.0] },
            'life_eng': { type: 'lang', subType: 'vocab', bank: bank_life_eng, limits: [1.5, 2.5, 4.0] },
            'alpha_order': { type: 'alphabet', mode: 'order', limits: [1.5, 2.5, 4.0] },
            'alpha_case': { type: 'alphabet', mode: 'case', limits: [1.5, 2.5, 4.0] },
            'alpha_sound': { type: 'alphabet', mode: 'sound', limits: [1.5, 2.5, 4.0] },
            'number_system_hard': { type: 'number_system', level: 'hard', limits: [1.5, 2.5, 4.0] },
            'number_bond': { type: 'number_bond', limits: [1.5, 2.5, 4.0] },
            'compare_size_hard': { type: 'compare_size', level: 'hard', limits: [1.5, 2.5, 4.0] },

            // [3ë‹¨ê³„: ìƒê° í•„ìš” - S:2.0 / A:3.5 / B:5.5]
            'dict_complex': { type: 'lang', subType: 'dictation', bank: bank_complex, limits: [2.0, 3.5, 5.5] },
            'skip_counting': { type: 'skip_counting', limits: [2.0, 3.5, 5.5] },
            'group_counting': { type: 'group_counting', limits: [2.0, 3.5, 5.5] },
            'add_2d_easy': { type: 'math_step', digits: 2, op: '+', diff: 'easy', limits: [2.0, 3.5, 5.5] },
            'sub_2d_easy': { type: 'math_step', digits: 2, op: '-', diff: 'easy', limits: [2.0, 3.5, 5.5] },
            'recycle_practice': { type: 'recycle', limits: [2.0, 3.5, 5.5] },
            'clock_quiz_easy': { type: 'clock_quiz', level: 'easy', limits: [2.0, 3.5, 5.5] },
            'time_quiz_easy': { type: 'time_quiz', level: 'easy', limits: [2.5, 4.5, 6.5] },
            'div_basic': { type: 'complex_div', hasRem: false, level: 'easy', limits: [2.0, 3.5, 5.0] }, // êµ¬êµ¬ë‹¨ ë‚˜ëˆ—ì…ˆ

            // [4ë‹¨ê³„: ê³ ë‚œì´ë„ - S:3.5~ / A:5.5~]
            'add_2d_hard': { type: 'math_step', digits: 2, op: '+', diff: 'hard', limits: [3.5, 5.5, 8.0] },
            'sub_2d_hard': { type: 'math_step', digits: 2, op: '-', diff: 'hard', limits: [3.5, 5.5, 8.0] },
            'add_3d_easy': { type: 'math_step', digits: 3, op: '+', diff: 'easy', limits: [3.5, 5.5, 8.0] },
            'sub_3d_easy': { type: 'math_step', digits: 3, op: '-', diff: 'easy', limits: [3.5, 5.5, 8.0] },
            'money_quiz': { type: 'money_quiz', limits: [3.0, 5.0, 7.0] },
            'unit_conversion': { type: 'unit_conversion', limits: [3.0, 5.0, 7.0] },
            'clock_quiz_hard': { type: 'clock_quiz', level: 'hard', limits: [3.0, 5.0, 7.0] },
            'mul_2d_1d': { type: 'complex_mul', d1: 2, d2: 1, limits: [3.0, 5.0, 8.0] },
            'div_rem_basic': { type: 'complex_div', hasRem: true, level: 'easy', limits: [3.0, 5.0, 8.0] },
            'fraction_basic': { type: 'fraction_basic', limits: [3.0, 5.0, 8.0] },

            // [5ë‹¨ê³„: ë…í•´ ë° ìµœìƒ ë‚œì´ë„]
            'add_3d_hard': { type: 'math_step', digits: 3, op: '+', diff: 'hard', limits: [4.5, 7.0, 10.0] },
            'sub_3d_hard': { type: 'math_step', digits: 3, op: '-', diff: 'hard', limits: [4.5, 7.0, 10.0] },
            'time_quiz_hard': { type: 'time_quiz', level: 'hard', limits: [4.0, 6.5, 9.0] },
            'schedule_quiz': { type: 'schedule_quiz', limits: [4.0, 7.0, 10.0] },
            'calendar_quiz': { type: 'calendar_quiz', limits: [4.0, 7.0, 10.0] },
            'scale_interactive': { type: 'scale_interactive', limits: [5.0, 8.0, 12.0] },
            'word_mixed': { type: 'word_problem', mode: 'mixed', limits: [5.0, 8.0, 12.0] },
            'word_mul_div': { type: 'word_problem', mode: 'mul_div', limits: [5.0, 8.0, 12.0] },
            'div_hard': { type: 'complex_div', hasRem: false, level: 'hard', limits: [5.0, 8.0, 12.0] },
            'div_estim': { type: 'div_estim', limits: [4.0, 7.0, 11.0] },
            'div_estim_hard': { type: 'div_estim_hard', limits: [4.0, 7.0, 11.0] },
            'reading_comp': { type: 'reading_comp', limits: [4.0, 9.0, 14.0] },
            'reading_comp_hard': { type: 'reading_comp_hard', limits: [6.0, 11.0, 19.0] },
            'mul_2d_2d': { type: 'complex_mul', d1: 2, d2: 2, limits: [10.0, 15.0, 25.0] },
            'mul_3d_2d': { type: 'complex_mul', d1: 3, d2: 2, limits: [15.0, 25.0, 40.0] },
            'div_rem_hard': { type: 'complex_div', hasRem: true, level: 'hard', limits: [6.0, 10.0, 15.0] }
        };

        // ==========================================
        // [8] ë¬¸ì œ ì¶œì œ ë©”ì¸ í•¨ìˆ˜ (Dispatcher)
        // ==========================================
        function generateProblem(subject) {
            const config = QUIZ_CONFIG[subject.id];
            
            // ì„¤ì •ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ë°˜í™˜
            if (!config) return { problem: "ì¤€ë¹„ ì¤‘", answer: "0", options: ["0"] };

            // [êµ­ì–´/ì˜ì–´ ê³„ì—´]
            if (config.type === 'lang') {
                if (config.subType === 'dictation') { // ë°›ì•„ì“°ê¸° (Step 5 ë¡œì§)
                    const qItem = config.bank[getRandomInt(0, config.bank.length - 1)];
                    const p = qItem.q.replace('â¬œ', '<span class="text-blue-600 border-b-2 border-blue-600 inline-block min-w-[50px] text-center px-1">?</span>');
                    
                    // ì˜¤ë‹µ ìƒì„± (ì¤‘ë³µ ì œê±°)
                    let uniqueOpts = new Set([qItem.a]);
                    if (qItem.d) qItem.d.forEach(w => { if(w !== qItem.a) uniqueOpts.add(w); });
                    while(uniqueOpts.size < 4) uniqueOpts.add("ì˜¤ë‹µ"+uniqueOpts.size);
                    
                    return { problem: `<span class="text-2xl md:text-3xl font-bold break-keep leading-relaxed">${p}</span>`, answer: qItem.a, options: shuffleArray(Array.from(uniqueOpts).slice(0,4)) };
                } 
                else if (config.subType === 'vocab') { // ì˜ë‹¨ì–´ (Step 5 ë¡œì§)
                    const qIdx = getRandomInt(0, config.bank.length - 1);
                    const qItem = config.bank[qIdx];
                    let o = new Set([qItem.a]);
                    while(o.size < 4) {
                        const wrong = config.bank[getRandomInt(0, config.bank.length - 1)].a;
                        if (wrong !== qItem.a) o.add(wrong);
                    }
                    return { problem: `<span class="text-4xl font-bold text-indigo-600">${qItem.q}</span>`, answer: qItem.a, options: shuffleArray(Array.from(o)) };
                }
                else { // ììŒ/ëª¨ìŒ (Step 7 ë¡œì§)
                    return generateLangQuiz(config.type, config.subType, config.bank);
                }
            }

            // [ë…í•´ ê³„ì—´] (Step 4 ë¡œì§)
            if (config.type === 'reading_comp') return generateReadingQuiz();
            if (config.type === 'reading_comp_hard') return generateReadingQuizHard();

            // [ê¸°ì´ˆ ìˆ˜í•™/ê·œì¹™] (Step 7 ë¡œì§)
            if (config.type === 'number_bond') return generateNumberBondQuiz();
            if (config.type === 'compare_size') return generateCompareSizeQuiz(config.level);
            if (config.type === 'group_counting') return generateGroupCountingQuiz();
            if (config.type === 'number_system') return generateNumberSystemQuiz(config.level); // Step 5
            if (config.type === 'alphabet') return generateAlphabetQuiz(config.mode); // Step 5
            if (config.type === 'skip_counting') { // Step 5 skip_counting logic inline or mapped
                 const iv = [2,5,10][getRandomInt(0,2)]; 
                 const st = getRandomInt(1,10)*iv; 
                 const seq = [st, st+iv, st+2*iv];
                 const ansIdx = getRandomInt(0,2);
                 const ans = seq[ansIdx];
                 seq[ansIdx] = '<span class="text-yellow-500 border-b-2 border-yellow-500">?</span>';
                 let o = new Set([ans]);
                 while(o.size<4) { let wa = ans + getRandomInt(-2,2)*iv; if(wa>0 && wa!==ans) o.add(wa); }
                 return { problem: `<span class="text-4xl font-black text-gray-800 tracking-wider">${seq.join(' â†’ ')}</span>`, answer: ans, options: shuffleArray(Array.from(o)) };
            }

            // [ì—°ì‚° ê³„ì—´]
            if (config.type === 'math') return generateMathQuiz(config.operator, config.min, config.max); // Step 5
            if (config.type === 'math_step') return generateMathSteppedQuiz(config.op, config.digits, config.diff); // Step 5
            if (config.type === 'complex_mul') return generateComplexMul(config.d1, config.d2); // Step 5
            if (config.type === 'complex_div') return generateComplexDiv(config.hasRem, config.level); // Step 5
            if (config.type === 'div_estim') return generateDivEstim(); // Step 5
            if (config.type === 'div_estim_hard') return generateDivEstimHard(); // Step 5
            if (config.type === 'fraction_basic') return generateFractionBasicQuiz(); // Step 7

            // [ìƒí™œ/ì‘ìš© ê³„ì—´]
            if (config.type === 'clock_quiz') return generateClockQuiz(config.level); // Step 7 (visual fix)
            if (config.type === 'money_quiz') return generateMoneyQuiz(); // Step 5
            if (config.type === 'unit_conversion') return generateUnitProblem(); // Step 5
            if (config.type === 'time_quiz') return generateTimeProblem(config.level); // Step 6
            if (config.type === 'calendar_quiz') return generateCalendarQuestion(); // Step 6
            if (config.type === 'schedule_quiz') return generateScheduleQuiz(); // Step 6
if (config.type === 'word_problem') return generateWordProblem(config.mode);
            if (config.type === 'scale_interactive') return generateInteractiveScale(); // [ìˆ˜ì •ë¨] Code 2 ë¡œì§ ì‚¬ìš©
            if (config.type === 'recycle') return generateRecycleQuiz();

            return generateMathSteppedQuiz('+', 1, 'easy'); // Default fallback
        }

        // ==========================================
        // [9] ê²Œì„ ì§„í–‰ ë¡œì§ (Code 1 + Code 2 í†µí•©)
        // ==========================================

        function nextQuiz() {
            // 1. ë¬¸ì œ ë°ì´í„° ìƒì„±
            const q = generateProblem(AppState.currentSubject);
            currentQuiz = q; // ì „ì—­ ë³€ìˆ˜ì— ì €ì¥ (ì •ë‹µ ì²´í¬ìš©)

            // 2. ë¬¸ì œ ì˜ì—­(HTML) ë Œë”ë§
            const contentArea = document.getElementById('quiz-content-area');
            
            // [íŠ¹ìˆ˜ ë°ì´í„° ì²˜ë¦¬] ë…í•´/ë‹¬ë ¥/ì¼ê³¼í‘œ/ê·¸ë¦¼ìë£Œê°€ ìˆëŠ” ê²½ìš° 'ë³´ê¸°' ë²„íŠ¼ ìƒì„±
            let extraButtonHtml = "";
            currentModalContent = ""; // ëª¨ë‹¬ ë‚´ìš© ì´ˆê¸°í™”

            if (q.readingData) {
                // ë…í•´ ì§€ë¬¸ (Code 2 ìŠ¤íƒ€ì¼)
                currentModalContent = `<div class="text-left"><h3 class="text-xl font-bold mb-4 border-b pb-2">${q.readingData.title}</h3><div class="reading-content-wrapper">${q.readingData.content}</div></div>`;
                extraButtonHtml = `<button onclick="showDataModal()" class="mb-4 bg-gray-400 hover:bg-gray-500 text-black font-bold py-2 px-6 rounded-full shadow-md transition animate-bounce">ì§€ë¬¸ ë³´ê¸°</button>`;
            } 
            else if (q.monthData) {
                // ë‹¬ë ¥
                const calHtml = getCalendarHTML(q.monthData);
                currentModalContent = `<div class="p-2">${calHtml}</div>`;
                extraButtonHtml = `<button onclick="showDataModal()" class="mb-4 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-6 rounded-full shadow-md transition">ë‹¬ë ¥ ë³´ê¸°</button>`;
            }
            else if (q.scheduleData) {
                // ì¼ê³¼í‘œ
                let schHtml = '<div class="w-full text-left flex flex-col gap-2">';
                q.scheduleData.items.forEach(item => {
                    schHtml += `<div class="flex justify-between items-center p-3 border-b"><span class="font-bold text-orange-600 w-24">${item.t}</span><span class="font-bold text-gray-800">${item.a}</span></div>`;
                });
                schHtml += '</div>';
                currentModalContent = `<div class="p-2"><h3 class="font-bold text-xl mb-4 text-center">${q.scheduleData.title}</h3>${schHtml}</div>`;
                extraButtonHtml = `<button onclick="showDataModal()" class="mb-4 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-6 rounded-full shadow-md transition">ì¼ê³¼í‘œ ë³´ê¸°</button>`;
            }
            else if (q.visualData) {
                // ê·¸ë¦¼ ìë£Œ (ë¬¶ì–´ ì„¸ê¸° ë“±)
                currentModalContent = `<div class="p-4 flex justify-center">${q.visualData.html}</div>`;
                extraButtonHtml = `<button onclick="showDataModal()" class="mb-4 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-6 rounded-full shadow-md transition">ê·¸ë¦¼ ë³´ê¸°</button>`;
            }

            // 3. ìµœì¢… HTML ì¡°ë¦½
// 3. ìµœì¢… HTML ì¡°ë¦½
            let innerContent = "";

            // [A] ì €ìš¸ ê²Œì„ UI (Code 2 ìŠ¤íƒ€ì¼ ë²„íŠ¼ ì£¼ì…)
  if (q.type === 'scale_interactive') {
                AppState.scaleState = { current: 0, target: q.target };
                innerContent = `
                    <div class="flex flex-col items-center gap-4 w-full justify-start pt-2">
                        <div class="bg-gray-50 border-2 border-gray-200 px-2 py-1 rounded-2xl shadow-sm text-center">
                        
                            <div class="text-[20px] font-black text-gray-900">
                                ëª©í‘œ: <span class="text-gray-600">${q.target}g</span>
                            </div>
                        </div>
                        <canvas id="scale-canvas" width="150" height="150" class="w-[150px] h-[150px] bg-gray-100 rounded-xl border border-gray-300 shadow-inner"></canvas>
                    </div>
                `;
                // ... (ì˜µì…˜ ë²„íŠ¼ êµì²´ ë¡œì§ ìœ ì§€) ...
                setTimeout(() => {
                    const optDiv = document.getElementById('quiz-options');
                    optDiv.className = "h-auto bg-white border-t border-gray-200 p-4 grid grid-cols-3 gap-2 shrink-0";
                    optDiv.innerHTML = `
                        <button onclick="updateScaleWeight(-10)" class="p-4 bg-red-100 text-red-600 font-bold rounded-xl border border-red-200 active:scale-95">-10g</button>
                        <button onclick="updateScaleWeight(-1)" class="p-4 bg-red-50 text-red-500 font-bold rounded-xl border border-red-100 active:scale-95">-1g</button>
                        <button onclick="checkAnswer(AppState.scaleState.current)" class="row-span-2 bg-blue-600 text-white font-black text-xl rounded-xl shadow-lg active:scale-95 hover:bg-blue-700">ì œì¶œ</button>
                        <button onclick="updateScaleWeight(10)" class="p-4 bg-blue-100 text-blue-600 font-bold rounded-xl border border-blue-200 active:scale-95">+10g</button>
                        <button onclick="updateScaleWeight(1)" class="p-4 bg-blue-50 text-blue-500 font-bold rounded-xl border border-blue-100 active:scale-95">+1g</button>
                    `;
                    drawInteractiveScale('scale-canvas', 0);
                }, 50);
            }
            // [B] ì‹œê³„ UI
else if (AppState.currentSubject.id.includes('clock')) {
                // [ìˆ˜ì • í¬ì¸íŠ¸] w-[240px] -> ëª¨ë°”ì¼ / md:w-[280px] -> PC
                innerContent = `
                    <div class="flex flex-col items-center justify-start h-full w-full gap-4 pt-1">
                        <div class="relative w-[200px] h-[200px] md:w-[240px] md:h-[240px] bg-white rounded-full border-4 border-gray-800 shadow-xl">
                            <canvas id="t-canvas" width="400" height="400" class="w-full h-full block rounded-full"></canvas>
                        </div>
                        <div class="text-2xl md:text-3xl font-black text-gray-800 bg-gray-100 px-6 py-2 rounded-full">ëª‡ ì‹œ ëª‡ ë¶„?</div>
                    </div>
                `;
                q.render = () => drawClock('t-canvas', q.h, q.m);
            }
            // [C] ì¼ë°˜ ë¬¸ì œ (ë ˆì´ì•„ì›ƒ ì •ë¦¬)
            else {
                innerContent = `
                    ${extraButtonHtml}
                    <div class="w-full flex items-center justify-center">
                        ${q.problem}
                    </div>
                `;
            }

            // [ì¤‘ìš”] CSSì—ì„œ padding-topì„ ì£¼ì—ˆì§€ë§Œ, êµ¬ì¡°ì ìœ¼ë¡œ problem-content í´ë˜ìŠ¤ê°€ ì ìš©ë˜ë„ë¡ í™•ì‹¤íˆ í•¨
            contentArea.innerHTML = `<div class="problem-content">${innerContent}</div>`;

            // 4. ìº”ë²„ìŠ¤ ë Œë”ë§
            if (q.render && q.type !== 'scale_interactive') {
                setTimeout(q.render, 50); 
            }

            // 5. ë³´ê¸° ë²„íŠ¼ ìƒì„±
            if (q.type !== 'scale_interactive') {
                const optDiv = document.getElementById('quiz-options'); 
                optDiv.className = "h-auto min-h-[20%] bg-white border-t border-gray-200 p-4 grid grid-cols-2 gap-3 shrink-0"; 
                optDiv.innerHTML = "";
                q.options.forEach(opt => { 
                    optDiv.innerHTML += `<button onclick="checkAnswer('${opt}')" class="quiz-option-btn hover:bg-gray-50 active:scale-95">${opt}</button>`; 
                });
            }
        }

        // [9-2] ì •ë‹µ í™•ì¸
        function checkAnswer(val) {
            const isCorrect = String(val) === String(currentQuiz.answer);
            const feedback = document.getElementById('quiz-feedback'); 
            const icon = document.getElementById('feedback-icon');
            
            feedback.classList.remove('hidden');
            if (isCorrect) { 
                AppState.currentScore += 2; 
                icon.innerText = "O"; 
                icon.className = "text-9xl font-black text-green-500 fade-in drop-shadow-lg"; 
            } else { 
                AppState.currentScore = Math.max(0, AppState.currentScore - 2); 
                icon.innerText = "X"; 
                icon.className = "text-9xl font-black text-red-400 fade-in drop-shadow-lg"; 
            }
            
            updateScoreUI(); 
            
            // 0.5ì´ˆ í›„ ë‹¤ìŒ ë¬¸ì œ ë˜ëŠ” ì¢…ë£Œ
            setTimeout(() => { 
                feedback.classList.add('hidden'); 
                if (AppState.currentScore >= TARGET_SCORE) finishGameSuccess(); 
                else nextQuiz(); 
            }, 500);
        }

        function updateScoreUI() { 
            document.getElementById('current-quiz-score').innerText = AppState.currentScore; 
        }

        // [9-3] ê²Œì„ ì„±ê³µ ì¢…ë£Œ
        function finishGameSuccess() {
            clearInterval(AppState.timerInterval);
            const totalTime = (Date.now() - AppState.quizStartTime) / 1000; 
            
            // Code 2ì˜ ë­í‚¹ ê³„ì‚° ë¡œì§ ì ìš© (Sì»· ë“±)
            const rank = getRank(totalTime, TARGET_SCORE); // Step 5ì˜ getRank í•¨ìˆ˜ ì‚¬ìš©
            const score = RANK_SCORE[rank] || 70;
            
            const newRec = { 
                userId: AppState.user.id, 
                subjectId: AppState.currentSubject.id, 
                subjectName: AppState.currentSubject.name, 
                rank, 
                time: totalTime, 
                score, 
                date: new Date().toISOString() 
            };
            saveRecordToServer(newRec);

            const resView = document.getElementById('quiz-result-view'); 
            
            // ë­í‚¹ë³„ ìŠ¤íƒ€ì¼ ì ìš©
            const rankEl = document.getElementById('result-rank');
            rankEl.innerText = rank;
            rankEl.className = "text-6xl font-black rank-text-" + rank.toLowerCase().replace('+','p'); // SSS -> rank-text-sss
            if(!rankEl.className.includes('rank-text-')) rankEl.className = "text-6xl font-black text-gray-800"; // Fallback

            document.getElementById('result-time').innerText = totalTime.toFixed(1) + 's'; 
            resView.classList.remove('hidden'); 
            resView.classList.add('flex');
        }

        function finishQuiz() { clearInterval(AppState.timerInterval); goDashboard(); }
        
function goDashboard() {
    // [ì¶”ê°€ë¨] ëª¨ë°”ì¼ì—ì„œ ì‚¬ì´ë“œë°”ê°€ ì—´ë ¤ìˆë‹¤ë©´ ë‹«ê¸°
    if(sidebarOpen) toggleSidebar();

    ['quiz-result-view', 'quiz-ready-screen', 'view-teacher-status', 'view-my-info', 'view-student', 'view-teacher', 'view-learning'].forEach(id => document.getElementById(id).classList.add('hidden')); 
    document.getElementById('quiz-result-view').classList.remove('flex');
    document.getElementById('view-dashboard').classList.remove('hidden'); 
    document.getElementById('header-title').innerText = "ì¹ íŒ"; 
    updateRankingBoard();
}
   // ==========================================
        // [10] ë©”ë‰´ ë°ì´í„° êµ¬ì„± (Code 2ì˜ ëª¨ë“  ì£¼ì œ í¬í•¨)
        // ==========================================
// ==========================================
// [10] ë©”ë‰´ ë°ì´í„° êµ¬ì„± (ìˆ˜í•™ 4ê°œ ì¹´í…Œê³ ë¦¬ë¡œ ì„¸ë¶„í™”)
// ==========================================
const MenuData = [
    {
        category: "êµ­ì–´", 
        items: [
            { id: "k_consonant", name: "ììŒ í€´ì¦ˆ (ã„±~ã…)" },
            { id: "k_vowel", name: "ëª¨ìŒ í€´ì¦ˆ (ì•„~ì´)" },
            { id: "dict_single", name: "ë°›ì•„ì“°ê¸° (í™‘ë°›ì¹¨)" },
            { id: "dict_complex", name: "ë°›ì•„ì“°ê¸° (ê²¹ë°›ì¹¨)" },
            { id: "reading_comp", name: "ì•ˆë‚´ë¬¸ ë…í•´ (ê¸°ì´ˆ)" },
            { id: "reading_comp_hard", name: "ì•ˆë‚´ë¬¸ ë…í•´ (ì‹¬í™”)" }
        ]
    },
    {
        category: "ìˆ˜í•™: ê¸°ì´ˆ & ê·œì¹™", 
        items: [
            { id: "number_system_easy", name: "ìˆ˜ ì„¸ê¸° (1~10)" },
            { id: "number_system_hard", name: "ìˆ˜ ì„¸ê¸° (1~100)" },
            { id: "compare_size_easy", name: "í¬ê¸° ë¹„êµ (ê·¸ë¦¼)" },
            { id: "compare_size_hard", name: "í¬ê¸° ë¹„êµ (ìˆ«ì)" },
            { id: "number_bond", name: "ìˆ˜ ëª¨ìœ¼ê¸°/ê°€ë¥´ê¸°" },
            { id: "group_counting", name: "ë¬¶ì–´ ì„¸ê¸°" },
            { id: "skip_counting", name: "ë›°ì–´ ì„¸ê¸° (ê·œì¹™)" },
            { id: "mul_99", name: "êµ¬êµ¬ë‹¨ ì™¸ìš°ê¸°" }
        ]
    },
    {
        category: "ìˆ˜í•™: ë§ì…ˆ & ëº„ì…ˆ", 
        items: [
            { id: "add_1d", name: "1ìë¦¬ ë§ì…ˆ" },
            { id: "sub_1d", name: "1ìë¦¬ ëº„ì…ˆ" },
            { id: "add_2d_easy", name: "2ìë¦¬ ë§ì…ˆ (ê¸°ì´ˆ)" },
            { id: "add_2d_hard", name: "2ìë¦¬ ë§ì…ˆ (ì˜¬ë¦¼)" },
            { id: "sub_2d_easy", name: "2ìë¦¬ ëº„ì…ˆ (ê¸°ì´ˆ)" },
            { id: "sub_2d_hard", name: "2ìë¦¬ ëº„ì…ˆ (ë‚´ë¦¼)" },
            { id: "add_3d_easy", name: "3ìë¦¬ ë§ì…ˆ (ê¸°ì´ˆ)" },
            { id: "add_3d_hard", name: "3ìë¦¬ ë§ì…ˆ (ì˜¬ë¦¼)" },
            { id: "sub_3d_easy", name: "3ìë¦¬ ëº„ì…ˆ (ê¸°ì´ˆ)" },
            { id: "sub_3d_hard", name: "3ìë¦¬ ëº„ì…ˆ (ë‚´ë¦¼)" }
        ]
    },
    {
        category: "ìˆ˜í•™: ê³±ì…ˆ & ë‚˜ëˆ—ì…ˆ", 
        items: [
            { id: "mul_2d_1d", name: "2ìë¦¬ Ã— 1ìë¦¬" },
            { id: "mul_2d_2d", name: "2ìë¦¬ Ã— 2ìë¦¬" },
            { id: "mul_3d_2d", name: "3ìë¦¬ Ã— 2ìë¦¬" },
            { id: "div_basic", name: "ë‚˜ëˆ—ì…ˆ (êµ¬êµ¬ë‹¨)" },
            { id: "div_hard", name: "ë‚˜ëˆ—ì…ˆ (í° ìˆ˜)" },
            { id: "div_rem_basic", name: "ë‚˜ë¨¸ì§€ ìˆëŠ” ë‚˜ëˆ—ì…ˆ (í•˜)" },
            { id: "div_rem_hard", name: "ë‚˜ë¨¸ì§€ ìˆëŠ” ë‚˜ëˆ—ì…ˆ (ìƒ)" },
            { id: "div_estim", name: "ëª« ì–´ë¦¼í•˜ê¸° (ê¸°ì´ˆ)" },
            { id: "div_estim_hard", name: "ëª« ì–´ë¦¼í•˜ê¸° (ì‹¬í™”)" }
        ]
    },
    {
        category: "ìˆ˜í•™: ë¶„ìˆ˜ & ì†Œìˆ˜", 
        items: [
            { id: "fraction_basic", name: "ë¶„ìˆ˜ ê¸°ì´ˆ (í†µí•©)" }
        ]
    },
    {
        category: "ì˜ì–´", 
        items: [
            { id: "life_eng", name: "ìƒí™œ ì˜ì–´ ë‹¨ì–´" },
            { id: "alpha_order", name: "ì•ŒíŒŒë²³ ìˆœì„œ" },
            { id: "alpha_case", name: "ëŒ€ì†Œë¬¸ì ì§ê¿" },
            { id: "alpha_sound", name: "ì•ŒíŒŒë²³ ì½ê¸°" }
        ]
    },
    {
        category: "ìƒí™œ", 
        items: [
            { id: "clock_quiz_easy", name: "ì‹œê³„ ë³´ê¸° (ì •ê°/30ë¶„)" },
            { id: "clock_quiz_hard", name: "ì‹œê³„ ë³´ê¸° (1ë¶„ ë‹¨ìœ„)" },
            { id: "time_quiz_easy", name: "ì‹œê°„ ê³„ì‚° (ê¸°ì´ˆ)" },
            { id: "time_quiz_hard", name: "ì‹œê°„ ê³„ì‚° (ì‹¬í™”)" },
            { id: "calendar_quiz", name: "ë‹¬ë ¥ ë³´ê¸°" },
            { id: "schedule_quiz", name: "ì¼ê³¼í‘œ ë¶„ì„" },
            { id: "money_quiz", name: "ëˆ ê³„ì‚° (ë”ì¹˜í˜ì´/ì €ì¶•)" },
            { id: "unit_conversion", name: "ë‹¨ìœ„ ë³€í™˜ (ê¸¸ì´/ë¬´ê²Œ/ì‹œê°„)" },
            { id: "word_mixed", name: "ë¬¸ì¥ì œ (ë§ì…ˆ/ëº„ì…ˆ)" },
            { id: "word_mul_div", name: "ë¬¸ì¥ì œ (ê³±ì…ˆ/ë‚˜ëˆ—ì…ˆ)" },
            { id: "scale_interactive", name: "ì „ìì €ìš¸ ì½ê¸°" },
            { id: "recycle_practice", name: "ë¶„ë¦¬ìˆ˜ê±° ì™•" }
        ]
    }
];

        // ==========================================
        // [11] ì„ ìƒë‹˜ ê¸°ëŠ¥ (ì¹ íŒ & í˜„í™©íŒ)
        // ==========================================

        // [11-1] ì¹ íŒ ëª¨ë“œ ì‹¤í–‰
  // [11-1] ì¹ íŒ ëª¨ë“œ ì‹¤í–‰
function openTeacherBoard() {
    document.getElementById('view-dashboard').classList.add('hidden'); 
    document.getElementById('view-teacher').classList.remove('hidden'); 
    document.getElementById('board-title').innerText = AppState.currentSubject.name;
    
    // [ì¶”ê°€] ì¹ íŒ ì—´ ë•Œ í•„ê¸°ëª¨ë“œë¡œ ì´ˆê¸°í™”
    isBoardDrawMode = false; // toggle í•¨ìˆ˜ì—ì„œ ë°˜ì „ì‹œí‚¤ë¯€ë¡œ falseë¡œ ì„¤ì • í›„ í˜¸ì¶œí•˜ì—¬ trueë¡œ ë§Œë“¦
    toggleBoardMode(); 

    const cvs = document.getElementById('board-canvas');
    const parent = cvs.parentElement; 
    
    // ì¹ íŒ ê·¸ë¦¬ê¸° ì˜ì—­ í¬ê¸° ì´ˆê¸°í™”
    cvs.width = parent.offsetWidth; 
    cvs.height = parent.offsetHeight;
    const ctx = cvs.getContext('2d'); 
    ctx.clearRect(0, 0, cvs.width, cvs.height);
    
    const q = generateProblem(AppState.currentSubject);
    let content = "";
    let extraRender = null;

    // [1] ì‹œê³„ ë¬¸ì œ (ID ë³€ê²½: t-canvas -> board-sub-canvas)
    if (AppState.currentSubject.id.includes('clock') || (q.type && q.type.includes('clock'))) {
        content = `
            <div class="flex flex-col items-center justify-center w-full h-full pointer-events-auto">
                <canvas id="board-sub-canvas" width="400" height="400" class="bg-white rounded-full border-4 border-gray-800 shadow-xl mb-4"></canvas>
                <div class="text-3xl font-black text-gray-900 drop-shadow-md">ì‹œê³„ê°€ ë‚˜íƒ€ë‚´ëŠ” ì‹œê°ì€?</div>
            </div>`;
        
        let h = 0, m = 0;
        if (q.h !== undefined) { h = q.h; m = q.m; } 
        else {
            const nums = String(q.answer).match(/\d+/g);
            if (nums) { h = parseInt(nums[0]); m = parseInt(nums[1]); }
        }
        extraRender = () => drawClock('board-sub-canvas', h, m);
    } 
    // [2] ì €ìš¸ ë¬¸ì œ (ID ë³€ê²½: t-canvas -> board-sub-canvas)
    else if (AppState.currentSubject.id.includes('scale') || (q.type && q.type.includes('scale'))) {
        content = `
            <div class="flex flex-col items-center justify-center w-full h-full pointer-events-auto gap-6">
                <canvas id="board-sub-canvas" width="300" height="400" class="bg-gray-100 rounded-xl border-2 border-gray-500 shadow-xl"></canvas>
                <div class="text-4xl font-black text-gray-900 drop-shadow-md">ì •ë‹µ ë¬´ê²Œ: ${q.answer}g</div>
            </div>`;
        const weight = parseInt(q.answer) || q.target;
        extraRender = () => drawInteractiveScale('board-sub-canvas', weight);
    }
    // [3] ì¼ë°˜ í…ìŠ¤íŠ¸/ë…í•´/í‘œ ë¬¸ì œ
    else {
        let displayHtml = q.problem;
        
        if (q.readingData) {
            displayHtml = `<div class="text-lg text-left w-full max-w-3xl bg-white p-6 rounded-xl border border-gray-300 mb-6 max-h-[50vh] overflow-y-auto shadow-xl pointer-events-auto text-black">${q.readingData.content}</div><div class="text-5xl font-black text-gray-900 drop-shadow-md">${q.problem}</div>`;
        }
        else if (q.monthData) {
            displayHtml = `<div class="bg-white p-4 rounded border border-gray-300 mb-4 shadow-sm pointer-events-auto">${getCalendarHTML(q.monthData)}</div><div class="text-4xl font-bold text-white drop-shadow-md">${q.problem}</div>`;
        }
        else if (q.scheduleData) {
            let schHtml = '<div class="w-full bg-white rounded border border-gray-300 overflow-hidden text-black text-sm max-w-md mx-auto mb-4 pointer-events-auto">';
            q.scheduleData.items.forEach(item => {
                schHtml += `<div class="flex justify-between items-center p-3 border-b border-gray-100 last:border-0"><span class="font-bold text-gray-900 w-20">${item.t}</span><span class="text-gray-700">${item.a}</span></div>`;
            });
            schHtml += '</div>';
            displayHtml = `${schHtml}<div class="text-3xl font-bold text-gray-900 drop-shadow-md">${q.problem}</div>`;
        }
        else {
            // ì¼ë°˜ í…ìŠ¤íŠ¸ ë¬¸ì œ (í°íŠ¸ í‚¤ì›€)
            displayHtml = `<div class="text-6xl font-black text-gray-900 drop-shadow-xl break-keep leading-tight">${q.problem}</div>`;
        }

        content = `<div class="w-full h-full flex flex-col items-center justify-center p-8 text-center select-none">${displayHtml}</div>`;
    }

    // ì •ë‹µ ë³´ê¸° ë²„íŠ¼ (ìš°ì¸¡ í•˜ë‹¨ ê³ ì •)
    const ansBtn = `
        <div onclick="this.innerText='ì •ë‹µ: ${q.answer}'; this.classList.remove('bg-gray-200', 'text-gray-500'); this.classList.add('bg-black', 'text-gray-900', 'border-white');" 
             class="cursor-pointer absolute bottom-8 right-8 text-xl font-black text-gray-500 bg-gray-200 border-2 border-gray-400 px-8 py-4 rounded-xl shadow-2xl z-[60] select-none hover:scale-105 transition pointer-events-auto">
            ì •ë‹µ ë³´ê¸°
        </div>`;

    document.getElementById('board-overlay').innerHTML = content + ansBtn;

    // ë Œë”ë§ í ì‹¤í–‰ (ì•½ê°„ì˜ ì§€ì—°ì‹œê°„ í™•ë³´)
    if (extraRender) setTimeout(extraRender, 100);
}
        function generateBoardProblem() { openTeacherBoard(); }
        
 function clearBoard() { 
            const c = document.getElementById('board-canvas'); 
            const ctx = c.getContext('2d'); 
            ctx.clearRect(0, 0, c.width, c.height); 
            // ë¬¸ì œëŠ” ì§€ìš°ì§€ ì•Šê³  í•„ê¸°ë§Œ ì§€ì›€. ë¬¸ì œë¥¼ ì§€ìš°ë ¤ë©´ ë‹¤ì‹œ 'ë¬¸ì œ ë„ìš°ê¸°'
        }

        // [ì¶”ê°€] ì¹ íŒ ëª¨ë“œ í† ê¸€ (í•„ê¸° <-> í´ë¦­)
        let isBoardDrawMode = true;
        function toggleBoardMode() {
            isBoardDrawMode = !isBoardDrawMode;
            const cvs = document.getElementById('board-canvas');
            const btn = document.getElementById('btn-board-mode');
            
            if (isBoardDrawMode) {
                // í•„ê¸° ëª¨ë“œ: ìº”ë²„ìŠ¤ ì…ë ¥ í™œì„±í™”, ë²„íŠ¼ ì´ˆë¡ìƒ‰
                cvs.classList.remove('pointer-events-none');
                btn.className = "bg-green-600 hover:bg-green-500 text-gray-900 px-3 py-2 rounded-lg text-sm font-bold border border-green-700 shadow transition flex items-center gap-2";
                btn.innerHTML = '<i class="fas fa-pen"></i> <span>í•„ê¸°ëª¨ë“œ</span>';
            } else {
                // í´ë¦­ ëª¨ë“œ: ìº”ë²„ìŠ¤ ì…ë ¥ ë¬´ì‹œ(ë’¤ìª½ ë²„íŠ¼ í´ë¦­ ê°€ëŠ¥), ë²„íŠ¼ íŒŒë€ìƒ‰
                cvs.classList.add('pointer-events-none');
                btn.className = "bg-blue-600 hover:bg-blue-500 text-gray-900 px-3 py-2 rounded-lg text-sm font-bold border border-blue-700 shadow transition flex items-center gap-2";
                btn.innerHTML = '<i class="fas fa-mouse-pointer"></i> <span>í´ë¦­ëª¨ë“œ</span>';
            }
        }
        
        // [11-2] ì¹ íŒ ê·¸ë¦¬ê¸° ë¡œì§
        let isDrawing = false; let lastX = 0; let lastY = 0; let brushColor = '#000000';
        function initBoard() {
            const canvas = document.getElementById('board-canvas'); 
            const ctx = canvas.getContext('2d');
            
            function getPos(e) { 
                const rect = canvas.getBoundingClientRect();
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                return { x: clientX - rect.left, y: clientY - rect.top }; 
            }

            function startDraw(e) { 
                e.preventDefault(); 
                isDrawing = true; 
                const { x, y } = getPos(e); 
                lastX = x; lastY = y; 
            }
            
            function draw(e) { 
                if (!isDrawing) return; 
                e.preventDefault();
                const { x, y } = getPos(e); 
                ctx.beginPath(); 
                ctx.moveTo(lastX, lastY); 
                ctx.lineTo(x, y); 
                ctx.strokeStyle = brushColor; 
                ctx.lineWidth = 3; 
                ctx.lineCap = 'round'; 
                ctx.lineJoin = 'round'; 
                ctx.stroke(); 
                lastX = x; lastY = y; 
            }
            
            function stopDraw() { isDrawing = false; }
            
            canvas.addEventListener('mousedown', startDraw); canvas.addEventListener('mousemove', draw); canvas.addEventListener('mouseup', stopDraw); canvas.addEventListener('mouseout', stopDraw);
            canvas.addEventListener('touchstart', startDraw); canvas.addEventListener('touchmove', draw); canvas.addEventListener('touchend', stopDraw);
        }
        function setPen(c) { brushColor = c; }

        // [11-3] í•™ê¸‰ í˜„í™©íŒ
  function openTeacherStatus() {
    // [ìˆ˜ì •] í•™ê¸‰ í˜„í™© í´ë¦­ ì‹œ ì‚¬ì´ë“œë°” ë‹«ê¸°
    if(sidebarOpen) toggleSidebar();

    updateTeacherStatusBoard(); 
    document.getElementById('view-teacher-status').classList.remove('hidden');
}
        function closeTeacherStatus() { document.getElementById('view-teacher-status').classList.add('hidden'); }
        
        function updateTeacherStatusBoard() {
            const st = AppState.users.filter(u => u.role === 'student'); 
            const subs = MenuData.flatMap(c => c.items);
            
            document.getElementById('status-table-head').innerHTML = `<th class="px-6 py-3 bg-gray-50 sticky left-0 z-10 border-r">ì´ë¦„</th>` + subs.map(s => `<th class="px-4 py-3 text-center text-[10px] whitespace-nowrap">${s.name}</th>`).join('');
            
            document.getElementById('status-table-body').innerHTML = st.map(s => {
                let r = `<td class="px-6 py-3 font-bold sticky left-0 bg-white border-r group cursor-pointer hover:bg-purple-50 transition" onclick="openMyInfo('${s.id}')"><span class="border-b-2 border-transparent group-hover:border-purple-500 transition">${s.name}</span></td>`;
                subs.forEach(sub => { 
              const myRecs = AppState.records.filter(r => String(r.userId) === String(s.id) && r.subjectId === sub.id);
                    let best = null; 
                    if (myRecs.length > 0) best = myRecs.reduce((prev, curr) => (curr.score > prev.score || (curr.score === prev.score && curr.time < prev.time)) ? curr : prev); 
                    
                    let cellClass = "text-gray-300";
                    let cellText = "-";
                    
                    if(best) {
                        cellText = best.rank;
                        if(best.rank.includes('S')) cellClass = "text-purple-600 font-black";
                        else if(best.rank.includes('A')) cellClass = "text-pink-500 font-bold";
                        else if(best.rank.includes('B')) cellClass = "text-blue-500 font-bold";
                        else cellClass = "text-gray-600";
                    }
                    r += `<td class="px-4 py-3 text-center text-xs ${cellClass}">${cellText}</td>`; 
                });
                return `<tr>${r}</tr>`;
            }).join('') || `<tr><td colspan="100" class="p-8 text-center text-gray-400">ë°ì´í„° ì—†ìŒ</td></tr>`;
        }

        // ==========================================
        // [12] ê°œì¸ ì„±ì í‘œ ëª¨ë‹¬ (ìƒì„¸ ê¸°ë¡)
        // ==========================================
 // [ìˆ˜ì •ë¨] ë‚´ ì„±ì í‘œ (ê³µë°± ì œê±° ë° íƒ€ì… í†µì¼ ì ìš©)
function openMyInfo(targetId = null) {
    // [ìˆ˜ì •] ì„±ì í‘œ í´ë¦­ ì‹œ ì‚¬ì´ë“œë°” ë‹«ê¸°
    if(sidebarOpen) toggleSidebar();

    document.getElementById('view-my-info').classList.remove('hidden');
            
    // 1. ì‚¬ìš©ì ì°¾ê¸°
    const targetUser = targetId 
        ? AppState.users.find(u => String(u.id).trim() === String(targetId).trim()) 
        : AppState.user;
            
    if (!targetUser) return;
            
    // 2. ê¸°ë¡ ì§‘ê³„ (í•µì‹¬ ìˆ˜ì •: ì„œë²„ì—ì„œ ë°›ì€ records ì „ì²´ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ , ë­í‚¹ ë³´ë“œì—ì„œ ì‚¬ìš©í•œ 'ìµœê³  ê¸°ë¡' ì§‘ê³„ ë¡œì§ ì¬ì‚¬ìš©)
    
    // ì´ ë¡œì§ì´ ì„œë²„ ê¸°ë¡(Records ì‹œíŠ¸)ì—ì„œ ê³¼ëª©ë³„ ìµœê³  ê¸°ë¡ 1ê°œë§Œ ê³¨ë¼ëƒ…ë‹ˆë‹¤.
    const uniqueBest = {}; 
    let totalScore = 0;
    let sssCount = 0;

    // A. í•´ë‹¹ ì‚¬ìš©ìì˜ ëª¨ë“  ê¸°ë¡ í•„í„°ë§
    const userRecords = AppState.records.filter(r => 
        String(r.userId).trim() === String(targetUser.id).trim() && r.subjectId !== 'point'
    );
    
    // B. ê¸°ë¡ ì§‘ê³„ ë° ìµœê³ ì  ì¶”ì¶œ
    userRecords.forEach(r => {
        // Records ì‹œíŠ¸ëŠ” ì´ë¯¸ ìµœê³  ê¸°ë¡ë§Œ ì €ì¥í•˜ê³  ìˆìœ¼ë¯€ë¡œ, í•„í„°ë§ë§Œ ìˆ˜í–‰í•©ë‹ˆë‹¤.
        // í•˜ì§€ë§Œ í˜¹ì‹œ ëª¨ë¥¼ ë¡œì»¬ ê¸°ë¡ ì”ì¡´ì´ë‚˜ ì„œë²„ í†µì‹  ì˜¤ë¥˜ì— ëŒ€ë¹„í•˜ì—¬ ì¤‘ë³µ ì œê±° ë¡œì§ì„ í•œë²ˆ ë” ì ìš©
        if (!uniqueBest[r.subjectId] || Number(r.score) > Number(uniqueBest[r.subjectId].score) || 
            (Number(r.score) === Number(uniqueBest[r.subjectId].score) && Number(r.time) < Number(uniqueBest[r.subjectId].time))) {
            uniqueBest[r.subjectId] = r; 
        }
    });

    const finalRecs = Object.values(uniqueBest).sort((a, b) => new Date(b.date) - new Date(a.date)); // ìµœì‹ ìˆœ ì •ë ¬

    // C. í†µê³„ ê³„ì‚° ë° UI ì±„ìš°ê¸°
    let tbody = "";  
    finalRecs.forEach(r => { 
        totalScore += Number(r.score); 
        if (r.rank === 'SSS') sssCount++;
        
        let subName = r.subjectName;
        if(!subName) {
            const found = MenuData.flatMap(c=>c.items).find(i=> String(i.id).trim() === String(r.subjectId).trim());
            subName = found ? found.name : r.subjectId;
        }
        
        let rankColor = "text-gray-500";
        if(r.rank.includes('S')) rankColor = "text-purple-600 font-black";
        else if(r.rank.includes('A')) rankColor = "text-pink-500 font-bold";
        
        tbody += `<tr class="border-b border-gray-100 hover:bg-gray-50">
            <td class="px-3 md:px-6 py-3 font-medium text-gray-700 text-sm whitespace-nowrap">${subName}</td>
            <td class="px-3 md:px-6 py-3 font-black ${rankColor} text-center whitespace-nowrap">${r.rank}</td>
            <td class="px-3 md:px-6 py-3 text-gray-500 text-xs font-mono text-right whitespace-nowrap">${Number(r.time).toFixed(1)}s</td>
            <td class="px-3 md:px-6 py-3 font-bold text-gray-800 text-center whitespace-nowrap">${r.score}</td>
        </tr>`;
    });

    // UI ì—…ë°ì´íŠ¸
    document.getElementById('info-user-sub').innerText = targetUser.name + " (" + targetUser.school + ")";
    document.getElementById('info-total').innerText = totalScore; 
    document.getElementById('info-sss').innerText = sssCount; 
    document.getElementById('info-count').innerText = finalRecs.length; // í‘¼ ë¬¸ì œ ìˆ˜ê°€ ì•„ë‹Œ 'ê³¼ëª©ë³„ ìµœê³  ê¸°ë¡ ìˆ˜'ê°€ ë¨
    document.getElementById('info-table-body').innerHTML = tbody || `<tr><td colspan="4" class="px-6 py-12 text-center text-gray-400">ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤. ì—´ì‹¬íˆ ë„ì „í•´ë³´ì„¸ìš”!</td></tr>`;
}

function closeMyInfo() { document.getElementById('view-my-info').classList.add('hidden'); }
   // ==========================================
        // [13] ìˆ˜ì—… ëª¨ë“œ (Learning Mode) ì „ìš© ë¡œì§ (Code 2 ì™„ë²½ ì´ì‹)
        // ==========================================

        // [13-1] ìˆ˜ì—… ëª¨ë“œ ì‹œì‘/ì¢…ë£Œ
        function startLearningMode() {
            if (!AppState.currentSubject) { alert("ì£¼ì œë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”."); return; }
            
            // ê¸°ì¡´ í™”ë©´ ìˆ¨ê¸°ê³  ìˆ˜ì—… ëª¨ë“œ í‘œì‹œ
            ['view-dashboard', 'view-teacher', 'view-student'].forEach(id => document.getElementById(id).classList.add('hidden'));
            const screen = document.getElementById('view-learning');
            screen.classList.remove('hidden');
            screen.classList.add('flex');

            document.getElementById('learning-subject-title').innerText = AppState.currentSubject.name;

            // ìº”ë²„ìŠ¤ ì´ˆê¸°í™” (í™”ë©´ì´ ë³´ì¸ í›„ ì‚¬ì´ì¦ˆ ì¡ê¸° ìœ„í•´ ì§€ì—°)
            setTimeout(() => {
                initCanvas('canvas-left');
                initCanvas('canvas-right');
                nextLearningProblem();
            }, 100);
        }

        function exitLearningMode() {
            if(confirm("ìˆ˜ì—…ì„ ì¢…ë£Œí•˜ê³  ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°ˆê¹Œìš”?")) {
                document.getElementById('view-learning').classList.add('hidden');
                document.getElementById('view-learning').classList.remove('flex');
                goDashboard();
                clearCanvas('left');
                clearCanvas('right');
            }
        }

        // [13-2] ìˆ˜ì—… ëª¨ë“œ ë¬¸ì œ ì¶œì œ (í™”ë©´ ë ˆì´ì•„ì›ƒ ìµœì í™”)
        function nextLearningProblem() {
            const q = generateProblem(AppState.currentSubject);
            const pArea = document.getElementById('learning-problem-area');
            
            // ì´ˆê¸°í™”
            clearCanvas('left'); 
            if (AppState.isScrollMode) toggleScrollMode(); // ë‹¤ìŒ ë¬¸ì œ ë„˜ì–´ê°€ë©´ í•„ê¸° ëª¨ë“œë¡œ ë¦¬ì…‹

            let contentHtml = '';

            // A. ë…í•´/ì§€ë¬¸í˜• (ìŠ¤í¬ë¡¤ í•„ìš”)
            if (q.readingData) {
                contentHtml = `
                    <div class="w-full max-w-3xl flex flex-col gap-6 pb-20">
                        <div class="bg-white text-black p-8 rounded-2xl shadow-xl border-2 border-gray-300 text-lg leading-loose break-keep">
                            <h3 class="font-black text-2xl mb-4 text-blue-600 border-b-2 border-blue-100 pb-2">${q.readingData.title}</h3>
                            ${q.readingData.content}
                        </div>
                        <div class="bg-gray-800 p-6 rounded-xl border-l-8 border-yellow-400 shadow-lg">
                            <div class="text-yellow-400 font-bold text-sm mb-2 tracking-widest">QUESTION</div>
                            <div class="text-3xl font-black text-white leading-snug">${q.problem}</div>
                        </div>
                    </div>
                `;
            }
            // B. ë‹¬ë ¥/ì¼ê³¼í‘œ
            else if (q.monthData) {
                contentHtml = `
                    <div class="w-full max-w-3xl flex flex-col items-center gap-6 pt-4">
                        <div class="bg-white p-4 rounded-2xl shadow-xl w-full text-black">${getCalendarHTML(q.monthData)}</div>
                        <div class="text-4xl md:text-5xl font-black text-white bg-gray-800/80 px-8 py-4 rounded-xl shadow-lg border border-gray-600">${q.problem}</div>
                    </div>
                `;
            }
            else if (q.scheduleData) {
                // ì¼ê³¼í‘œ HTML ìƒì„± (Code 2 ìŠ¤íƒ€ì¼)
                let schHtml = '<div class="w-full bg-white rounded-xl overflow-hidden shadow-lg text-black">';
                q.scheduleData.items.forEach(item => {
                    schHtml += `<div class="flex justify-between items-center p-4 border-b border-gray-100 last:border-0">
                        <span class="font-black text-orange-500 text-xl w-24">${item.t}</span>
                        <span class="font-bold text-gray-800 text-xl">${item.a}</span>
                    </div>`;
                });
                schHtml += '</div>';

                contentHtml = `
                    <div class="w-full max-w-2xl flex flex-col items-center gap-6 pt-4">
                        <h3 class="text-2xl font-black text-white bg-blue-600 px-6 py-2 rounded-full shadow-md">${q.scheduleData.title}</h3>
                        ${schHtml}
                        <div class="text-3xl font-black text-white mt-4 text-center leading-snug">${q.problem}</div>
                    </div>
                `;
            }
            // C. ì‹œê³„/ê·¸ë¦¼ ë“± ìº”ë²„ìŠ¤í˜•
            else if (AppState.currentSubject.id.includes('clock')) {
                const cvsId = 'learn-clock-cvs';
                contentHtml = `
                    <div class="flex flex-col items-center justify-center h-full w-full gap-8">
                        <div class="relative w-[500px] h-[500px] bg-white rounded-full border-8 border-gray-700 shadow-2xl">
                            <canvas id="${cvsId}" width="500" height="500"></canvas>
                        </div>
                        <div class="text-5xl font-black text-white drop-shadow-lg">ëª‡ ì‹œ ëª‡ ë¶„?</div>
                    </div>
                `;
                let h=0, m=0;
                if(q.h !== undefined) { h=q.h; m=q.m; }
                else { const n = q.answer.match(/\d+/g); if(n) { h=parseInt(n[0]); m=parseInt(n[1]); } }
                setTimeout(() => drawClock(cvsId, h, m), 50);
            }
            // D. ì¼ë°˜ í…ìŠ¤íŠ¸
            else {
                // ê¸€ì í¬ê¸° ìë™ ì¡°ì ˆ
                let fontSize = "text-6xl";
                if(q.problem.length > 20) fontSize = "text-4xl";
                if(q.problem.length > 50) fontSize = "text-3xl";

                contentHtml = `
                    <div class="flex items-center justify-center w-full h-full p-8 text-center">
                        <div class="${fontSize} font-black text-white leading-tight drop-shadow-xl break-keep">
                            ${q.problem}
                        </div>
                    </div>
                `;
            }

            pArea.innerHTML = contentHtml;
        }

        // [13-3] íˆ´ë°” ë° í•„ê¸° ì œì–´
        function toggleToolbar() {
            const tb = document.getElementById('learning-toolbar');
            const btn = document.getElementById('toolbar-toggle-btn');
            if (tb.style.transform === 'translate(120%, -50%)') {
                tb.style.transform = 'translate(0, -50%)';
                btn.innerText = "â–¶";
            } else {
                tb.style.transform = 'translate(120%, -50%)';
                btn.innerText = "â—€";
            }
        }

        function toggleScrollMode() {
            const cvs = document.getElementById('canvas-left');
            const btn = document.getElementById('btn-scroll-toggle');
            const indicator = document.getElementById('mode-indicator');
            
            AppState.isScrollMode = !AppState.isScrollMode;

            if (AppState.isScrollMode) {
                cvs.classList.add('pointer-events-none'); 
                btn.innerText = "âœï¸ í•„ê¸°í•˜ê¸°";
                btn.className = "bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-2 rounded-lg text-xs w-full transition";
                indicator.innerText = "ğŸ‘† ìŠ¤í¬ë¡¤ ëª¨ë“œ";
                indicator.className = "absolute top-4 left-4 px-3 py-1 bg-blue-600 rounded-full text-xs font-bold text-white border border-blue-400 pointer-events-none z-[20]";
            } else {
                cvs.classList.remove('pointer-events-none');
                btn.innerText = "ğŸ‘† ìŠ¤í¬ë¡¤";
                btn.className = "bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-2 rounded-lg text-xs w-full transition";
                indicator.innerText = "âœï¸ í•„ê¸° ëª¨ë“œ";
                indicator.className = "absolute top-4 left-4 px-3 py-1 bg-black/60 rounded-full text-xs font-bold text-green-400 border border-green-500/30 pointer-events-none z-[20]";
            }
        }

        function setLearnPen(color, el) {
            AppState.drawCtx.isEraser = false;
            AppState.drawCtx.color = color;
            document.querySelectorAll('#learning-toolbar div.w-7').forEach(d => d.classList.remove('scale-110', 'shadow-lg', 'border-white'));
            el.classList.add('scale-110', 'shadow-lg', 'border-white');
        }

        function setLearnEraser(el) {
            AppState.drawCtx.isEraser = true;
            document.querySelectorAll('#learning-toolbar div.w-7').forEach(d => d.classList.remove('scale-110', 'shadow-lg', 'border-white'));
            el.classList.add('scale-110', 'shadow-lg', 'border-white');
        }

        // [13-4] ìº”ë²„ìŠ¤ ê·¸ë¦¬ê¸° ì½”ì–´ (Code 2ì—ì„œ ë¦¬ì‚¬ì´ì§• ëŒ€ì‘ ì¶”ê°€)
        function initCanvas(id) {
            const cvs = document.getElementById(id);
            const ctx = cvs.getContext('2d');
            const parent = cvs.parentElement;

            function resize() {
                cvs.width = parent.clientWidth;
                cvs.height = parent.clientHeight;
            }
            resize();
            window.addEventListener('resize', resize);

            let isDrawing = false;
            let lastX = 0, lastY = 0;

            function getPos(e) {
                const rect = cvs.getBoundingClientRect();
                const scaleX = cvs.width / rect.width;
                const scaleY = cvs.height / rect.height;
                let cx, cy;
                if(e.touches) { cx = e.touches[0].clientX; cy = e.touches[0].clientY; }
                else { cx = e.clientX; cy = e.clientY; }
                return { x: (cx - rect.left) * scaleX, y: (cy - rect.top) * scaleY };
            }

            function start(e) { e.preventDefault(); isDrawing = true; const p = getPos(e); lastX = p.x; lastY = p.y; }
            function move(e) {
                e.preventDefault(); if(!isDrawing) return;
                const p = getPos(e);
                ctx.beginPath(); ctx.moveTo(lastX, lastY); ctx.lineTo(p.x, p.y);
                
                if (AppState.drawCtx.isEraser) {
                    ctx.globalCompositeOperation = 'destination-out';
                    ctx.lineWidth = 30;
                } else {
                    ctx.globalCompositeOperation = 'source-over';
                    ctx.strokeStyle = AppState.drawCtx.color;
                    ctx.lineWidth = 3;
                }
                ctx.lineCap = 'round'; ctx.lineJoin = 'round'; ctx.stroke();
                lastX = p.x; lastY = p.y;
            }
            function end(e) { e.preventDefault(); isDrawing = false; }

            cvs.onmousedown = start; cvs.onmousemove = move; cvs.onmouseup = end; cvs.onmouseout = end;
            cvs.ontouchstart = start; cvs.ontouchmove = move; cvs.ontouchend = end;
        }

        function clearCanvas(side) {
            const cvs = document.getElementById(`canvas-${side}`);
            if(cvs) {
                const ctx = cvs.getContext('2d');
                ctx.clearRect(0, 0, cvs.width, cvs.height);
            }
        }

        // ==========================================
        // [14] ì•± ì´ˆê¸°í™” (Code 1 + Code 2)
        // ==========================================
    // [ìµœì¢… ì‹¤í–‰] ì•± ì´ˆê¸°í™” (ì¤‘ë³µ ì œê±° ë° í†µí•©)
    window.onload = () => {
        // êµ¬ê¸€ ìŠ¤í¬ë¦½íŠ¸ URL ì²´í¬
        if (GAS_URL.includes("ì—¬ê¸°ì—")) { 
            alert("ì•±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ URLì„ ì„¤ì •í•´ì£¼ì„¸ìš”!"); 
            document.getElementById('loading-overlay').classList.add('hidden'); 
            return; 
        }
        
        // 1. ì„œë²„ ë°ì´í„° ë¡œë“œ
        loadDataFromServer(); 
        
        // 2. ê¸°ëŠ¥ ì´ˆê¸°í™”
        initClock();          // ì‹œê³„
        renderSidebarMenu();  // ë©”ë‰´
        initBoard();          // ì¹ íŒ
        setRole(null);        // ì—­í•  ì„ íƒ ì´ˆê¸°í™”

        // 3. ì˜¤ëŠ˜ì˜ ëª…ì–¸
        const quotes = [
            "ë°°ì›€ì—ëŠ” ì™•ë„ê°€ ì—†ë‹¤.",
            "ì‹œì‘ì´ ë°˜ì´ë‹¤.",
            "ì²œë¦¬ê¸¸ë„ í•œ ê±¸ìŒë¶€í„°.",
            "ì˜¤ëŠ˜ ê±·ì§€ ì•Šìœ¼ë©´ ë‚´ì¼ì€ ë›°ì–´ì•¼ í•œë‹¤.",
            "ì—°ìŠµë§Œì´ ì‚´ ê¸¸ì´ë‹¤."
        ];
        document.getElementById('dash-quote').innerText = `"${quotes[Math.floor(Math.random()*quotes.length)]}"`;

        // 4. ì„ ìƒë‹˜ìš© ë©”ëª¨ì¥ ìë™ ì €ì¥ (ë””ë°”ìš´ì‹±)
        let memoTimeout;
        document.getElementById('dash-memo').addEventListener('input', (e) => {
            if (AppState.user && AppState.user.role === 'teacher') {
                AppState.memo = e.target.value; 
                clearTimeout(memoTimeout);
                memoTimeout = setTimeout(() => { 
                    saveMemoToServer(AppState.memo); 
                    const status = document.getElementById('memo-status'); 
                    status.classList.remove('hidden'); 
                    setTimeout(() => status.classList.add('hidden'), 2000); 
                }, 1000);
            }
        });
    };
        // ë©”ë‰´ ì„ íƒ ì‹œ ë¶„ê¸° ì²˜ë¦¬ (ì„ ìƒë‹˜ ì¹ íŒ / í•™ìƒ í€´ì¦ˆ / ìˆ˜ì—… ëª¨ë“œ)
        // Code 1ì˜ selectMenu í•¨ìˆ˜ë¥¼ ë®ì–´ì”Œì›Œ 'ìˆ˜ì—… ëª¨ë“œ' ì§„ì…ì  ì¶”ê°€ ê°€ëŠ¥í•˜ë„ë¡ í™•ì¥
selectMenu = function(itemJson) {
    // [ìˆ˜ì •] ë©”ë‰´ í´ë¦­ ì‹œ ì‚¬ì´ë“œë°” ë‹«ê¸° (ëª¨ë°”ì¼ ëŒ€ì‘)
    if(sidebarOpen) toggleSidebar(); 

    if (!AppState.user) { alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."); return; }
    
    const item = JSON.parse(decodeURIComponent(itemJson));
    AppState.currentSubject = item;

            // ì„ ìƒë‹˜ì¼ ê²½ìš°: ì¹ íŒëª¨ë“œ vs ìˆ˜ì—…ëª¨ë“œ ì„ íƒ (ì—¬ê¸°ì„œëŠ” ê°„ë‹¨í•˜ê²Œ confirmìœ¼ë¡œ ì²˜ë¦¬í•˜ê±°ë‚˜ ê¸°ë³¸ ì¹ íŒìœ¼ë¡œ ê°)
            // *ì„ ìƒë‹˜ì€ ì¹ íŒ ëª¨ë“œì—ì„œ 'ë¬¸ì œ ë„ìš°ê¸°'ë¥¼ í•˜ê±°ë‚˜, ë³„ë„ ë²„íŠ¼ìœ¼ë¡œ 'ìˆ˜ì—… ëª¨ë“œ' ì§„ì… ê°€ëŠ¥í•˜ê²Œ í•¨.
            // *í˜„ì¬ UIìƒ ì‚¬ì´ë“œë°” í´ë¦­ ì‹œ ì—­í• ì— ë”°ë¼ ìë™ ë¶„ê¸°ë¨.
            
            // ë§Œì•½ ì„ ìƒë‹˜ì´ 'ìˆ˜ì—… ëª¨ë“œ(ì–‘ìª½ ë¶„í•  í™”ë©´)'ë¥¼ ì›í•œë‹¤ë©´ 
            // ì¹ íŒ í™”ë©´ ë‚´ì— 'ìˆ˜ì—… ëª¨ë“œë¡œ ì „í™˜' ë²„íŠ¼ì„ ë‘ê±°ë‚˜, 
            // ì—¬ê¸°ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ Code 1ì˜ ì¹ íŒ ë·°ë¡œ ì´ë™í•©ë‹ˆë‹¤.
            
            if (AppState.user.role === 'teacher') {
                openTeacherBoard();
                // ì¹ íŒ ë·°ì— 'ìˆ˜ì—… ëª¨ë“œ(í•„ê¸°ì¥)' ë²„íŠ¼ ì¶”ê°€ ë¡œì§
                const toolbar = document.querySelector('#view-teacher .flex.items-center.gap-3');
                if(!document.getElementById('btn-go-learning')) {
                    const btn = document.createElement('button');
                    btn.id = 'btn-go-learning';
                    btn.className = "bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-bold border border-green-700 ml-2";
                    btn.innerText = "ìˆ˜ì—… ëª¨ë“œ(í•„ê¸°)";
                    btn.onclick = startLearningMode;
                    toolbar.insertBefore(btn, toolbar.firstChild);
                }
            } else {
                openStudentQuiz();
            }
        };

// ==========================================
        // [MISSING LOGIC] ëˆ„ë½ëœ í•µì‹¬ í•¨ìˆ˜ ë³´ì™„
        // ì´ í•¨ìˆ˜ë“¤ì´ ì—†ìœ¼ë©´ í€´ì¦ˆê°€ ì‹¤í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
        // ==========================================

        // [M-1] êµ­ì–´ ê¸°ì´ˆ (ììŒ/ëª¨ìŒ) ìƒì„±ê¸°
        function generateLangQuiz(type, subType, bank) {
            const qIdx = getRandomInt(0, bank.length - 1);
            const qItem = bank[qIdx];
            
            // í•œê¸€ ë¶„í•´ (ì´ˆì„±/ì¤‘ì„±/ì¢…ì„±)
            const targetChar = qItem.a.charAt(0);
            const parts = decomposeHangul(targetChar);
            
            let problemHtml, options;

            if (!parts) {
                // í•œê¸€ì´ ì•„ë‹Œ ê²½ìš° ì˜ˆì™¸ ì²˜ë¦¬
                problemHtml = `<div class="text-4xl font-bold">${qItem.q}</div>`;
                options = [qItem.a, "ì˜¤ë‹µ1", "ì˜¤ë‹µ2", "ì˜¤ë‹µ3"];
            } else {
                const { cho, jung, jong } = parts;
                const restString = qItem.a.substring(1); // ì²« ê¸€ì ëº€ ë‚˜ë¨¸ì§€
                
                // ë¬¸ì œ í™”ë©´: íŒíŠ¸ + ë¹ˆì¹¸
                problemHtml = `
                    <div class="flex flex-col items-center justify-center h-full gap-4">
                        <div class="text-2xl text-gray-500 font-bold break-keep">${qItem.q}</div>
                        <div class="flex items-center gap-2">
                            <span class="w-20 h-20 rounded-xl bg-white border-4 border-dashed border-blue-400 text-blue-500 text-5xl font-black flex items-center justify-center animate-pulse">?</span>
                            <span class="text-5xl font-bold text-gray-800">${restString}</span>
                        </div>
                    </div>
                `;

                // ë³´ê¸° ìƒì„± (ììŒí€´ì¦ˆë©´ ììŒë§Œ ë‹¤ë¥´ê²Œ, ëª¨ìŒí€´ì¦ˆë©´ ëª¨ìŒë§Œ ë‹¤ë¥´ê²Œ)
                let o = new Set([targetChar]);
                let loop = 0;
                
                if (subType === 'consonant') { // ììŒ í€´ì¦ˆ
                    while (o.size < 4 && loop < 100) {
                        loop++;
                        const rCho = getRandomInt(0, H_CHO.length - 1);
                        if (rCho !== cho) o.add(composeHangul(rCho, jung, jong));
                    }
                } else { // ëª¨ìŒ í€´ì¦ˆ
                    while (o.size < 4 && loop < 100) {
                        loop++;
                        const rJung = getRandomInt(0, H_JUNG.length - 1);
                        if (rJung !== jung) o.add(composeHangul(cho, rJung, jong));
                    }
                }
                options = shuffleArray(Array.from(o));
            }

            return { 
                problem: problemHtml, 
                answer: targetChar, // ì •ë‹µì€ í•œ ê¸€ì (ì˜ˆ: 'ê°€')
                options: options 
            };
        }

        // [M-2] ê³±ì…ˆ ì‹¬í™” (ìë¦¿ìˆ˜ ì„¤ì •)
        function generateComplexMul(d1, d2) {
            const min1 = Math.pow(10, d1 - 1), max1 = Math.pow(10, d1) - 1;
            const min2 = Math.pow(10, d2 - 1), max2 = Math.pow(10, d2) - 1;
            
            const n1 = getRandomInt(min1, max1);
            const n2 = getRandomInt(min2, max2);
            const ans = n1 * n2;

            let o = new Set([ans]);
            while(o.size < 4) {
                let wrong = ans + getRandomInt(-5, 5) * 10; 
                if (Math.random() < 0.5) wrong = ans + getRandomInt(1, 9);
                if(wrong > 0 && wrong !== ans) o.add(wrong);
                if(o.size < 4) o.add(ans + o.size * 10 + 10);
            }

            // ì„¸ë¡œì…ˆ ìŠ¤íƒ€ì¼ HTML
            const problemHtml = `
                <div class="inline-block text-right font-mono font-bold text-5xl leading-tight text-gray-800 p-4">
                    <div class="mb-2 tracking-widest mr-2">${n1}</div>
                    <div class="border-b-4 border-gray-800 pb-2 flex justify-end gap-4 items-center">
                        <span class="text-purple-600 text-4xl mr-2">Ã—</span>
                        <span class="tracking-widest mr-2">${n2}</span>
                    </div>
                    <div class="pt-4 text-purple-400 text-center text-4xl">?</div>
                </div>
            `;
            return { problem: problemHtml, answer: ans, options: shuffleArray(Array.from(o)) };
        }

        // [M-3] ë‚˜ëˆ—ì…ˆ ì‹¬í™”
        function generateComplexDiv(hasRem, level) {
            let divisor, quotient, remainder, dividend;
            
            if (level === 'easy') { divisor = getRandomInt(2, 9); quotient = getRandomInt(2, 9); } 
            else { divisor = getRandomInt(3, 12); quotient = getRandomInt(11, 20); }
            
            remainder = hasRem ? getRandomInt(1, divisor - 1) : 0;
            dividend = divisor * quotient + remainder;
            
            const ans = hasRem ? `${quotient}...${remainder}` : quotient;
            const problemHtml = `<span class="text-5xl font-black text-gray-800 tracking-wider">${dividend} Ã· ${divisor}</span>`;

            let o = new Set([ans]);
            while(o.size < 4) {
                let wQ = quotient + getRandomInt(-2, 2);
                if(wQ <= 0) wQ = 1;
                let wAns;
                if (hasRem) {
                    let wR = remainder + getRandomInt(-1, 1);
                    if(wR < 0) wR = 0; if(wR >= divisor) wR = divisor - 1;
                    wAns = `${wQ}...${wR}`;
                } else { wAns = wQ; }
                
                if (wAns !== ans) o.add(wAns);
                if (o.size < 4) o.add(hasRem ? `${quotient+o.size}...${remainder}` : quotient+o.size);
            }
            return { problem: problemHtml, answer: ans, options: shuffleArray(Array.from(o)) };
        }

        // [M-4] ì–´ë¦¼í•˜ê¸° (ê¸°ì´ˆ)
        function generateDivEstim() {
            const divisor = getRandomInt(3, 9);
            const ans = getRandomInt(3, 9);
            const exact = divisor * ans;
            const maxOffset = Math.floor((divisor - 1) / 2);
            const offset = getRandomInt(1, maxOffset); 
            const dividend = Math.random() < 0.5 ? exact + offset : exact - offset;

            const problemHtml = `
                <div class="flex flex-col items-center justify-center gap-4 p-3 w-full h-full">
                    <div class="text-gray-500 text-2xl font-bold tracking-widest border-b-2 border-gray-400 pb-1 mb-2">
                        ${dividend} Ã· ${divisor}
                    </div>
                    <div class="bg-white border-2 border-yellow-400 rounded-xl p-6 shadow-lg">
                        <div class="text-4xl font-black text-gray-800 text-center leading-tight">
                            <span class="text-green-600">${divisor}</span> Ã— <span class="text-yellow-500 animate-pulse">?</span>
                        </div>
                        <div class="mt-4 text-center text-gray-500 font-bold text-lg">
                            í•˜ë©´ <span class="text-black text-xl underline">${dividend}</span>ì™€ ê°€ì¥ ê°€ê¹Œì›Œìš”
                        </div>
                    </div>
                </div>
            `;

            let o = new Set([ans]);
            o.add(ans - 1); o.add(ans + 1);
            while(o.size < 4) {
                let wrong = ans + getRandomInt(-3, 3);
                if(wrong > 1 && wrong !== ans) o.add(wrong);
            }
            return { problem: problemHtml, answer: ans, options: shuffleArray(Array.from(o)) };
        }

        // [M-5] ì €ìš¸ ê·¸ë¦¬ê¸° í•¨ìˆ˜ (Canvas) - Code 2ì—ì„œ ê°€ì ¸ì˜´
        function drawInteractiveScale(id, weight) {
            const cvs = document.getElementById(id);
            if (!cvs) return;
            const ctx = cvs.getContext('2d');
            
            // ìº”ë²„ìŠ¤ í¬ê¸° ê³ ì • (CSSë¡œ ì¡°ì ˆ)
            cvs.width = 300; cvs.height = 250;
            const w = cvs.width; const h = cvs.height;
            const centerX = w / 2; const bottomY = h - 20;

            // ë°°ê²½ ì§€ìš°ê¸°
            ctx.clearRect(0, 0, w, h);

            // ì €ìš¸ ë³¸ì²´
            ctx.fillStyle = '#4b5563'; // gray-600
            ctx.fillRect(centerX - 80, bottomY - 50, 160, 50); 
            
            // ì•¡ì • í™”ë©´
            ctx.fillStyle = '#d1fae5'; // green-100
            ctx.fillRect(centerX - 60, bottomY - 40, 120, 30);
            ctx.fillStyle = '#065f46'; // green-800
            ctx.font = 'bold 24px monospace';
            ctx.textAlign = 'right';
            ctx.fillText(weight + 'g', centerX + 50, bottomY - 18);

            // ì ‘ì‹œ ë°›ì¹¨ëŒ€
            ctx.fillStyle = '#9ca3af'; // gray-400
            ctx.beginPath();
            ctx.moveTo(centerX - 15, bottomY - 50);
            ctx.lineTo(centerX + 15, bottomY - 50);
            ctx.lineTo(centerX + 15, bottomY - 80);
            ctx.lineTo(centerX - 15, bottomY - 80);
            ctx.fill();

            // ì ‘ì‹œ
            ctx.fillStyle = '#e5e7eb'; // gray-200
            ctx.beginPath();
            ctx.ellipse(centerX, bottomY - 80, 100, 20, 0, 0, 2 * Math.PI);
            ctx.fill();
            ctx.lineWidth = 2;
            ctx.strokeStyle = '#9ca3af';
            ctx.stroke();

            // ë¬¼ê±´ (ë¬´ê²Œì— ë”°ë¼ í¬ê¸° ë³€í™”)
            if (weight > 0) {
                const visualSize = Math.min(weight, 500) / 500; 
                const radius = 20 + (visualSize * 40);

                ctx.fillStyle = '#f87171'; // red-400
                ctx.beginPath();
                ctx.arc(centerX, bottomY - 90 - radius/2, radius, 0, 2 * Math.PI);
                ctx.fill();
                
                // ë¬¼ê±´ í•˜ì´ë¼ì´íŠ¸
                ctx.fillStyle = 'rgba(255,255,255,0.3)';
                ctx.beginPath();
                ctx.arc(centerX - radius/3, bottomY - 90 - radius, radius/3, 0, 2 * Math.PI);
                ctx.fill();
            }
        }

        // ==========================================
        // [FINAL] ìµœì¢… ì‹¤í–‰ (Onload)
        // ==========================================
        window.onload = () => {
            // êµ¬ê¸€ ìŠ¤í¬ë¦½íŠ¸ URL ì²´í¬
            if (GAS_URL.includes("ì—¬ê¸°ì—")) { 
                alert("ì•±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ URLì„ ì„¤ì •í•´ì£¼ì„¸ìš”!"); 
                document.getElementById('loading-overlay').classList.add('hidden'); 
                return; 
            }
            
            // ë°ì´í„° ë¡œë“œ ë° ì´ˆê¸°í™”
            loadDataFromServer(); // ì„œë²„ í†µì‹ 
            initClock();          // ì‹œê³„ ì‘ë™
            renderSidebarMenu();  // ì‚¬ì´ë“œë°” ë©”ë‰´ ìƒì„±
            initBoard();          // ì„ ìƒë‹˜ ì¹ íŒ ì´ˆê¸°í™”
            setRole(null);        // ì´ˆê¸° ì—­í•  ì„¤ì • (ë¡œê·¸ì¸ ì „)

            // ì˜¤ëŠ˜ì˜ ëª…ì–¸ (Code 2 ëª…ì–¸ í¬í•¨)
            const quotes = [
                "ë°°ì›€ì—ëŠ” ì™•ë„ê°€ ì—†ë‹¤.",
                "ì‹œì‘ì´ ë°˜ì´ë‹¤.",
                "ì²œë¦¬ê¸¸ë„ í•œ ê±¸ìŒë¶€í„°.",
                "ì˜¤ëŠ˜ ê±·ì§€ ì•Šìœ¼ë©´ ë‚´ì¼ì€ ë›°ì–´ì•¼ í•œë‹¤.",
                "ì—°ìŠµë§Œì´ ì‚´ ê¸¸ì´ë‹¤."
            ];
            document.getElementById('dash-quote').innerText = `"${quotes[Math.floor(Math.random()*quotes.length)]}"`;

            // ë©”ëª¨ì¥ ìë™ ì €ì¥ (ë””ë°”ìš´ì‹±)
            let memoTimeout;
            document.getElementById('dash-memo').addEventListener('input', (e) => {
                if (AppState.user && AppState.user.role === 'teacher') {
                    AppState.memo = e.target.value; 
                    clearTimeout(memoTimeout);
                    memoTimeout = setTimeout(() => { 
                        saveMemoToServer(AppState.memo); 
                        const status = document.getElementById('memo-status'); 
                        status.classList.remove('hidden'); 
                        setTimeout(() => status.classList.add('hidden'), 2000); 
                    }, 1000);
                }
            });
        };
    </script>
</body>
</html>
